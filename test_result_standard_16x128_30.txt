==================================================
<> Training Transformer Model (AMP Enabled)
==================================================
/home/ztang13/workspace/SparseAttention/myenv/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/home/ztang13/workspace/SparseAttention/Hierarchical_transformer_V5_WikiText2.py:708: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler()
Epoch 1/30:   0%|                                                                                                                                           | 0/1005 [00:00<?, ?it/s]/home/ztang13/workspace/SparseAttention/Hierarchical_transformer_V5_WikiText2.py:740: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Epoch 1/30: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 1005/1005 [02:32<00:00,  6.57it/s, loss=7.1389, ppl=1260.09]
<> Validating...
/home/ztang13/workspace/SparseAttention/Hierarchical_transformer_V5_WikiText2.py:791: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():

<> Epoch 1 Results:
<>  Time: 0:02:36
Train Loss: 7.5327 | Train PPL: 1868.23
Valid Loss: 6.8466 | Valid PPL: 940.66
<> Saved new best model with validation loss: 6.8466
Epoch 2/30: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 1005/1005 [02:32<00:00,  6.57it/s, loss=6.8376, ppl=932.29]
<> Validating...

<> Epoch 2 Results:
<>  Time: 0:02:36
Train Loss: 6.9014 | Train PPL: 993.65
Valid Loss: 6.5401 | Valid PPL: 692.39
<> Saved new best model with validation loss: 6.5401
Epoch 3/30: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 1005/1005 [02:33<00:00,  6.56it/s, loss=6.7021, ppl=814.13]
<> Validating...

<> Epoch 3 Results:
<>  Time: 0:02:36
Train Loss: 6.6581 | Train PPL: 779.07
Valid Loss: 6.3931 | Valid PPL: 597.71
<> Saved new best model with validation loss: 6.3931
Epoch 4/30: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 1005/1005 [02:24<00:00,  6.96it/s, loss=6.6169, ppl=747.63]
<> Validating...

<> Epoch 4 Results:
<>  Time: 0:02:27
Train Loss: 6.4993 | Train PPL: 664.69
Valid Loss: 6.2946 | Valid PPL: 541.66
<> Saved new best model with validation loss: 6.2946
Epoch 5/30: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 1005/1005 [02:06<00:00,  7.97it/s, loss=6.5374, ppl=690.50]
<> Validating...

<> Epoch 5 Results:
<>  Time: 0:02:09
Train Loss: 6.3694 | Train PPL: 583.68
Valid Loss: 6.2020 | Valid PPL: 493.74
<> Saved new best model with validation loss: 6.2020
Epoch 6/30: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 1005/1005 [02:05<00:00,  8.00it/s, loss=6.4814, ppl=652.88]
<> Validating...

<> Epoch 6 Results:
<>  Time: 0:02:08
Train Loss: 6.2542 | Train PPL: 520.20
Valid Loss: 6.1348 | Valid PPL: 461.63
<> Saved new best model with validation loss: 6.1348
Epoch 7/30: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 1005/1005 [02:12<00:00,  7.60it/s, loss=6.4478, ppl=631.31]
<> Validating...

<> Epoch 7 Results:
<>  Time: 0:02:15
Train Loss: 6.1533 | Train PPL: 470.28
Valid Loss: 6.0768 | Valid PPL: 435.65
<> Saved new best model with validation loss: 6.0768
Epoch 8/30: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 1005/1005 [01:55<00:00,  8.72it/s, loss=6.4316, ppl=621.14]
<> Validating...

<> Epoch 8 Results:
<>  Time: 0:01:58
Train Loss: 6.0669 | Train PPL: 431.32
Valid Loss: 6.0292 | Valid PPL: 415.38
<> Saved new best model with validation loss: 6.0292
Epoch 9/30: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 1005/1005 [02:12<00:00,  7.59it/s, loss=6.3823, ppl=591.30]
<> Validating...

<> Epoch 9 Results:
<>  Time: 0:02:15
Train Loss: 5.9919 | Train PPL: 400.17
Valid Loss: 5.9898 | Valid PPL: 399.33
<> Saved new best model with validation loss: 5.9898
Epoch 10/30: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 1005/1005 [02:11<00:00,  7.62it/s, loss=6.3915, ppl=596.73]
<> Validating...

<> Epoch 10 Results:
<>  Time: 0:02:15
Train Loss: 5.9274 | Train PPL: 375.19
Valid Loss: 5.9533 | Valid PPL: 385.03
<> Saved new best model with validation loss: 5.9533
Epoch 11/30: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 1005/1005 [02:05<00:00,  8.01it/s, loss=6.3719, ppl=585.16]
<> Validating...

<> Epoch 11 Results:
<>  Time: 0:02:08
Train Loss: 5.8713 | Train PPL: 354.69
Valid Loss: 5.9323 | Valid PPL: 377.03
<> Saved new best model with validation loss: 5.9323
Epoch 12/30: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 1005/1005 [02:23<00:00,  7.00it/s, loss=6.3600, ppl=578.22]
<> Validating...

<> Epoch 12 Results:
<>  Time: 0:02:26
Train Loss: 5.8199 | Train PPL: 336.93
Valid Loss: 5.9091 | Valid PPL: 368.38
<> Saved new best model with validation loss: 5.9091
Epoch 13/30: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 1005/1005 [02:11<00:00,  7.65it/s, loss=6.3178, ppl=554.35]
<> Validating...

<> Epoch 13 Results:
<>  Time: 0:02:14
Train Loss: 5.7726 | Train PPL: 321.38
Valid Loss: 5.8904 | Valid PPL: 361.56
<> Saved new best model with validation loss: 5.8904
Epoch 14/30: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 1005/1005 [02:06<00:00,  7.93it/s, loss=6.3237, ppl=557.66]
<> Validating...

<> Epoch 14 Results:
<>  Time: 0:02:10
Train Loss: 5.7310 | Train PPL: 308.28
Valid Loss: 5.8728 | Valid PPL: 355.23
<> Saved new best model with validation loss: 5.8728
Epoch 15/30: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 1005/1005 [02:08<00:00,  7.84it/s, loss=6.3367, ppl=564.94]
<> Validating...

<> Epoch 15 Results:
<>  Time: 0:02:11
Train Loss: 5.6930 | Train PPL: 296.77
Valid Loss: 5.8552 | Valid PPL: 349.06
<> Saved new best model with validation loss: 5.8552
Epoch 16/30: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 1005/1005 [02:06<00:00,  7.94it/s, loss=6.3137, ppl=552.10]
<> Validating...

<> Epoch 16 Results:
<>  Time: 0:02:09
Train Loss: 5.6580 | Train PPL: 286.58
Valid Loss: 5.8394 | Valid PPL: 343.59
<> Saved new best model with validation loss: 5.8394
Epoch 17/30: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 1005/1005 [02:07<00:00,  7.90it/s, loss=6.3107, ppl=550.42]
<> Validating...

<> Epoch 17 Results:
<>  Time: 0:02:10
Train Loss: 5.6261 | Train PPL: 277.57
Valid Loss: 5.8176 | Valid PPL: 336.16
<> Saved new best model with validation loss: 5.8176
Epoch 18/30: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 1005/1005 [02:07<00:00,  7.90it/s, loss=6.3058, ppl=547.72]
<> Validating...

<> Epoch 18 Results:
<>  Time: 0:02:10
Train Loss: 5.5991 | Train PPL: 270.18
Valid Loss: 5.8044 | Valid PPL: 331.75
<> Saved new best model with validation loss: 5.8044
Epoch 19/30: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 1005/1005 [02:06<00:00,  7.92it/s, loss=6.2957, ppl=542.24]
<> Validating...

<> Epoch 19 Results:
<>  Time: 0:02:10
Train Loss: 5.5747 | Train PPL: 263.68
Valid Loss: 5.7956 | Valid PPL: 328.86
<> Saved new best model with validation loss: 5.7956
Epoch 20/30: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 1005/1005 [02:06<00:00,  7.95it/s, loss=6.2641, ppl=525.36]
<> Validating...

<> Epoch 20 Results:
<>  Time: 0:02:09
Train Loss: 5.5535 | Train PPL: 258.13
Valid Loss: 5.7895 | Valid PPL: 326.85
<> Saved new best model with validation loss: 5.7895
Epoch 21/30: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 1005/1005 [02:09<00:00,  7.79it/s, loss=6.2655, ppl=526.10]
<> Validating...

<> Epoch 21 Results:
<>  Time: 0:02:12
Train Loss: 5.5351 | Train PPL: 253.42
Valid Loss: 5.7800 | Valid PPL: 323.75
<> Saved new best model with validation loss: 5.7800
Epoch 22/30: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 1005/1005 [02:05<00:00,  7.98it/s, loss=6.2332, ppl=509.38]
<> Validating...

<> Epoch 22 Results:
<>  Time: 0:02:09
Train Loss: 5.5195 | Train PPL: 249.52
Valid Loss: 5.7747 | Valid PPL: 322.05
<> Saved new best model with validation loss: 5.7747
Epoch 23/30: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 1005/1005 [02:04<00:00,  8.06it/s, loss=6.2623, ppl=524.43]
<> Validating...

<> Epoch 23 Results:
<>  Time: 0:02:07
Train Loss: 5.5076 | Train PPL: 246.56
Valid Loss: 5.7698 | Valid PPL: 320.48
<> Saved new best model with validation loss: 5.7698
Epoch 24/30: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 1005/1005 [02:05<00:00,  7.98it/s, loss=6.2633, ppl=524.94]
<> Validating...

<> Epoch 24 Results:
<>  Time: 0:02:09
Train Loss: 5.5011 | Train PPL: 244.97
Valid Loss: 5.7656 | Valid PPL: 319.13
<> Saved new best model with validation loss: 5.7656
Epoch 25/30: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 1005/1005 [02:05<00:00,  7.99it/s, loss=6.2536, ppl=519.87]
<> Validating...

<> Epoch 25 Results:
<>  Time: 0:02:09
Train Loss: 5.4995 | Train PPL: 244.57
Valid Loss: 5.7619 | Valid PPL: 317.95
<> Saved new best model with validation loss: 5.7619
Epoch 26/30: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 1005/1005 [02:05<00:00,  7.98it/s, loss=6.2238, ppl=504.62]
<> Validating...

<> Epoch 26 Results:
<>  Time: 0:02:09
Train Loss: 5.5006 | Train PPL: 244.84
Valid Loss: 5.7568 | Valid PPL: 316.32
<> Saved new best model with validation loss: 5.7568
Epoch 27/30: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 1005/1005 [02:05<00:00,  8.02it/s, loss=6.2056, ppl=495.52]
<> Validating...

<> Epoch 27 Results:
<>  Time: 0:02:08
Train Loss: 5.4989 | Train PPL: 244.42
Valid Loss: 5.7499 | Valid PPL: 314.15
<> Saved new best model with validation loss: 5.7499
Epoch 28/30: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 1005/1005 [02:05<00:00,  8.03it/s, loss=6.2324, ppl=508.97]
<> Validating...

<> Epoch 28 Results:
<>  Time: 0:02:08
Train Loss: 5.4942 | Train PPL: 243.28
Valid Loss: 5.7455 | Valid PPL: 312.78
<> Saved new best model with validation loss: 5.7455
Epoch 29/30: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 1005/1005 [02:04<00:00,  8.07it/s, loss=6.2030, ppl=494.22]
<> Validating...

<> Epoch 29 Results:
<>  Time: 0:02:07
Train Loss: 5.4884 | Train PPL: 241.87
Valid Loss: 5.7442 | Valid PPL: 312.36
<> Saved new best model with validation loss: 5.7442
Epoch 30/30: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 1005/1005 [02:12<00:00,  7.58it/s, loss=6.1911, ppl=488.40]
<> Validating...

<> Epoch 30 Results:
<>  Time: 0:02:15
Train Loss: 5.4858 | Train PPL: 241.24
Valid Loss: 5.7445 | Valid PPL: 312.47
<> No improvement for 1 epoch(s).

==================================================
<> Training Complete!
==================================================
Best validation loss: 5.7442
Total time: 1:07:00

<> Loading Best Model for Evaluation...

==================================================
<> FINAL TEST EVALUATION
==================================================
Testing: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 118/118 [00:03<00:00, 31.32it/s]
>> Final Test Loss: 4.8596
>> Final Test Perplexity: 128.97
==================================================
(myenv) ztang13@aiscalar:~/workspace/SparseAttention$ python Standard_Transformer_WikiText2.py
Using device: cuda

<> Loading WikiText-2 Dataset...

<> Building Vocabulary...
Counting words...

 Vocabulary Statistics:
Total unique words found: 28911
Vocabulary size: 28915
Sample words: ['<PAD>', '<UNK>', '<SOS>', '<EOS>', 'the', ',', '.', 'of', '<unk>', 'and']

<> Creating Datasets...

<> Dataset Statistics:
Train samples: 16090
Validation samples: 1677
Test samples: 1892

<> Sample Batch Information:
Input shape: torch.Size([16, 128])
Label shape: torch.Size([16, 128])

<> Initializing Transformer Model...
Actual Vocab Size: 28915
Using device: cuda

<> Starting Training...

==================================================
<> Training Transformer Model (AMP Enabled)
==================================================
/home/ztang13/workspace/SparseAttention/myenv/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/home/ztang13/workspace/SparseAttention/Standard_Transformer_WikiText2.py:369: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler()
Epoch 1/30:   0%|                                                                                                                                           | 0/1005 [00:00<?, ?it/s]/home/ztang13/workspace/SparseAttention/Standard_Transformer_WikiText2.py:401: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Epoch 1/30: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 1005/1005 [00:46<00:00, 21.40it/s, loss=7.1416, ppl=1263.43]
<> Validating...
/home/ztang13/workspace/SparseAttention/Standard_Transformer_WikiText2.py:452: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():

<> Epoch 1 Results:
<>  Time: 0:00:48
Train Loss: 7.5480 | Train PPL: 1896.94
Valid Loss: 6.8721 | Valid PPL: 964.96
<> Saved new best model with validation loss: 6.8721
Epoch 2/30: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 1005/1005 [01:06<00:00, 15.20it/s, loss=6.8788, ppl=971.48]
<> Validating...

<> Epoch 2 Results:
<>  Time: 0:01:07
Train Loss: 6.9442 | Train PPL: 1037.13
Valid Loss: 6.5943 | Valid PPL: 730.94
<> Saved new best model with validation loss: 6.5943
Epoch 3/30: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 1005/1005 [01:08<00:00, 14.78it/s, loss=6.7669, ppl=868.58]
<> Validating...

<> Epoch 3 Results:
<>  Time: 0:01:09
Train Loss: 6.6928 | Train PPL: 806.54
Valid Loss: 6.4223 | Valid PPL: 615.41
<> Saved new best model with validation loss: 6.4223
Epoch 4/30: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 1005/1005 [01:08<00:00, 14.76it/s, loss=6.6891, ppl=803.61]
<> Validating...

<> Epoch 4 Results:
<>  Time: 0:01:09
Train Loss: 6.5334 | Train PPL: 687.75
Valid Loss: 6.3329 | Valid PPL: 562.80
<> Saved new best model with validation loss: 6.3329
Epoch 5/30: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 1005/1005 [00:44<00:00, 22.61it/s, loss=6.6474, ppl=770.80]
<> Validating...

<> Epoch 5 Results:
<>  Time: 0:00:45
Train Loss: 6.4044 | Train PPL: 604.48
Valid Loss: 6.2370 | Valid PPL: 511.31
<> Saved new best model with validation loss: 6.2370
Epoch 6/30: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 1005/1005 [00:43<00:00, 23.12it/s, loss=6.5964, ppl=732.44]
<> Validating...

<> Epoch 6 Results:
<>  Time: 0:00:44
Train Loss: 6.2850 | Train PPL: 536.45
Valid Loss: 6.1574 | Valid PPL: 472.18
<> Saved new best model with validation loss: 6.1574
Epoch 7/30: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 1005/1005 [00:43<00:00, 23.11it/s, loss=6.5282, ppl=684.19]
<> Validating...

<> Epoch 7 Results:
<>  Time: 0:00:44
Train Loss: 6.1793 | Train PPL: 482.65
Valid Loss: 6.0990 | Valid PPL: 445.39
<> Saved new best model with validation loss: 6.0990
Epoch 8/30: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 1005/1005 [00:47<00:00, 21.13it/s, loss=6.4940, ppl=661.14]
<> Validating...

<> Epoch 8 Results:
<>  Time: 0:00:48
Train Loss: 6.0896 | Train PPL: 441.24
Valid Loss: 6.0426 | Valid PPL: 420.99
<> Saved new best model with validation loss: 6.0426
Epoch 9/30: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 1005/1005 [00:56<00:00, 17.81it/s, loss=6.4174, ppl=612.43]
<> Validating...

<> Epoch 9 Results:
<>  Time: 0:00:57
Train Loss: 6.0128 | Train PPL: 408.64
Valid Loss: 6.0045 | Valid PPL: 405.24
<> Saved new best model with validation loss: 6.0045
Epoch 10/30: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 1005/1005 [00:59<00:00, 16.76it/s, loss=6.4282, ppl=619.05]
<> Validating...

<> Epoch 10 Results:
<>  Time: 0:01:01
Train Loss: 5.9458 | Train PPL: 382.16
Valid Loss: 5.9679 | Valid PPL: 390.68
<> Saved new best model with validation loss: 5.9679
Epoch 11/30: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 1005/1005 [01:07<00:00, 14.92it/s, loss=6.4170, ppl=612.15]
<> Validating...

<> Epoch 11 Results:
<>  Time: 0:01:08
Train Loss: 5.8856 | Train PPL: 359.83
Valid Loss: 5.9392 | Valid PPL: 379.62
<> Saved new best model with validation loss: 5.9392
Epoch 12/30: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 1005/1005 [01:07<00:00, 14.89it/s, loss=6.4241, ppl=616.50]
<> Validating...

<> Epoch 12 Results:
<>  Time: 0:01:08
Train Loss: 5.8343 | Train PPL: 341.81
Valid Loss: 5.9231 | Valid PPL: 373.55
<> Saved new best model with validation loss: 5.9231
Epoch 13/30: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 1005/1005 [01:07<00:00, 14.92it/s, loss=6.4019, ppl=602.99]
<> Validating...

<> Epoch 13 Results:
<>  Time: 0:01:08
Train Loss: 5.7873 | Train PPL: 326.14
Valid Loss: 5.8997 | Valid PPL: 364.94
<> Saved new best model with validation loss: 5.8997
Epoch 14/30: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 1005/1005 [01:06<00:00, 15.01it/s, loss=6.4041, ppl=604.31]
<> Validating...

<> Epoch 14 Results:
<>  Time: 0:01:08
Train Loss: 5.7454 | Train PPL: 312.76
Valid Loss: 5.8853 | Valid PPL: 359.70
<> Saved new best model with validation loss: 5.8853
Epoch 15/30: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 1005/1005 [01:07<00:00, 14.93it/s, loss=6.3734, ppl=586.06]
<> Validating...

<> Epoch 15 Results:
<>  Time: 0:01:08
Train Loss: 5.7079 | Train PPL: 301.24
Valid Loss: 5.8656 | Valid PPL: 352.69
<> Saved new best model with validation loss: 5.8656
Epoch 16/30: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 1005/1005 [01:09<00:00, 14.43it/s, loss=6.3602, ppl=578.38]
<> Validating...

<> Epoch 16 Results:
<>  Time: 0:01:10
Train Loss: 5.6704 | Train PPL: 290.15
Valid Loss: 5.8484 | Valid PPL: 346.66
<> Saved new best model with validation loss: 5.8484
Epoch 17/30: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 1005/1005 [01:09<00:00, 14.47it/s, loss=6.3398, ppl=566.71]
<> Validating...

<> Epoch 17 Results:
<>  Time: 0:01:10
Train Loss: 5.6374 | Train PPL: 280.74
Valid Loss: 5.8304 | Valid PPL: 340.49
<> Saved new best model with validation loss: 5.8304
Epoch 18/30: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 1005/1005 [01:09<00:00, 14.52it/s, loss=6.3567, ppl=576.34]
<> Validating...

<> Epoch 18 Results:
<>  Time: 0:01:10
Train Loss: 5.6080 | Train PPL: 272.61
Valid Loss: 5.8168 | Valid PPL: 335.88
<> Saved new best model with validation loss: 5.8168
Epoch 19/30: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 1005/1005 [01:09<00:00, 14.50it/s, loss=6.3274, ppl=559.70]
<> Validating...

<> Epoch 19 Results:
<>  Time: 0:01:10
Train Loss: 5.5825 | Train PPL: 265.73
Valid Loss: 5.8019 | Valid PPL: 330.94
<> Saved new best model with validation loss: 5.8019
Epoch 20/30: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 1005/1005 [01:08<00:00, 14.74it/s, loss=6.3342, ppl=563.54]
<> Validating...

<> Epoch 20 Results:
<>  Time: 0:01:09
Train Loss: 5.5602 | Train PPL: 259.87
Valid Loss: 5.7904 | Valid PPL: 327.14
<> Saved new best model with validation loss: 5.7904
Epoch 21/30: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 1005/1005 [01:08<00:00, 14.74it/s, loss=6.3437, ppl=568.88]
<> Validating...

<> Epoch 21 Results:
<>  Time: 0:01:09
Train Loss: 5.5403 | Train PPL: 254.75
Valid Loss: 5.7829 | Valid PPL: 324.69
<> Saved new best model with validation loss: 5.7829
Epoch 22/30: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 1005/1005 [01:08<00:00, 14.75it/s, loss=6.3223, ppl=556.87]
<> Validating...

<> Epoch 22 Results:
<>  Time: 0:01:09
Train Loss: 5.5243 | Train PPL: 250.71
Valid Loss: 5.7753 | Valid PPL: 322.23
<> Saved new best model with validation loss: 5.7753
Epoch 23/30: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 1005/1005 [01:08<00:00, 14.77it/s, loss=6.3283, ppl=560.19]
<> Validating...

<> Epoch 23 Results:
<>  Time: 0:01:09
Train Loss: 5.5105 | Train PPL: 247.28
Valid Loss: 5.7673 | Valid PPL: 319.66
<> Saved new best model with validation loss: 5.7673
Epoch 24/30: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 1005/1005 [01:07<00:00, 14.79it/s, loss=6.3058, ppl=547.72]
<> Validating...

<> Epoch 24 Results:
<>  Time: 0:01:09
Train Loss: 5.5001 | Train PPL: 244.72
Valid Loss: 5.7656 | Valid PPL: 319.12
<> Saved new best model with validation loss: 5.7656
Epoch 25/30: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 1005/1005 [01:07<00:00, 14.85it/s, loss=6.3444, ppl=569.31]
<> Validating...

<> Epoch 25 Results:
<>  Time: 0:01:08
Train Loss: 5.4937 | Train PPL: 243.15
Valid Loss: 5.7666 | Valid PPL: 319.44
<> No improvement for 1 epoch(s).
Epoch 26/30: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 1005/1005 [01:07<00:00, 14.85it/s, loss=6.3357, ppl=564.37]
<> Validating...

<> Epoch 26 Results:
<>  Time: 0:01:08
Train Loss: 5.4913 | Train PPL: 242.58
Valid Loss: 5.7630 | Valid PPL: 318.30
<> Saved new best model with validation loss: 5.7630
Epoch 27/30: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 1005/1005 [01:07<00:00, 14.99it/s, loss=6.3218, ppl=556.55]
<> Validating...

<> Epoch 27 Results:
<>  Time: 0:01:08
Train Loss: 5.4924 | Train PPL: 242.83
Valid Loss: 5.7531 | Valid PPL: 315.16
<> Saved new best model with validation loss: 5.7531
Epoch 28/30: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 1005/1005 [01:07<00:00, 14.99it/s, loss=6.2990, ppl=544.03]
<> Validating...

<> Epoch 28 Results:
<>  Time: 0:01:08
Train Loss: 5.4967 | Train PPL: 243.90
Valid Loss: 5.7431 | Valid PPL: 312.02
<> Saved new best model with validation loss: 5.7431
Epoch 29/30: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 1005/1005 [01:07<00:00, 14.97it/s, loss=6.2647, ppl=525.66]
<> Validating...

<> Epoch 29 Results:
<>  Time: 0:01:08
Train Loss: 5.4966 | Train PPL: 243.86
Valid Loss: 5.7391 | Valid PPL: 310.80
<> Saved new best model with validation loss: 5.7391
Epoch 30/30: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 1005/1005 [01:06<00:00, 15.03it/s, loss=6.2860, ppl=537.01]
<> Validating...

<> Epoch 30 Results:
<>  Time: 0:01:07
Train Loss: 5.4940 | Train PPL: 243.24
Valid Loss: 5.7372 | Valid PPL: 310.20
<> Saved new best model with validation loss: 5.7372

==================================================
<> Training Complete!
==================================================
Best validation loss: 5.7372
Total time: 0:32:16

<> Loading Best Model for Evaluation...

==================================================
<> FINAL TEST EVALUATION
==================================================
Testing: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 118/118 [00:02<00:00, 53.22it/s]
>> Final Test Loss: 4.8520
>> Final Test Perplexity: 128.00
==================================================