import pandas as pd
import matplotlib.pyplot as plt

# ==========================================
# 1. Data Setup (Full 100 Epochs Data)
# ==========================================

# We keep the full data here, but we will SLICE it later for plotting
full_epochs = list(range(1, 101))

# Dummy example data (replace with your actual numbers)
# Each list should have the same length as epochs
#standard_transformer = {
#    "train_loss": [
#        8.2162,7.3298,7.1527,6.9992,6.8713,6.7736,6.6927,6.6257,6.5626,6.5032,
#        6.4449,6.3907,6.3385,6.29,6.2445,6.2032,6.1639,6.1317,6.0993,6.0645,
#        6.0323,6.0008,5.9711,5.9453,5.9181,5.8929,5.8759,5.8521,5.8275,5.8016,
#        5.7814,5.7595,5.7387,5.7155,5.6947,5.6735,5.6533,5.6331,5.6149,5.5976,
#        5.5796,5.5631,5.5462,5.5323,5.5199,5.5088,5.4951,5.4826,5.4668,5.4525,
#        5.44,5.4287,5.4169,5.4073,5.399,5.3894,5.3794,5.3701,5.3615,5.3538,
#        5.3448,5.3353,5.3273,5.3204,5.3128,5.3065,5.2999,5.294,5.2895,5.284,
#        5.2789,5.2731,5.2685,5.2645,5.26,5.2559,5.2521,5.2491,5.2464,5.2437,
#        5.2404,5.2385,5.2371,5.2351,5.2338,5.2318,5.2305,5.2294,5.2279,5.2268,
#        5.226,5.2248,5.2238,5.2233,5.2229,5.2235,5.2231,5.2228,5.2226,5.2221
#    ],
#    "train_ppl": [
#        3700.59,1525.04,1277.51,1095.78,964.17,874.49,806.53,754.26,708.14,667.28,
#        629.47,596.25,565.97,539.13,515.19,494.34,475.29,460.21,445.57,430.3,
#        416.68,403.77,391.92,381.96,371.69,362.47,356.35,347.95,339.5,330.84,
#        324.21,317.19,310.67,303.54,297.28,291.05,285.23,279.54,274.48,269.78,
#        264.96,260.63,256.25,252.72,249.61,246.86,243.49,240.47,236.69,233.33,
#        230.45,227.85,225.18,223.03,221.18,219.07,216.9,214.89,213.04,211.42,
#        209.51,207.54,205.89,204.46,202.92,201.65,200.31,199.14,198.24,197.15,
#        196.16,195.01,194.12,193.35,192.48,191.69,190.96,190.39,189.89,189.37,
#        188.75,188.39,188.12,187.75,187.51,187.13,186.88,186.68,186.39,186.19,
#        186.05,185.82,185.64,185.55,185.47,185.58,185.51,185.45,185.42,185.33
#    ],
#    "valid_loss": [
#        7.1521,6.9636,6.8253,6.7013,6.6011,6.541,6.5008,6.4557,6.4133,6.3802,
#        6.3284,6.2867,6.2527,6.2232,6.19,6.1618,6.1387,6.1186,6.1004,6.0785,
#        6.0773,6.0589,6.0372,6.0233,6.0069,6.0011,5.9996,5.9848,5.9575,5.9425,
#        5.9363,5.9158,5.9124,5.9045,5.8953,5.8799,5.8748,5.8687,5.8635,5.8545,
#        5.8539,5.8473,5.8427,5.8363,5.827,5.8207,5.824,5.8169,5.8107,5.801,
#        5.7963,5.7937,5.7925,5.7972,5.7935,5.7889,5.7868,5.7821,5.7757,5.7711,
#        5.7713,5.767,5.7601,5.7593,5.7594,5.7594,5.7556,5.7517,5.751,5.7508,
#        5.7465,5.7442,5.7413,5.7384,5.7369,5.7363,5.7355,5.7349,5.7336,5.733,
#        5.7323,5.732,5.7318,5.7307,5.7292,5.7292,5.7282,5.728,5.7277,5.7273,
#        5.7271,5.7268,5.7267,5.7266,5.7264,5.7264,5.7263,5.7263,5.7263,5.7263
#    ],
#    "valid_ppl": [
#        1276.76,1057.45,920.85,813.43,735.89,693.01,665.67,636.33,609.89,590.02,
#        560.26,537.36,519.4,504.32,487.84,474.28,463.46,454.24,446.04,436.39,
#        435.87,427.91,418.71,412.96,406.24,403.89,403.28,397.36,386.64,380.89,
#        378.54,370.85,369.61,366.67,363.32,357.77,355.97,353.77,351.96,348.79,
#        348.6,346.29,344.7,342.51,339.34,337.22,338.31,335.94,333.85,330.64,
#        329.08,328.23,327.82,329.36,328.16,326.66,325.98,324.44,322.38,320.89,
#        320.95,319.59,317.39,317.14,317.15,317.16,315.96,314.72,314.49,314.44,
#        313.1,312.38,311.46,310.57,310.12,309.93,309.68,309.47,309.08,308.91,
#        308.69,308.6,308.54,308.19,307.72,307.74,307.42,307.37,307.25,307.13,
#        307.09,307,306.95,306.92,306.87,306.86,306.83,306.83,306.83,306.83
#    ],
#}

#standard_transformer = {
#    "train_loss": [
#        8.7722, 7.6075, 7.3584, 7.2466, 7.1527, 7.0624, 6.979, 6.9022, 6.8335, 6.7764,
#        6.7266, 6.6839, 6.6453, 6.6079, 6.5737, 6.5415, 6.5085, 6.4748, 6.4434, 6.4126,
#        6.3829, 6.3539, 6.3308, 6.3115, 6.2873, 6.2639, 6.2408, 6.22, 6.197, 6.1752,
#        6.1575, 6.1443, 6.1307, 6.1134, 6.0926, 6.0769, 6.0586, 6.0435, 6.0288, 6.0161,
#        6.0035, 5.9918, 5.983, 5.9759, 5.9655, 5.9534, 5.9445, 5.933, 5.9206, 5.9074,
#        5.8955, 5.8856, 5.8749, 5.8668, 5.8578, 5.8505, 5.8431, 5.8367, 5.8309, 5.8254,
#        5.8162, 5.8088, 5.8026, 5.7967, 5.7915, 5.7858, 5.7814, 5.7774, 5.7723, 5.7687,
#        5.7648, 5.7607, 5.7579, 5.7551, 5.752, 5.749, 5.7463, 5.7438, 5.7422, 5.7396,
#        5.7377, 5.7358, 5.7342, 5.7328, 5.7315, 5.7295, 5.7286, 5.7276, 5.7273, 5.7264,
#        5.7252, 5.7246, 5.7243, 5.7239, 5.7239, 5.7244, 5.7244, 5.7237, 5.7236, 5.7237
#    ],
#    "train_ppl": [
#        6452.47, 2013.15, 1569.26, 1403.3, 1277.58, 1167.21, 1073.88, 994.42, 928.46, 876.87,
#        834.31, 799.39, 769.13, 740.9, 716.04, 693.33, 670.83, 648.62, 628.51, 609.49,
#        591.63, 574.73, 561.61, 550.89, 537.72, 525.25, 513.29, 502.69, 491.28, 480.69,
#        472.27, 466.07, 459.74, 451.86, 442.58, 435.69, 427.76, 421.35, 415.2, 409.96,
#        404.83, 400.12, 396.61, 393.82, 389.75, 385.08, 381.65, 377.29, 372.63, 367.75,
#        363.38, 359.81, 355.98, 353.11, 349.95, 347.4, 344.85, 342.66, 340.67, 338.81,
#        335.7, 333.23, 331.16, 329.2, 327.51, 325.63, 324.22, 322.92, 321.27, 320.11,
#        318.86, 317.59, 316.67, 315.81, 314.81, 313.87, 313.02, 312.26, 311.75, 310.94,
#        310.34, 309.76, 309.28, 308.83, 308.43, 307.81, 307.55, 307.22, 307.13, 306.87,
#        306.48, 306.31, 306.22, 306.1, 306.09, 306.24, 306.26, 306.04, 306.0, 306.05
#    ],
#    "valid_loss": [
#        7.614, 7.1515, 7.0334, 6.9426, 6.8637, 6.7867, 6.7218, 6.6545, 6.6033, 6.5693,
#        6.5406, 6.5104, 6.4958, 6.4817, 6.4657, 6.4466, 6.4196, 6.3965, 6.3772, 6.3504,
#        6.3334, 6.3179, 6.2966, 6.2943, 6.2777, 6.2595, 6.2376, 6.2309, 6.2116, 6.2039,
#        6.1895, 6.1862, 6.1761, 6.1532, 6.1471, 6.1372, 6.1333, 6.1247, 6.1145, 6.1029,
#        6.1021, 6.0994, 6.0946, 6.0862, 6.0838, 6.0681, 6.0733, 6.0584, 6.0552, 6.0461,
#        6.0374, 6.0361, 6.0306, 6.0269, 6.0227, 6.0179, 6.0156, 6.0137, 6.0102, 6.0111,
#        6.0084, 6.0034, 6.0026, 6.0012, 5.9988, 5.9969, 5.997, 5.9947, 5.9932, 5.991,
#        5.9893, 5.9865, 5.9847, 5.9829, 5.9811, 5.9801, 5.9792, 5.9787, 5.9789, 5.9783,
#        5.9781, 5.977, 5.9752, 5.974, 5.9737, 5.9731, 5.9725, 5.9726, 5.9721, 5.9719,
#        5.9717, 5.9716, 5.9714, 5.9713, 5.9712, 5.9711, 5.9711, 5.9711, 5.9711, 5.9711
#    ],
#    "valid_ppl": [
#        2026.31, 1276.07, 1133.85, 1035.51, 956.85, 886.03, 830.27, 776.28, 737.53, 712.88,
#        692.68, 672.12, 662.38, 653.09, 642.72, 630.54, 613.73, 599.71, 588.27, 572.74,
#        563.09, 554.41, 542.74, 541.49, 532.55, 522.94, 511.61, 508.19, 498.5, 494.7,
#        487.62, 485.99, 481.11, 470.2, 467.37, 462.76, 460.97, 456.99, 452.37, 447.16,
#        446.79, 445.58, 443.45, 439.75, 438.71, 431.84, 434.11, 427.67, 426.34, 422.46,
#        418.79, 418.25, 415.98, 414.44, 412.7, 410.7, 409.79, 409.01, 407.58, 407.94,
#        406.84, 404.79, 404.48, 403.9, 402.93, 402.17, 402.23, 401.32, 400.71, 399.8,
#        399.14, 398.02, 397.29, 396.6, 395.87, 395.49, 395.12, 394.91, 395.0, 394.79,
#        394.7, 394.24, 393.53, 393.06, 392.94, 392.71, 392.49, 392.54, 392.34, 392.23,
#        392.19, 392.15, 392.06, 392.0, 391.98, 391.95, 391.94, 391.93, 391.93, 391.93
#    ],
#}

#standard_transformer = {
#    "train_loss": [
#        9.3184, 8.2719, 7.7433, 7.504, 7.4052, 7.337, 7.2751, 7.2227, 7.1726, 7.1243,
#        7.0771, 7.0306, 6.986, 6.9441, 6.9072, 6.8684, 6.8334, 6.8006, 6.7707, 6.7437,
#        6.7197, 6.6957, 6.6744, 6.6543, 6.6345, 6.6162, 6.5978, 6.5812, 6.5653, 6.5484,
#        6.5335, 6.5186, 6.504, 6.4888, 6.4739, 6.46, 6.4462, 6.4324, 6.4201, 6.408,
#        6.396, 6.3851, 6.3738, 6.3621, 6.3513, 6.3403, 6.3313, 6.3244, 6.3154, 6.3029,
#        6.2948, 6.2863, 6.2785, 6.2716, 6.2641, 6.2572, 6.2509, 6.2441, 6.2386, 6.2321,
#        6.2265, 6.2219, 6.217, 6.2129, 6.209, 6.2048, 6.2015, 6.1992, 6.1963, 6.1934,
#        6.1882, 6.1832, 6.1806, 6.1778, 6.1752, 6.1726, 6.1706, 6.1688, 6.1671, 6.1656,
#        6.1638, 6.1625, 6.1613, 6.16, 6.1593, 6.1581, 6.1577, 6.1569, 6.1564, 6.1562,
#        6.1557, 6.1554, 6.1547, 6.1543, 6.1547, 6.1542, 6.1546, 6.154, 6.1545, 6.1547
#    ],
#    "train_ppl": [
#        11141.59, 3912.27, 2306.06, 1815.28, 1644.59, 1536.07, 1443.85, 1370.16, 1303.17, 1241.83,
#        1184.53, 1130.66, 1081.44, 1037.04, 999.48, 961.44, 928.35, 898.36, 871.94, 848.69,
#        828.53, 808.91, 791.88, 776.09, 760.91, 747.14, 733.48, 721.43, 710.0, 698.1,
#        687.84, 677.66, 667.79, 657.76, 648.0, 639.06, 630.33, 621.67, 614.09, 606.66,
#        599.41, 592.96, 586.31, 579.43, 573.26, 566.97, 561.88, 558.04, 553.03, 546.17,
#        541.75, 537.17, 532.98, 529.3, 525.36, 521.75, 518.48, 514.98, 512.12, 508.81,
#        505.98, 503.66, 501.19, 499.15, 497.22, 495.14, 493.47, 492.34, 490.93, 489.52,
#        486.99, 484.54, 483.3, 481.93, 480.68, 479.43, 478.47, 477.61, 476.79, 476.07,
#        475.23, 474.63, 474.06, 473.43, 473.11, 472.54, 472.32, 471.98, 471.72, 471.65,
#        471.41, 471.24, 470.91, 470.74, 470.9, 470.67, 470.86, 470.59, 470.83, 470.93
#    ],
#    "valid_loss": [
#        8.3839, 7.6699, 7.3023, 7.1729, 7.1208, 7.0569, 7.0044, 6.9491, 6.909, 6.8622,
#        6.8208, 6.7806, 6.7422, 6.7052, 6.6775, 6.6511, 6.6219, 6.5967, 6.5783, 6.5595,
#        6.5443, 6.5257, 6.5149, 6.4999, 6.4886, 6.4808, 6.4687, 6.4618, 6.4542, 6.4489,
#        6.4437, 6.4301, 6.4187, 6.4069, 6.4007, 6.3954, 6.3871, 6.3816, 6.3734, 6.3636,
#        6.3595, 6.3529, 6.3474, 6.3411, 6.3354, 6.3281, 6.321, 6.3081, 6.3069, 6.2984,
#        6.2946, 6.2868, 6.2863, 6.28, 6.2784, 6.2755, 6.2715, 6.2655, 6.2608, 6.2583,
#        6.2556, 6.2527, 6.2497, 6.2485, 6.2453, 6.2418, 6.238, 6.2388, 6.2423, 6.2376,
#        6.2316, 6.2307, 6.2288, 6.2269, 6.2243, 6.223, 6.2218, 6.2212, 6.2201, 6.2195,
#        6.2187, 6.2181, 6.2176, 6.2169, 6.216, 6.2161, 6.2153, 6.2151, 6.2149, 6.2144,
#        6.2143, 6.2142, 6.2143, 6.2143, 6.2141, 6.214, 6.2139, 6.2139, 6.2139, 6.2139
#    ],
#    "valid_ppl": [
#        4376.07, 2142.96, 1483.66, 1303.6, 1237.4, 1160.8, 1101.5, 1042.21, 1001.24, 955.49,
#        916.67, 880.56, 847.43, 816.68, 794.34, 773.65, 751.39, 732.69, 719.28, 705.94,
#        695.27, 682.44, 675.15, 665.1, 657.59, 652.52, 644.65, 640.22, 635.38, 632.03,
#        628.7, 620.26, 613.19, 606.01, 602.25, 599.06, 594.14, 590.9, 586.07, 580.32,
#        577.94, 574.15, 571.02, 567.45, 564.17, 560.1, 556.12, 548.99, 548.33, 543.71,
#        541.63, 537.41, 537.19, 533.78, 532.94, 531.41, 529.28, 526.13, 523.65, 522.31,
#        520.92, 519.42, 517.85, 517.23, 515.59, 513.79, 511.86, 512.25, 514.05, 511.64,
#        508.57, 508.13, 507.12, 506.17, 504.85, 504.2, 503.61, 503.31, 502.75, 502.47,
#        502.06, 501.76, 501.49, 501.17, 500.71, 500.75, 500.33, 500.27, 500.12, 499.9,
#        499.84, 499.77, 499.82, 499.84, 499.75, 499.68, 499.66, 499.65, 499.65, 499.65
#    ]
#}

standard_transformer = {
    "train_loss": [
        7.8136, 7.1452, 6.9151, 6.7469, 6.6242, 6.5218, 6.4304, 6.3461, 6.2691, 6.2048,
        6.1476, 6.0909, 6.0396, 5.9878, 5.9367, 5.8931, 5.8531, 5.8133, 5.7723, 5.7309,
        5.6959, 5.6609, 5.6265, 5.593, 5.563, 5.5331, 5.5023, 5.4746, 5.4466, 5.4217,
        5.3942, 5.3669, 5.3419, 5.3184, 5.2948, 5.2728, 5.2524, 5.2318, 5.2106, 5.1925,
        5.1733, 5.1542, 5.1363, 5.1189, 5.1014, 5.088, 5.0737, 5.0595, 5.0459, 5.0321,
        5.0192, 5.0056, 4.9938, 4.983, 4.9715, 4.9616, 4.9525, 4.9428, 4.9328, 4.9228,
        4.9134, 4.9041, 4.8952, 4.8848, 4.8771, 4.8689
    ],
    "train_ppl": [
        2474.11, 1268.06, 1007.35, 851.45, 753.09, 679.83, 620.42, 570.24, 528.02, 495.14,
        467.61, 441.8, 419.72, 398.52, 378.67, 362.54, 348.32, 334.72, 321.28, 308.24,
        297.65, 287.41, 277.7, 268.53, 260.6, 252.94, 245.27, 238.55, 231.96, 226.26,
        220.12, 214.2, 208.92, 204.06, 199.3, 194.96, 191.03, 187.13, 183.2, 179.92,
        176.5, 173.16, 170.08, 167.16, 164.25, 162.06, 159.77, 157.51, 155.38, 153.25,
        151.29, 149.24, 147.49, 145.91, 144.25, 142.83, 141.52, 140.16, 138.77, 137.39,
        136.1, 134.85, 133.65, 132.26, 131.26, 130.18
    ],
    "valid_loss": [
        6.9872, 6.7813, 6.61, 6.5221, 6.4518, 6.3661, 6.2945, 6.2312, 6.1909, 6.1426,
        6.106, 6.0796, 6.0445, 6.0154, 5.9741, 5.9563, 5.9259, 5.9115, 5.8888, 5.8861,
        5.8683, 5.8472, 5.8396, 5.8239, 5.8145, 5.8009, 5.786, 5.7849, 5.7784, 5.7673,
        5.7441, 5.7397, 5.7364, 5.74, 5.7429, 5.7356, 5.7244, 5.7248, 5.7162, 5.7066,
        5.7074, 5.7017, 5.699, 5.7, 5.7085, 5.7073, 5.6994, 5.6918, 5.6851, 5.681,
        5.6785, 5.6767, 5.6724, 5.6668, 5.665, 5.6608, 5.6591, 5.6587, 5.6534, 5.6513,
        5.6519, 5.6489, 5.6446, 5.6427, 5.6417, 5.6396
    ],
    "valid_ppl": [
        1082.67, 881.22, 742.47, 679.99, 633.86, 581.76, 541.56, 508.38, 488.27, 465.25,
        448.53, 436.86, 421.78, 409.7, 393.1, 386.18, 374.63, 369.26, 360.96, 359.99,
        353.64, 346.27, 343.63, 338.3, 335.12, 330.61, 325.69, 325.34, 323.23, 319.67,
        312.33, 310.96, 309.94, 311.07, 311.98, 309.69, 306.24, 306.38, 303.76, 300.84,
        301.09, 299.39, 298.57, 298.85, 301.41, 301.06, 298.69, 296.44, 294.46, 293.25,
        292.51, 291.98, 290.73, 289.11, 288.6, 287.39, 286.9, 286.78, 285.26, 284.66,
        284.83, 283.99, 282.75, 282.23, 281.93, 281.34
    ]
}

#standard_transformer = {
#    "train_loss": [
#        7.5479, 6.9438, 6.692, 6.5321, 6.4014, 6.2792, 6.1702, 6.0768, 5.9943, 5.9207,
#        5.8527, 5.7915, 5.7364, 5.684, 5.6356, 5.5879, 5.5427, 5.4984, 5.4589, 5.4195,
#        5.3803, 5.3442, 5.3079, 5.2719, 5.2364, 5.2022, 5.1692, 5.1395, 5.1118, 5.0834,
#        5.0573, 5.0309, 5.0067, 4.9806, 4.9544, 4.9292, 4.9056, 4.8826
#    ],
#    "train_ppl": [
#        1896.84, 1036.75, 805.95, 686.82, 602.69, 533.34, 478.3, 435.64, 401.12, 372.67,
#        348.19, 327.5, 309.94, 294.12, 280.23, 267.16, 255.37, 244.3, 234.85, 225.76,
#        217.09, 209.38, 201.92, 194.78, 187.99, 181.67, 175.78, 170.63, 165.98, 161.32,
#        157.16, 153.07, 149.41, 145.56, 141.8, 138.27, 135.04, 131.97
#    ],
#    "valid_loss": [
#        6.8716, 6.5937, 6.4216, 6.3328, 6.2334, 6.1523, 6.0926, 6.0352, 5.9899, 5.9536,
#        5.921, 5.8902, 5.8761, 5.8608, 5.8499, 5.8446, 5.8336, 5.8184, 5.7914, 5.7634,
#        5.751, 5.7494, 5.7371, 5.7269, 5.7197, 5.7057, 5.697, 5.687, 5.6831, 5.6802,
#        5.6825, 5.6844, 5.6921, 5.6854, 5.6764, 5.6629, 5.6572, 5.6543
#    ],
#    "valid_ppl": [
#        964.54, 730.49, 615.01, 562.73, 509.48, 469.79, 442.58, 417.86, 399.39, 385.15,
#        372.79, 361.49, 356.41, 350.99, 347.2, 345.36, 341.57, 336.42, 327.46, 318.43,
#        314.52, 314.02, 310.16, 307.01, 304.82, 300.57, 297.97, 295, 293.84, 293.01,
#        293.7, 294.25, 296.52, 294.52, 291.91, 287.99, 286.36, 285.5
#    ]
#}



hierarchical_transformer_weighted_sum = {
    "train_loss": [
        23.6638,8.3151,7.4824,7.2377,7.0663,6.9228,6.8044,6.7048,6.6215,6.5595,
        6.5021,6.4449,6.394,6.3507,6.3132,6.2788,6.2415,6.2034,6.1684,6.1401,
        6.1098,6.0808,6.0521,6.023,5.992,5.9638,5.9392,5.9148,5.8888,5.8626,
        5.8452,5.8278,5.8117,5.79,5.7706,5.7583,5.739,5.7246,5.7113,5.6948,
        5.6787,5.6656,5.6486,5.6325,5.6193,5.6057,5.5912,5.5777,5.5629,5.551,
        5.5398,5.5302,5.5186,5.5089,5.5001,5.4911,5.4814,5.4721,5.4624,5.4551,
        5.4459,5.4384,5.4285,5.4212,5.4145,5.4059,5.3992,5.3944,5.3877,5.3817,
        5.3763,5.3717,5.3645,5.3581,5.3525,5.3474,5.3429,5.3382,5.3338,5.3292,
        5.3262,5.3224,5.3193,5.3167,5.3147,5.3112,5.3096,5.3073,5.3058,5.3048,
        5.3032,5.302,5.3,5.2995,5.2984,5.2971,5.2971,5.2966,5.2963,5.2964
    ],
    "train_ppl": [
        485165195.4,4084.96,1776.49,1390.83,1171.83,1015.18,901.8,816.31,751.03,705.9,
        666.52,629.49,598.24,572.87,551.78,533.12,513.6,494.41,477.43,464.11,
        450.26,437.36,424.99,412.83,400.22,389.09,379.63,370.47,360.97,351.63,
        345.58,339.63,334.19,327,320.73,316.81,310.74,306.31,302.27,297.33,
        292.56,288.76,283.89,279.36,275.71,271.98,268.07,264.48,260.57,257.49,
        254.63,252.19,249.28,246.88,244.73,242.52,240.17,237.96,235.66,233.95,
        231.82,230.06,227.8,226.15,224.63,222.71,221.23,220.16,218.69,217.4,
        216.21,215.23,213.69,212.32,211.13,210.07,209.12,208.14,207.22,206.28,
        205.65,204.87,204.24,203.72,203.3,202.58,202.27,201.81,201.5,201.3,
        200.99,200.74,200.35,200.23,200.02,199.76,199.75,199.65,199.6,199.61
    ],
    "valid_loss": [
        8.6563,7.2699,7.0405,6.8825,6.75,6.6357,6.5411,6.4687,6.4265,6.374,
        6.3244,6.2944,6.2739,6.2406,6.2198,6.2036,6.1785,6.1487,6.1286,6.1207,
        6.1024,6.0928,6.0649,6.051,6.0341,6.0366,6.0284,6.0149,5.9906,5.9822,
        5.9837,5.9763,5.9741,5.9568,5.9534,5.939,5.9431,5.9461,5.9287,5.9343,
        5.9293,5.913,5.9101,5.9087,5.896,5.9112,5.9012,5.8906,5.8884,5.8892,
        5.8811,5.8826,5.8803,5.8751,5.8677,5.8667,5.8649,5.8581,5.8611,5.8547,
        5.852,5.8615,5.8513,5.8583,5.8548,5.8496,5.8534,5.8494,5.8452,5.8502,
        5.8488,5.8408,5.8391,5.8369,5.8346,5.8293,5.8301,5.8307,5.8296,5.8286,
        5.828,5.8255,5.8259,5.825,5.8243,5.8229,5.8248,5.824,5.8229,5.8224,
        5.8215,5.8212,5.8206,5.8204,5.8204,5.8198,5.8195,5.8191,5.8191,5.8191
    ],
    "valid_ppl": [
        5745.99,1436.35,1141.91,975.05,854.06,761.82,693.05,644.61,618.01,586.39,
        558.02,541.55,530.55,513.16,502.62,494.52,482.25,468.13,458.81,455.2,
        446.94,442.65,430.49,424.53,417.41,418.46,415.04,409.47,399.67,396.3,
        396.91,393.96,393.1,386.36,385.08,379.54,381.11,382.25,375.68,377.76,
        375.89,369.83,368.75,368.21,363.57,369.16,365.48,361.61,360.82,361.13,
        358.2,358.74,357.93,356.07,353.45,353.07,352.44,350.04,351.1,348.89,
        347.92,351.24,347.69,350.12,348.9,347.09,348.43,347.02,345.59,347.29,
        346.83,344.06,343.47,342.7,341.94,340.12,340.39,340.59,340.23,339.88,
        339.69,338.82,338.95,338.67,338.43,337.96,338.6,338.33,337.94,337.79,
        337.49,337.37,337.16,337.1,337.12,336.9,336.8,336.68,336.67,336.66
    ],
}

#hierarchical_transformer_C2P_P2C = {
#    "train_loss": [
#        8.1714, 7.2955, 7.0903, 6.9167, 6.7798, 6.6763, 6.598, 6.5311, 6.471,
#        6.41, 6.3523, 6.2995, 6.2482, 6.1965, 6.1481, 6.1027, 6.0687, 6.031,
#        5.9937, 5.962, 5.9368, 5.9065, 5.875, 5.846, 5.8166, 5.7871, 5.7602,
#        5.7368, 5.7154, 5.6956, 5.6825, 5.6649, 5.646, 5.6221, 5.6003,
#        5.5817, 5.5626, 5.5448, 5.53, 5.5169, 5.5023, 5.4849, 5.4694,
#        5.4558, 5.4441, 5.4327, 5.4233, 5.407, 5.3949, 5.3823, 5.3714,
#        5.3596, 5.3471, 5.337, 5.3274, 5.3178, 5.3085, 5.2984, 5.2903,
#        5.2829, 5.2766, 5.2691, 5.2611, 5.2532, 5.2457, 5.239, 5.2325,
#        5.2267, 5.2202, 5.2143, 5.2095, 5.2046, 5.1997, 5.1959, 5.1918,
#        5.1887, 5.1845, 5.1818, 5.1782, 5.1755, 5.1723, 5.171, 5.1685,
#        5.1663, 5.1655, 5.1637, 5.162, 5.1613, 5.1603, 5.1594, 5.1584,
#        5.1576, 5.1569, 5.1566, 5.1567, 5.1551, 5.1554, 5.1559, 5.1548,
#        5.1549
#    ],
#    "train_ppl": [
#        3538.45, 1473.59, 1200.31, 1009.01, 879.87, 793.4, 733.61, 686.15,
#        646.12, 607.88, 573.82, 544.28, 517.06, 491.05, 467.82, 447.06,
#        432.14, 416.11, 400.9, 388.38, 378.7, 367.43, 356.02, 345.84,
#        335.83, 326.05, 317.41, 310.08, 303.5, 297.56, 293.67, 288.57,
#        283.15, 276.47, 270.51, 265.51, 260.5, 255.91, 252.14, 248.86,
#        245.27, 241.02, 237.32, 234.11, 231.39, 228.76, 226.63, 222.96,
#        220.28, 217.53, 215.17, 212.64, 209.99, 207.9, 205.91, 203.94,
#        202.05, 200.02, 198.4, 196.93, 195.71, 194.24, 192.69, 191.17,
#        189.74, 188.47, 187.26, 186.18, 184.97, 183.89, 183, 182.11,
#        181.21, 180.54, 179.79, 179.24, 178.48, 178.01, 177.36, 176.88,
#        176.32, 176.09, 175.65, 175.26, 175.12, 174.81, 174.52, 174.39,
#        174.22, 174.06, 173.89, 173.75, 173.63, 173.58, 173.6, 173.32,
#        173.37, 173.44, 173.26, 173.28
#    ],
#    "valid_loss": [
#        7.1354, 6.9317, 6.7537, 6.6135, 6.5148, 6.447, 6.4007, 6.3507,
#        6.3135, 6.2726, 6.2367, 6.1999, 6.166, 6.1365, 6.1084, 6.0985,
#        6.0548, 6.0327, 6.0105, 6.0006, 5.9928, 5.9687, 5.9436, 5.9305,
#        5.9189, 5.907, 5.8953, 5.8793, 5.8763, 5.8695, 5.8749, 5.8623,
#        5.854, 5.8495, 5.8373, 5.8314, 5.8183, 5.8128, 5.8119, 5.8089,
#        5.8073, 5.7935, 5.7958, 5.7957, 5.7893, 5.7962, 5.7915, 5.7862,
#        5.7793, 5.7676, 5.762, 5.7569, 5.7506, 5.7446, 5.7393, 5.7399,
#        5.7344, 5.7391, 5.7419, 5.7385, 5.7392, 5.7423, 5.736, 5.7339,
#        5.7334, 5.7341, 5.7301, 5.7239, 5.7219, 5.7202, 5.7204, 5.719,
#        5.717, 5.7161, 5.716, 5.7144, 5.714, 5.7142, 5.7138, 5.7136,
#        5.7134, 5.7127, 5.7119, 5.7108, 5.7102, 5.7092, 5.7085, 5.7079,
#        5.7078, 5.707, 5.7063, 5.7058, 5.7055, 5.7057, 5.7056, 5.7056,
#        5.7057, 5.7057, 5.7058, 5.7057
#    ],
#    "valid_ppl": [
#        1255.62, 1024.28, 857.26, 745.09, 675.08, 630.82, 602.24, 572.89,
#        551.98, 529.83, 511.15, 492.71, 476.28, 462.45, 449.61, 445.2,
#        426.14, 416.84, 407.69, 403.69, 400.53, 391, 381.32, 376.36,
#        372.02, 367.61, 363.34, 357.57, 356.48, 354.07, 355.99, 351.53,
#        348.61, 347.05, 342.86, 340.84, 336.39, 334.57, 334.26, 333.24,
#        332.72, 328.16, 328.91, 328.87, 326.79, 329.05, 327.49, 325.77,
#        323.54, 319.77, 317.98, 316.37, 314.37, 312.49, 310.83, 311.03,
#        309.33, 310.78, 311.65, 310.61, 310.81, 311.77, 309.83, 309.17,
#        309.01, 309.24, 308.01, 306.11, 305.47, 304.97, 305.01, 304.59,
#        303.98, 303.71, 303.7, 303.19, 303.09, 303.13, 303.01, 302.97,
#        302.9, 302.69, 302.44, 302.11, 301.92, 301.62, 301.43, 301.23,
#        301.21, 300.95, 300.75, 300.62, 300.51, 300.59, 300.54, 300.56,
#        300.58, 300.59, 300.59, 300.59
#    ]
#}

#hierarchical_transformer_C2P_P2C = {
#    "train_loss": [
#        8.7134, 7.5729, 7.323, 7.1997, 7.1003, 7.0102, 6.9198, 6.8351, 6.7595, 6.6965,
#        6.6432, 6.5955, 6.5524, 6.513, 6.4756, 6.4405, 6.4048, 6.3712, 6.3387, 6.3067,
#        6.2739, 6.2427, 6.2152, 6.1888, 6.16, 6.1327, 6.1081, 6.0827, 6.0625, 6.0476,
#        6.0288, 6.0086, 5.9848, 5.9701, 5.9542, 5.9412, 5.9271, 5.9097, 5.8965, 5.8819,
#        5.8682, 5.8536, 5.8408, 5.8306, 5.8213, 5.809, 5.7974, 5.7859, 5.7762, 5.7683,
#        5.7608, 5.7524, 5.7437, 5.7369, 5.7268, 5.7165, 5.7074, 5.6986, 5.6931, 5.6877,
#        5.681, 5.6747, 5.6692, 5.663, 5.6566, 5.6528, 5.6481, 5.6432, 5.6384, 5.6336,
#        5.6287, 5.6256, 5.6212, 5.6176, 5.6148, 5.6125, 5.6093, 5.6074, 5.6053, 5.6034,
#        5.6023, 5.6004, 5.5988, 5.5977, 5.5958, 5.5949, 5.5939, 5.5923, 5.5912, 5.5911,
#        5.5902, 5.5899, 5.589, 5.5889, 5.5883, 5.5889, 5.5883, 5.5881, 5.5885, 5.5876
#    ],
#    "train_ppl": [
#        6083.7, 1944.8, 1514.79, 1339.03, 1212.32, 1107.91, 1012.08, 929.89, 862.19, 809.56,
#        767.54, 731.8, 700.89, 673.81, 649.08, 626.72, 604.71, 584.75, 566.07, 548.24,
#        530.54, 514.23, 500.3, 487.26, 473.44, 460.67, 449.5, 438.22, 429.46, 423.1,
#        415.2, 406.93, 397.36, 391.55, 385.35, 380.38, 375.06, 368.58, 363.77, 358.5,
#        353.6, 348.5, 344.07, 340.55, 337.41, 333.29, 329.43, 325.68, 322.52, 319.99,
#        317.61, 314.94, 312.21, 310.11, 307, 303.85, 301.08, 298.46, 296.83, 295.2,
#        293.26, 291.41, 289.8, 288.02, 286.17, 285.09, 283.74, 282.36, 281, 279.66,
#        278.3, 277.43, 276.21, 275.22, 274.46, 273.82, 272.95, 272.44, 271.88, 271.34,
#        271.05, 270.52, 270.1, 269.8, 269.28, 269.05, 268.77, 268.35, 268.06, 268.03,
#        267.78, 267.72, 267.46, 267.44, 267.28, 267.44, 267.27, 267.22, 267.32, 267.1
#    ],
#    "valid_loss": [
#        7.5685, 7.1214, 7.0134, 6.9185, 6.8271, 6.7355, 6.6589, 6.5962, 6.5345, 6.4927,
#        6.4603, 6.4281, 6.3941, 6.3741, 6.3397, 6.3148, 6.2952, 6.2756, 6.2514, 6.2286,
#        6.2043, 6.188, 6.1768, 6.1613, 6.1341, 6.1228, 6.1064, 6.0938, 6.0831, 6.0716,
#        6.0686, 6.0376, 6.0307, 6.0201, 6.0177, 6.0248, 6.002, 5.9918, 5.9747, 5.9731,
#        5.9691, 5.9575, 5.9486, 5.9477, 5.9511, 5.9424, 5.9377, 5.9306, 5.9281, 5.9363,
#        5.934, 5.9341, 5.9232, 5.9305, 5.9118, 5.9087, 5.9001, 5.8998, 5.8977, 5.897,
#        5.8867, 5.8812, 5.8833, 5.8796, 5.8749, 5.8739, 5.871, 5.867, 5.8617, 5.8628,
#        5.8617, 5.86, 5.8585, 5.8567, 5.8561, 5.8542, 5.8536, 5.853, 5.8527, 5.8525,
#        5.8516, 5.8499, 5.8485, 5.8486, 5.849, 5.8491, 5.8476, 5.8465, 5.8466, 5.8464,
#        5.8464, 5.846, 5.846, 5.8458, 5.8457, 5.8457, 5.8458, 5.8457, 5.8457, 5.8457
#    ],
#    "valid_ppl": [
#        1936.26, 1238.23, 1111.41, 1010.81, 922.56, 841.72, 779.72, 732.32, 688.51, 660.29,
#        639.25, 618.99, 598.31, 586.43, 566.61, 552.69, 541.94, 531.43, 518.74, 507.05,
#        494.86, 486.86, 481.44, 474.06, 461.33, 456.16, 448.7, 443.1, 438.41, 433.37,
#        432.06, 418.87, 415.99, 411.64, 410.63, 413.54, 404.25, 400.15, 393.36, 392.74,
#        391.14, 386.63, 383.23, 382.87, 384.17, 380.84, 379.07, 376.39, 375.43, 378.54,
#        377.67, 377.69, 373.62, 376.34, 369.35, 368.23, 365.08, 364.95, 364.22, 363.95,
#        360.22, 358.23, 358.99, 357.67, 355.99, 355.65, 354.62, 353.2, 351.33, 351.71,
#        351.33, 350.71, 350.19, 349.57, 349.37, 348.68, 348.47, 348.29, 348.16, 348.11,
#        347.78, 347.21, 346.72, 346.75, 346.89, 346.93, 346.4, 346.03, 346.04, 345.98,
#        346.0, 345.83, 345.85, 345.78, 345.76, 345.76, 345.76, 345.74, 345.73, 345.73
#    ]
#}

#hierarchical_transformer_C2P_P2C = {
#    "train_loss": [
#        9.2603, 8.2079, 7.7044, 7.4711, 7.3673, 7.2979, 7.2376, 7.1904, 7.1398, 7.0881,
#        7.0365, 6.9836, 6.9317, 6.8828, 6.8368, 6.7946, 6.7533, 6.7162, 6.6824, 6.6527,
#        6.6249, 6.5984, 6.5731, 6.5537, 6.529, 6.5068, 6.4907, 6.4673, 6.448, 6.4324,
#        6.418, 6.3981, 6.383, 6.369, 6.3537, 6.3409, 6.326, 6.306, 6.2919, 6.2792,
#        6.2659, 6.2498, 6.2363, 6.2243, 6.2128, 6.2021, 6.1915, 6.1792, 6.1677, 6.1577,
#        6.1483, 6.1389, 6.1302, 6.1223, 6.1145, 6.1068, 6.0986, 6.0919, 6.0851, 6.0791,
#        6.0743, 6.0683, 6.0654, 6.0613, 6.0542, 6.0488, 6.0443, 6.0398, 6.0363, 6.0323,
#        6.0291, 6.0264, 6.0232, 6.0207, 6.0186, 6.0163, 6.0132, 6.0119, 6.0086, 6.0075,
#        6.0064, 6.0047, 6.0033, 6.002, 6.0012, 6.0, 5.999, 5.9985, 5.9977, 5.9975,
#        5.9965, 5.996, 5.9961, 5.9958, 5.9956, 5.9953, 5.9952, 5.9957, 5.9959, 5.9962
#    ],
#    "train_ppl": [
#        10512.48, 3669.9, 2218.04, 1756.52, 1583.43, 1477.14, 1390.8, 1326.66, 1261.16, 1197.61,
#        1137.42, 1078.8, 1024.19, 975.33, 931.54, 892.98, 856.9, 825.69, 798.26, 774.87,
#        753.6, 733.92, 715.6, 701.82, 684.74, 669.66, 659.02, 643.71, 631.46, 621.69,
#        612.75, 600.7, 591.7, 583.47, 574.63, 567.28, 558.89, 547.86, 540.16, 533.36,
#        526.29, 517.89, 510.99, 504.85, 499.08, 493.78, 488.58, 482.62, 477.08, 472.34,
#        467.92, 463.55, 459.55, 455.89, 452.35, 448.9, 445.25, 442.27, 439.26, 436.63,
#        434.55, 431.95, 430.69, 428.94, 425.9, 423.62, 421.68, 419.8, 418.33, 416.67,
#        415.36, 414.23, 412.91, 411.88, 411.0, 410.07, 408.79, 408.26, 406.92, 406.47,
#        406.02, 405.33, 404.78, 404.24, 403.93, 403.44, 403.04, 402.81, 402.5, 402.41,
#        402.03, 401.84, 401.84, 401.72, 401.67, 401.56, 401.5, 401.69, 401.79, 401.9
#    ],
#    "valid_loss": [
#        8.2972, 7.5997, 7.275, 7.1401, 7.0881, 7.0389, 6.9882, 6.9649, 6.8979, 6.8383,
#        6.7821, 6.7337, 6.6883, 6.6497, 6.6188, 6.5837, 6.545, 6.5153, 6.4906, 6.4683,
#        6.4486, 6.4267, 6.412, 6.3941, 6.3797, 6.37, 6.3498, 6.34, 6.3267, 6.3392,
#        6.3091, 6.2963, 6.2853, 6.2788, 6.2706, 6.2721, 6.2475, 6.2435, 6.2321, 6.2263,
#        6.2119, 6.2098, 6.1995, 6.1901, 6.179, 6.1715, 6.1649, 6.1557, 6.1492, 6.1443,
#        6.1363, 6.1318, 6.1297, 6.1232, 6.1185, 6.1169, 6.1104, 6.1078, 6.1042, 6.1009,
#        6.0981, 6.1008, 6.1093, 6.0842, 6.0907, 6.0797, 6.0851, 6.0765, 6.0803, 6.0729,
#        6.0759, 6.0701, 6.0703, 6.0689, 6.0695, 6.0684, 6.0665, 6.0646, 6.0632, 6.0617,
#        6.0606, 6.0593, 6.0586, 6.0583, 6.0594, 6.059, 6.0573, 6.0572, 6.0571, 6.0568,
#        6.0567, 6.0566, 6.0562, 6.0561, 6.0559, 6.056, 6.0561, 6.0561, 6.0561, 6.0561
#    ],
#    "valid_ppl": [
#        4012.73, 1997.53, 1443.79, 1261.49, 1197.66, 1140.17, 1083.72, 1058.84, 990.21, 932.87,
#        881.93, 840.29, 802.95, 772.56, 749.02, 723.18, 695.79, 675.4, 658.93, 644.41,
#        631.84, 618.1, 609.09, 598.32, 589.76, 584.07, 572.37, 566.8, 559.3, 566.33,
#        549.57, 542.54, 536.61, 533.13, 528.78, 529.58, 516.74, 514.65, 508.82, 505.88,
#        498.62, 497.58, 492.52, 487.88, 482.53, 478.91, 475.76, 471.42, 468.34, 466.06,
#        462.36, 460.29, 459.3, 456.32, 454.17, 453.47, 450.54, 449.35, 447.72, 446.25,
#        445.01, 446.2, 450.0, 438.86, 441.73, 436.88, 439.27, 435.5, 437.16, 433.93,
#        435.25, 432.72, 432.79, 432.22, 432.48, 432.01, 431.17, 430.34, 429.74, 429.11,
#        428.61, 428.08, 427.78, 427.65, 428.1, 427.96, 427.22, 427.16, 427.12, 427.02,
#        426.95, 426.91, 426.76, 426.72, 426.62, 426.65, 426.69, 426.72, 426.72, 426.71
#    ]
#}

hierarchical_transformer_C2P_P2C = {
    "train_loss": [
        7.7739, 7.0924, 6.8404, 6.669, 6.5493, 6.4538, 6.3714, 6.2927, 6.2149, 6.141,
        6.0764, 6.024, 5.9769, 5.923, 5.8752, 5.8317, 5.7882, 5.7444, 5.7068, 5.672,
        5.6407, 5.6086, 5.5738, 5.5459, 5.5158, 5.4915, 5.4694, 5.4504, 5.425, 5.3993,
        5.3755, 5.3515, 5.3282, 5.3039, 5.2837, 5.2618, 5.2434, 5.2217, 5.1986, 5.1819,
        5.1671, 5.1511, 5.1316, 5.1134, 5.11, 5.094, 5.0772, 5.0618, 5.0466, 5.0331
    ],
    "train_ppl": [
        2377.84, 1202.8, 934.86, 787.58, 698.78, 635.1, 584.89, 540.62, 500.16, 464.52,
        435.44, 413.23, 394.22, 373.52, 356.09, 340.93, 326.42, 312.43, 300.9, 290.63,
        281.67, 272.77, 263.43, 256.19, 248.58, 242.62, 237.33, 232.84, 227, 221.26,
        216.05, 210.92, 206.07, 201.11, 197.1, 192.82, 189.31, 185.24, 181.02, 178.03,
        175.41, 172.62, 169.29, 166.24, 165.68, 163.05, 160.32, 157.87, 155.5, 153.4
    ],
    "valid_loss": [
        6.9665, 6.7156, 6.5278, 6.4235, 6.3452, 6.2955, 6.2585, 6.2042, 6.1599, 6.1083,
        6.0819, 6.0527, 6.0199, 5.9839, 5.9609, 5.9493, 5.9243, 5.9006, 5.8897, 5.875,
        5.8647, 5.8374, 5.8226, 5.8081, 5.8099, 5.8055, 5.7995, 5.7735, 5.768, 5.7626,
        5.7598, 5.7574, 5.7597, 5.7476, 5.7429, 5.7417, 5.7391, 5.7343, 5.7419, 5.7382,
        5.7357, 5.7244, 5.7192, 5.7202, 5.718, 5.7146, 5.7041, 5.7048, 5.7029, 5.7
    ],
    "valid_ppl": [
        1060.53, 825.22, 683.86, 616.18, 569.77, 542.11, 522.43, 494.81, 473.37, 449.55,
        437.85, 425.26, 411.55, 396.99, 387.97, 383.47, 374.02, 365.26, 361.29, 356.03,
        352.37, 342.89, 337.86, 332.97, 333.6, 332.11, 330.14, 321.66, 319.91, 318.16,
        317.3, 316.52, 317.26, 313.45, 311.97, 311.59, 310.78, 309.29, 311.65, 310.51,
        309.72, 306.25, 304.67, 304.97, 304.3, 303.27, 300.08, 300.3, 299.73, 298.87
    ]
}

#hierarchical_transformer_C2P_P2C = {
#    "train_loss": [
#        7.5028, 6.8774, 6.6411, 6.4854, 6.358, 6.2454, 6.1437, 6.0501, 5.9678, 5.895,
#        5.8301, 5.7707, 5.7165, 5.6657, 5.6159, 5.5668, 5.5214, 5.4809, 5.4391, 5.4015,
#        5.3681, 5.3338, 5.3027, 5.2696, 5.2367, 5.2022, 5.172, 5.1451, 5.1183, 5.0926,
#        5.0658, 5.0372, 5.0101, 4.9848, 4.9584, 4.9327, 4.9089, 4.8864, 4.8636, 4.8434,
#        4.8234, 4.8039
#    ],
#    "train_ppl": [
#        1813.02, 970.11, 765.93, 655.48, 577.09, 515.62, 465.79, 424.16, 390.65, 363.21,
#        340.39, 320.78, 303.84, 288.79, 274.75, 261.58, 249.97, 240.05, 230.23, 221.73,
#        214.45, 207.22, 200.87, 194.34, 188.04, 181.67, 176.27, 171.58, 167.06, 162.81,
#        158.5, 154.04, 149.92, 146.17, 142.36, 138.75, 135.49, 132.47, 129.49, 126.9,
#        124.39, 121.98
#    ],
#    "valid_loss": [
#        6.7954, 6.5136, 6.3898, 6.288, 6.2058, 6.1438, 6.0906, 6.0429, 6.0039, 5.9631,
#        5.9299, 5.9136, 5.8941, 5.8645, 5.8455, 5.8275, 5.8399, 5.8408, 5.8318, 5.8088,
#        5.8046, 5.7945, 5.7916, 5.7817, 5.7861, 5.7782, 5.7657, 5.7592, 5.7477, 5.7482,
#        5.755, 5.7609, 5.7584, 5.754, 5.7519, 5.7538, 5.7453, 5.744, 5.7413, 5.7465,
#        5.741, 5.7387
#    ],
#    "valid_ppl": [
#        893.68, 674.24, 595.76, 538.08, 495.61, 465.84, 441.7, 421.11, 405.01, 388.83,
#        376.12, 370.05, 362.89, 352.29, 345.68, 339.5, 343.74, 344.05, 340.97, 333.22,
#        331.83, 328.48, 327.53, 324.31, 325.75, 323.18, 319.17, 317.1, 313.48, 313.62,
#        315.78, 317.62, 316.84, 315.44, 314.79, 315.39, 312.72, 312.3, 311.47, 313.09,
#        311.36, 310.67
#    ]
#}


# ==========================================
# 2. Logic: Handling Uneven Lengths
# ==========================================

# Define the start epoch for plotting (e.g., skip first 9 epochs to avoid spikes)
START_EPOCH = 10 

def plot_metric(metric_name, std_data_dict, hier_data_dict):
    plt.figure(figsize=(10, 6))
    
    # --- Plot Standard Transformer ---
    data_std = std_data_dict[metric_name]
    # Slice from START_EPOCH-1 (index) to end
    data_std_sliced = data_std[START_EPOCH-1:]
    # Create x-axis specifically for this data length
    x_std = list(range(START_EPOCH, START_EPOCH + len(data_std_sliced)))
    
    plt.plot(x_std, data_std_sliced, label="Standard Transformer", color='blue', linestyle='-', linewidth=1.5)

    # --- Plot Hierarchical Transformer ---
    data_hier = hier_data_dict[metric_name]
    # Slice from START_EPOCH-1 (index) to end
    data_hier_sliced = data_hier[START_EPOCH-1:]
    # Create x-axis specifically for this data length
    x_hier = list(range(START_EPOCH, START_EPOCH + len(data_hier_sliced)))
    
    plt.plot(x_hier, data_hier_sliced, label="Hierarchical Transformer (C2P-P2C)", color='green', linestyle='--', linewidth=2.0)

    # --- Styling ---
    plt.xlabel("Epoch")
    plt.ylabel(metric_name)
    plt.title(f"{metric_name} vs Epoch (Starting from Epoch {START_EPOCH})")
    plt.legend()
    plt.grid(True, linestyle='--', alpha=0.7)
    
    # Log scale for PPL usually looks better
    if "PPL" in metric_name:
        plt.yscale('log')
        
    plt.tight_layout()
    plt.show()

# ==========================================
# 3. Generate the Four Plots
# ==========================================

# 1. Train Loss
plot_metric("train_loss", standard_transformer, hierarchical_transformer_C2P_P2C)

# 2. Train PPL 
plot_metric("train_ppl", standard_transformer, hierarchical_transformer_C2P_P2C)

# 3. Valid Loss
plot_metric("valid_loss", standard_transformer, hierarchical_transformer_C2P_P2C)

# 4. Valid PPL 
plot_metric("valid_ppl", standard_transformer, hierarchical_transformer_C2P_P2C)
