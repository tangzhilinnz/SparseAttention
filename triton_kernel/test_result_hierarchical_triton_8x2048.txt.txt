==================================================
<> Training Transformer Model (AMP Enabled)
==================================================
Epoch 1/100:   0%|          | 0/6258 [00:00<?, ?it/s]/home/ztang13/workspace/SparseAttention/triton_kernel/Hierarchical_Transformer_Triton_WikiText103.py:2038: FutureWarning: `torch.cuda.amp.autocast(args...)` 
is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Epoch 1/100: 100%|██████████| 6258/6258 [24:10<00:00,  4.31it/s, loss=5.9345, ppl=377.85]  

<> Validating...
/home/ztang13/workspace/SparseAttention/triton_kernel/Hierarchical_Transformer_Triton_WikiText103.py:2089: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():

<> Epoch 1 Results:
<>  Time: 0:24:12
Train Loss: 6.5964 | Train PPL: 732.44
Valid Loss: 5.6943 | Valid PPL: 297.18
<> Saved new best model with validation loss: 5.6943
Epoch 2/100: 100%|██████████| 6258/6258 [24:01<00:00,  4.34it/s, loss=5.5528, ppl=257.95]

<> Validating...

<> Epoch 2 Results:
<>  Time: 0:24:03
Train Loss: 5.5972 | Train PPL: 269.67
Valid Loss: 5.3006 | Valid PPL: 200.46
<> Saved new best model with validation loss: 5.3006
Epoch 3/100: 100%|██████████| 6258/6258 [24:12<00:00,  4.31it/s, loss=5.3678, ppl=214.40]

<> Validating...

<> Epoch 3 Results:
<>  Time: 0:24:13
Train Loss: 5.3224 | Train PPL: 204.88
Valid Loss: 5.1131 | Valid PPL: 166.19
<> Saved new best model with validation loss: 5.1131
Epoch 4/100: 100%|██████████| 6258/6258 [24:13<00:00,  4.30it/s, loss=5.2572, ppl=191.94]

<> Validating...

<> Epoch 4 Results:
<>  Time: 0:24:15
Train Loss: 5.1602 | Train PPL: 174.20
Valid Loss: 4.9894 | Valid PPL: 146.84
<> Saved new best model with validation loss: 4.9894
Epoch 5/100: 100%|██████████| 6258/6258 [24:17<00:00,  4.29it/s, loss=5.1764, ppl=177.04]

<> Validating...

<> Epoch 5 Results:
<>  Time: 0:24:18
Train Loss: 5.0453 | Train PPL: 155.29
Valid Loss: 4.9021 | Valid PPL: 134.57
<> Saved new best model with validation loss: 4.9021
Epoch 6/100: 100%|██████████| 6258/6258 [24:07<00:00,  4.32it/s, loss=5.1038, ppl=164.65]

<> Validating...

<> Epoch 6 Results:
<>  Time: 0:24:08
Train Loss: 4.9552 | Train PPL: 141.92
Valid Loss: 4.8345 | Valid PPL: 125.77
<> Saved new best model with validation loss: 4.8345
Epoch 7/100: 100%|██████████| 6258/6258 [24:22<00:00,  4.28it/s, loss=5.0547, ppl=156.76]

<> Validating...

<> Epoch 7 Results:
<>  Time: 0:24:24
Train Loss: 4.8823 | Train PPL: 131.93
Valid Loss: 4.7778 | Valid PPL: 118.84
<> Saved new best model with validation loss: 4.7778
Epoch 8/100: 100%|██████████| 6258/6258 [24:19<00:00,  4.29it/s, loss=5.0129, ppl=150.33]

<> Validating...

<> Epoch 8 Results:
<>  Time: 0:24:21
Train Loss: 4.8210 | Train PPL: 124.09
Valid Loss: 4.7326 | Valid PPL: 113.59
<> Saved new best model with validation loss: 4.7326
Epoch 9/100: 100%|██████████| 6258/6258 [24:17<00:00,  4.29it/s, loss=4.9659, ppl=143.43]

<> Validating...

<> Epoch 9 Results:
<>  Time: 0:24:19
Train Loss: 4.7696 | Train PPL: 117.87
Valid Loss: 4.6938 | Valid PPL: 109.26
<> Saved new best model with validation loss: 4.6938
Epoch 10/100: 100%|██████████| 6258/6258 [24:13<00:00,  4.31it/s, loss=4.9386, ppl=139.58]

<> Validating...

<> Epoch 10 Results:
<>  Time: 0:24:14
Train Loss: 4.7244 | Train PPL: 112.66
Valid Loss: 4.6615 | Valid PPL: 105.80
<> Saved new best model with validation loss: 4.6615
Epoch 11/100: 100%|██████████| 6258/6258 [24:15<00:00,  4.30it/s, loss=4.9107, ppl=135.73]

<> Validating...

<> Epoch 11 Results:
<>  Time: 0:24:16
Train Loss: 4.6851 | Train PPL: 108.32
Valid Loss: 4.6330 | Valid PPL: 102.82
<> Saved new best model with validation loss: 4.6330
Epoch 12/100: 100%|██████████| 6258/6258 [24:08<00:00,  4.32it/s, loss=4.8788, ppl=131.47]

<> Validating...

<> Epoch 12 Results:
<>  Time: 0:24:09
Train Loss: 4.6507 | Train PPL: 104.65
Valid Loss: 4.6089 | Valid PPL: 100.37
<> Saved new best model with validation loss: 4.6089
Epoch 13/100: 100%|██████████| 6258/6258 [24:09<00:00,  4.32it/s, loss=4.8532, ppl=128.15]

<> Validating...

<> Epoch 13 Results:
<>  Time: 0:24:10
Train Loss: 4.6197 | Train PPL: 101.46
Valid Loss: 4.5848 | Valid PPL: 97.99
<> Saved new best model with validation loss: 4.5848
Epoch 14/100: 100%|██████████| 6258/6258 [24:16<00:00,  4.30it/s, loss=4.8345, ppl=125.78]

<> Validating...

<> Epoch 14 Results:
<>  Time: 0:24:18
Train Loss: 4.5919 | Train PPL: 98.69
Valid Loss: 4.5656 | Valid PPL: 96.12
<> Saved new best model with validation loss: 4.5656
Epoch 15/100: 100%|██████████| 6258/6258 [24:13<00:00,  4.30it/s, loss=4.8219, ppl=124.20]

<> Validating...

<> Epoch 15 Results:
<>  Time: 0:24:15
Train Loss: 4.5671 | Train PPL: 96.26
Valid Loss: 4.5501 | Valid PPL: 94.64
<> Saved new best model with validation loss: 4.5501
Epoch 16/100: 100%|██████████| 6258/6258 [24:28<00:00,  4.26it/s, loss=4.8089, ppl=122.60]

<> Validating...

<> Epoch 16 Results:
<>  Time: 0:24:30
Train Loss: 4.5441 | Train PPL: 94.08
Valid Loss: 4.5342 | Valid PPL: 93.15
<> Saved new best model with validation loss: 4.5342
Epoch 17/100: 100%|██████████| 6258/6258 [24:19<00:00,  4.29it/s, loss=4.7965, ppl=121.09]

<> Validating...

<> Epoch 17 Results:
<>  Time: 0:24:21
Train Loss: 4.5228 | Train PPL: 92.09
Valid Loss: 4.5167 | Valid PPL: 91.53
<> Saved new best model with validation loss: 4.5167
Epoch 18/100: 100%|██████████| 6258/6258 [24:19<00:00,  4.29it/s, loss=4.7875, ppl=120.00]

<> Validating...

<> Epoch 18 Results:
<>  Time: 0:24:21
Train Loss: 4.5038 | Train PPL: 90.36
Valid Loss: 4.5059 | Valid PPL: 90.55
<> Saved new best model with validation loss: 4.5059
Epoch 19/100: 100%|██████████| 6258/6258 [24:18<00:00,  4.29it/s, loss=4.7702, ppl=117.94]

<> Validating...

<> Epoch 19 Results:
<>  Time: 0:24:19
Train Loss: 4.4858 | Train PPL: 88.75
Valid Loss: 4.4945 | Valid PPL: 89.52
<> Saved new best model with validation loss: 4.4945
Epoch 20/100: 100%|██████████| 6258/6258 [24:23<00:00,  4.28it/s, loss=4.7640, ppl=117.22]

<> Validating...

<> Epoch 20 Results:
<>  Time: 0:24:25
Train Loss: 4.4694 | Train PPL: 87.30
Valid Loss: 4.4811 | Valid PPL: 88.33
<> Saved new best model with validation loss: 4.4811
Epoch 21/100: 100%|██████████| 6258/6258 [24:19<00:00,  4.29it/s, loss=4.7588, ppl=116.60]

<> Validating...

<> Epoch 21 Results:
<>  Time: 0:24:21
Train Loss: 4.4541 | Train PPL: 85.98
Valid Loss: 4.4732 | Valid PPL: 87.64
<> Saved new best model with validation loss: 4.4732
Epoch 22/100: 100%|██████████| 6258/6258 [24:18<00:00,  4.29it/s, loss=4.7465, ppl=115.18]

<> Validating...

<> Epoch 22 Results:
<>  Time: 0:24:19
Train Loss: 4.4402 | Train PPL: 84.79
Valid Loss: 4.4650 | Valid PPL: 86.92
<> Saved new best model with validation loss: 4.4650
Epoch 23/100: 100%|██████████| 6258/6258 [24:17<00:00,  4.29it/s, loss=4.7444, ppl=114.94]

<> Validating...

<> Epoch 23 Results:
<>  Time: 0:24:18
Train Loss: 4.4267 | Train PPL: 83.66
Valid Loss: 4.4564 | Valid PPL: 86.17
<> Saved new best model with validation loss: 4.4564
Epoch 24/100: 100%|██████████| 6258/6258 [24:13<00:00,  4.31it/s, loss=4.7374, ppl=114.14]

<> Validating...

<> Epoch 24 Results:
<>  Time: 0:24:14
Train Loss: 4.4136 | Train PPL: 82.57
Valid Loss: 4.4500 | Valid PPL: 85.63
<> Saved new best model with validation loss: 4.4500
Epoch 25/100: 100%|██████████| 6258/6258 [24:11<00:00,  4.31it/s, loss=4.7282, ppl=113.09]

<> Validating...

<> Epoch 25 Results:
<>  Time: 0:24:13
Train Loss: 4.4015 | Train PPL: 81.57
Valid Loss: 4.4403 | Valid PPL: 84.80
<> Saved new best model with validation loss: 4.4403
Epoch 26/100: 100%|██████████| 6258/6258 [24:09<00:00,  4.32it/s, loss=4.7254, ppl=112.77]

<> Validating...

<> Epoch 26 Results:
<>  Time: 0:24:10
Train Loss: 4.3900 | Train PPL: 80.64
Valid Loss: 4.4357 | Valid PPL: 84.41
<> Saved new best model with validation loss: 4.4357
Epoch 27/100: 100%|██████████| 6258/6258 [24:10<00:00,  4.31it/s, loss=4.7249, ppl=112.72]

<> Validating...

<> Epoch 27 Results:
<>  Time: 0:24:12
Train Loss: 4.3794 | Train PPL: 79.79
Valid Loss: 4.4289 | Valid PPL: 83.84
<> Saved new best model with validation loss: 4.4289
Epoch 28/100: 100%|██████████| 6258/6258 [24:10<00:00,  4.31it/s, loss=4.7120, ppl=111.27]

<> Validating...

<> Epoch 28 Results:
<>  Time: 0:24:11
Train Loss: 4.3697 | Train PPL: 79.02
Valid Loss: 4.4241 | Valid PPL: 83.44
<> Saved new best model with validation loss: 4.4241
Epoch 29/100: 100%|██████████| 6258/6258 [24:23<00:00,  4.27it/s, loss=4.7132, ppl=111.41]

<> Validating...

<> Epoch 29 Results:
<>  Time: 0:24:25
Train Loss: 4.3600 | Train PPL: 78.26
Valid Loss: 4.4186 | Valid PPL: 82.98
<> Saved new best model with validation loss: 4.4186
Epoch 30/100: 100%|██████████| 6258/6258 [24:24<00:00,  4.27it/s, loss=4.7056, ppl=110.56]

<> Validating...

<> Epoch 30 Results:
<>  Time: 0:24:25
Train Loss: 4.3510 | Train PPL: 77.55
Valid Loss: 4.4097 | Valid PPL: 82.25
<> Saved new best model with validation loss: 4.4097
Epoch 31/100: 100%|██████████| 6258/6258 [24:23<00:00,  4.28it/s, loss=4.6989, ppl=109.82]

<> Validating...

<> Epoch 31 Results:
<>  Time: 0:24:25
Train Loss: 4.3419 | Train PPL: 76.86
Valid Loss: 4.4053 | Valid PPL: 81.89
<> Saved new best model with validation loss: 4.4053
Epoch 32/100: 100%|██████████| 6258/6258 [28:32<00:00,  3.65it/s, loss=4.7015, ppl=110.11]

<> Validating...

<> Epoch 32 Results:
<>  Time: 0:28:34
Train Loss: 4.3335 | Train PPL: 76.21
Valid Loss: 4.3994 | Valid PPL: 81.40
<> Saved new best model with validation loss: 4.3994
Epoch 33/100: 100%|██████████| 6258/6258 [26:07<00:00,  3.99it/s, loss=4.6910, ppl=108.96]

<> Validating...

<> Epoch 33 Results:
<>  Time: 0:26:09
Train Loss: 4.3253 | Train PPL: 75.59
Valid Loss: 4.3968 | Valid PPL: 81.19
<> Saved new best model with validation loss: 4.3968
Epoch 34/100: 100%|██████████| 6258/6258 [25:21<00:00,  4.11it/s, loss=4.6869, ppl=108.52]

<> Validating...

<> Epoch 34 Results:
<>  Time: 0:25:22
Train Loss: 4.3174 | Train PPL: 75.00
Valid Loss: 4.3951 | Valid PPL: 81.05
<> Saved new best model with validation loss: 4.3951
Epoch 35/100: 100%|██████████| 6258/6258 [24:11<00:00,  4.31it/s, loss=4.6813, ppl=107.91]

<> Validating...

<> Epoch 35 Results:
<>  Time: 0:24:12
Train Loss: 4.3100 | Train PPL: 74.44
Valid Loss: 4.3902 | Valid PPL: 80.65
<> Saved new best model with validation loss: 4.3902
Epoch 36/100: 100%|██████████| 6258/6258 [24:10<00:00,  4.31it/s, loss=4.6759, ppl=107.33]

<> Validating...

<> Epoch 36 Results:
<>  Time: 0:24:11
Train Loss: 4.3030 | Train PPL: 73.92
Valid Loss: 4.3876 | Valid PPL: 80.45
<> Saved new best model with validation loss: 4.3876
Epoch 37/100: 100%|██████████| 6258/6258 [24:10<00:00,  4.31it/s, loss=4.6872, ppl=108.55]

<> Validating...

<> Epoch 37 Results:
<>  Time: 0:24:12
Train Loss: 4.2962 | Train PPL: 73.42
Valid Loss: 4.3841 | Valid PPL: 80.16
<> Saved new best model with validation loss: 4.3841
Epoch 38/100: 100%|██████████| 6258/6258 [24:14<00:00,  4.30it/s, loss=4.6731, ppl=107.03]

<> Validating...

<> Epoch 38 Results:
<>  Time: 0:24:15
Train Loss: 4.2895 | Train PPL: 72.93
Valid Loss: 4.3805 | Valid PPL: 79.88
<> Saved new best model with validation loss: 4.3805
Epoch 39/100: 100%|██████████| 6258/6258 [24:23<00:00,  4.28it/s, loss=4.6717, ppl=106.88]

<> Validating...

<> Epoch 39 Results:
<>  Time: 0:24:25
Train Loss: 4.2833 | Train PPL: 72.48
Valid Loss: 4.3772 | Valid PPL: 79.61
<> Saved new best model with validation loss: 4.3772
Epoch 40/100: 100%|██████████| 6258/6258 [24:25<00:00,  4.27it/s, loss=4.6697, ppl=106.66]

<> Validating...

<> Epoch 40 Results:
<>  Time: 0:24:27
Train Loss: 4.2773 | Train PPL: 72.04
Valid Loss: 4.3730 | Valid PPL: 79.28
<> Saved new best model with validation loss: 4.3730
Epoch 41/100: 100%|██████████| 6258/6258 [24:14<00:00,  4.30it/s, loss=4.6676, ppl=106.44]

<> Validating...

<> Epoch 41 Results:
<>  Time: 0:24:16
Train Loss: 4.2712 | Train PPL: 71.61
Valid Loss: 4.3705 | Valid PPL: 79.08
<> Saved new best model with validation loss: 4.3705
Epoch 42/100: 100%|██████████| 6258/6258 [24:18<00:00,  4.29it/s, loss=4.6627, ppl=105.92]

<> Validating...

<> Epoch 42 Results:
<>  Time: 0:24:20
Train Loss: 4.2653 | Train PPL: 71.18
Valid Loss: 4.3673 | Valid PPL: 78.83
<> Saved new best model with validation loss: 4.3673
Epoch 43/100: 100%|██████████| 6258/6258 [24:21<00:00,  4.28it/s, loss=4.6703, ppl=106.73]

<> Validating...

<> Epoch 43 Results:
<>  Time: 0:24:23
Train Loss: 4.2595 | Train PPL: 70.77
Valid Loss: 4.3677 | Valid PPL: 78.86
<> No improvement for 1 epoch(s).
Epoch 44/100: 100%|██████████| 6258/6258 [24:25<00:00,  4.27it/s, loss=4.6729, ppl=107.01]

<> Validating...

<> Epoch 44 Results:
<>  Time: 0:24:27
Train Loss: 4.2539 | Train PPL: 70.38
Valid Loss: 4.3629 | Valid PPL: 78.48
<> Saved new best model with validation loss: 4.3629
Epoch 45/100: 100%|██████████| 6258/6258 [24:09<00:00,  4.32it/s, loss=4.6649, ppl=106.15]

<> Validating...

<> Epoch 45 Results:
<>  Time: 0:24:10
Train Loss: 4.2487 | Train PPL: 70.01
Valid Loss: 4.3610 | Valid PPL: 78.33
<> Saved new best model with validation loss: 4.3610
Epoch 46/100: 100%|██████████| 6258/6258 [24:15<00:00,  4.30it/s, loss=4.6655, ppl=106.22]

<> Validating...

<> Epoch 46 Results:
<>  Time: 0:24:17
Train Loss: 4.2436 | Train PPL: 69.66
Valid Loss: 4.3594 | Valid PPL: 78.21
<> Saved new best model with validation loss: 4.3594
Epoch 47/100: 100%|██████████| 6258/6258 [24:16<00:00,  4.30it/s, loss=4.6596, ppl=105.59]

<> Validating...

<> Epoch 47 Results:
<>  Time: 0:24:17
Train Loss: 4.2387 | Train PPL: 69.31
Valid Loss: 4.3573 | Valid PPL: 78.04
<> Saved new best model with validation loss: 4.3573
Epoch 48/100: 100%|██████████| 6258/6258 [24:24<00:00,  4.27it/s, loss=4.6576, ppl=105.38]

<> Validating...

<> Epoch 48 Results:
<>  Time: 0:24:25
Train Loss: 4.2341 | Train PPL: 69.00
Valid Loss: 4.3536 | Valid PPL: 77.76
<> Saved new best model with validation loss: 4.3536
Epoch 49/100: 100%|██████████| 6258/6258 [24:14<00:00,  4.30it/s, loss=4.6591, ppl=105.55]

<> Validating...

<> Epoch 49 Results:
<>  Time: 0:24:16
Train Loss: 4.2292 | Train PPL: 68.66
Valid Loss: 4.3516 | Valid PPL: 77.60
<> Saved new best model with validation loss: 4.3516
Epoch 50/100: 100%|██████████| 6258/6258 [24:22<00:00,  4.28it/s, loss=4.6514, ppl=104.73] 

<> Validating...

<> Epoch 50 Results:
<>  Time: 0:24:23
Train Loss: 4.2248 | Train PPL: 68.36
Valid Loss: 4.3494 | Valid PPL: 77.43
<> Saved new best model with validation loss: 4.3494
Epoch 51/100: 100%|██████████| 6258/6258 [24:16<00:00,  4.30it/s, loss=4.6605, ppl=105.69] 

<> Validating...

<> Epoch 51 Results:
<>  Time: 0:24:17
Train Loss: 4.2202 | Train PPL: 68.05
Valid Loss: 4.3491 | Valid PPL: 77.41
<> Saved new best model with validation loss: 4.3491
Epoch 52/100: 100%|██████████| 6258/6258 [24:18<00:00,  4.29it/s, loss=4.6575, ppl=105.37]

<> Validating...

<> Epoch 52 Results:
<>  Time: 0:24:19
Train Loss: 4.2161 | Train PPL: 67.77
Valid Loss: 4.3446 | Valid PPL: 77.06
<> Saved new best model with validation loss: 4.3446
Epoch 53/100: 100%|██████████| 6258/6258 [24:26<00:00,  4.27it/s, loss=4.6535, ppl=104.95]

<> Validating...

<> Epoch 53 Results:
<>  Time: 0:24:28
Train Loss: 4.2120 | Train PPL: 67.49
Valid Loss: 4.3442 | Valid PPL: 77.03
<> Saved new best model with validation loss: 4.3442
Epoch 54/100: 100%|██████████| 6258/6258 [24:26<00:00,  4.27it/s, loss=4.6651, ppl=106.18] 

<> Validating...

<> Epoch 54 Results:
<>  Time: 0:24:28
Train Loss: 4.2079 | Train PPL: 67.21
Valid Loss: 4.3432 | Valid PPL: 76.96
<> Saved new best model with validation loss: 4.3432
Epoch 55/100: 100%|██████████| 6258/6258 [24:24<00:00,  4.27it/s, loss=4.6569, ppl=105.31]

<> Validating...

<> Epoch 55 Results:
<>  Time: 0:24:25
Train Loss: 4.2039 | Train PPL: 66.95
Valid Loss: 4.3403 | Valid PPL: 76.73
<> Saved new best model with validation loss: 4.3403
Epoch 56/100: 100%|██████████| 6258/6258 [24:24<00:00,  4.27it/s, loss=4.6489, ppl=104.47] 

<> Validating...

<> Epoch 56 Results:
<>  Time: 0:24:26
Train Loss: 4.2000 | Train PPL: 66.69
Valid Loss: 4.3396 | Valid PPL: 76.68
<> Saved new best model with validation loss: 4.3396
Epoch 57/100: 100%|██████████| 6258/6258 [24:23<00:00,  4.27it/s, loss=4.6533, ppl=104.93]

<> Validating...

<> Epoch 57 Results:
<>  Time: 0:24:25
Train Loss: 4.1962 | Train PPL: 66.43
Valid Loss: 4.3373 | Valid PPL: 76.50
<> Saved new best model with validation loss: 4.3373
Epoch 58/100: 100%|██████████| 6258/6258 [24:28<00:00,  4.26it/s, loss=4.6511, ppl=104.70] 

<> Validating...

<> Epoch 58 Results:
<>  Time: 0:24:30
Train Loss: 4.1924 | Train PPL: 66.18
Valid Loss: 4.3351 | Valid PPL: 76.33
<> Saved new best model with validation loss: 4.3351
Epoch 59/100: 100%|██████████| 6258/6258 [24:14<00:00,  4.30it/s, loss=4.6458, ppl=104.15]

<> Validating...

<> Epoch 59 Results:
<>  Time: 0:24:16
Train Loss: 4.1889 | Train PPL: 65.95
Valid Loss: 4.3335 | Valid PPL: 76.21
<> Saved new best model with validation loss: 4.3335
Epoch 60/100: 100%|██████████| 6258/6258 [24:05<00:00,  4.33it/s, loss=4.6407, ppl=103.62]

<> Validating...

<> Epoch 60 Results:
<>  Time: 0:24:07
Train Loss: 4.1854 | Train PPL: 65.72
Valid Loss: 4.3309 | Valid PPL: 76.01
<> Saved new best model with validation loss: 4.3309
Epoch 61/100: 100%|██████████| 6258/6258 [24:09<00:00,  4.32it/s, loss=4.6467, ppl=104.24]

<> Validating...

<> Epoch 61 Results:
<>  Time: 0:24:11
Train Loss: 4.1820 | Train PPL: 65.49
Valid Loss: 4.3301 | Valid PPL: 75.95
<> Saved new best model with validation loss: 4.3301
Epoch 62/100: 100%|██████████| 6258/6258 [24:14<00:00,  4.30it/s, loss=4.6412, ppl=103.67]

<> Validating...

<> Epoch 62 Results:
<>  Time: 0:24:15
Train Loss: 4.1787 | Train PPL: 65.28
Valid Loss: 4.3288 | Valid PPL: 75.85
<> Saved new best model with validation loss: 4.3288
Epoch 63/100: 100%|██████████| 6258/6258 [24:24<00:00,  4.27it/s, loss=4.6395, ppl=103.49]

<> Validating...

<> Epoch 63 Results:
<>  Time: 0:24:26
Train Loss: 4.1756 | Train PPL: 65.08
Valid Loss: 4.3274 | Valid PPL: 75.75
<> Saved new best model with validation loss: 4.3274
Epoch 64/100: 100%|██████████| 6258/6258 [24:09<00:00,  4.32it/s, loss=4.6435, ppl=103.90]

<> Validating...

<> Epoch 64 Results:
<>  Time: 0:24:10
Train Loss: 4.1726 | Train PPL: 64.89
Valid Loss: 4.3274 | Valid PPL: 75.75
<> No improvement for 1 epoch(s).
Epoch 65/100: 100%|██████████| 6258/6258 [24:08<00:00,  4.32it/s, loss=4.6440, ppl=103.96]

<> Validating...

<> Epoch 65 Results:
<>  Time: 0:24:10
Train Loss: 4.1696 | Train PPL: 64.69
Valid Loss: 4.3262 | Valid PPL: 75.66
<> Saved new best model with validation loss: 4.3262
Epoch 66/100: 100%|██████████| 6258/6258 [24:12<00:00,  4.31it/s, loss=4.6370, ppl=103.23]

<> Validating...

<> Epoch 66 Results:
<>  Time: 0:24:14
Train Loss: 4.1667 | Train PPL: 64.50
Valid Loss: 4.3266 | Valid PPL: 75.68
<> No improvement for 1 epoch(s).
Epoch 67/100: 100%|██████████| 6258/6258 [24:13<00:00,  4.31it/s, loss=4.6306, ppl=102.57]

<> Validating...

<> Epoch 67 Results:
<>  Time: 0:24:14
Train Loss: 4.1639 | Train PPL: 64.32
Valid Loss: 4.3239 | Valid PPL: 75.48
<> Saved new best model with validation loss: 4.3239
Epoch 68/100: 100%|██████████| 6258/6258 [24:15<00:00,  4.30it/s, loss=4.6338, ppl=102.90]

<> Validating...

<> Epoch 68 Results:
<>  Time: 0:24:17
Train Loss: 4.1613 | Train PPL: 64.15
Valid Loss: 4.3243 | Valid PPL: 75.51
<> No improvement for 1 epoch(s).
Epoch 69/100: 100%|██████████| 6258/6258 [24:10<00:00,  4.31it/s, loss=4.6340, ppl=102.93]

<> Validating...

<> Epoch 69 Results:
<>  Time: 0:24:12
Train Loss: 4.1586 | Train PPL: 63.98
Valid Loss: 4.3217 | Valid PPL: 75.32
<> Saved new best model with validation loss: 4.3217
Epoch 70/100: 100%|██████████| 6258/6258 [24:06<00:00,  4.32it/s, loss=4.6312, ppl=102.64]

<> Validating...

<> Epoch 70 Results:
<>  Time: 0:24:08
Train Loss: 4.1560 | Train PPL: 63.81
Valid Loss: 4.3206 | Valid PPL: 75.24
<> Saved new best model with validation loss: 4.3206
Epoch 71/100: 100%|██████████| 6258/6258 [24:10<00:00,  4.31it/s, loss=4.6372, ppl=103.25]

<> Validating...

<> Epoch 71 Results:
<>  Time: 0:24:12
Train Loss: 4.1536 | Train PPL: 63.66
Valid Loss: 4.3201 | Valid PPL: 75.20
<> Saved new best model with validation loss: 4.3201
Epoch 72/100: 100%|██████████| 6258/6258 [24:11<00:00,  4.31it/s, loss=4.6279, ppl=102.30]

<> Validating...

<> Epoch 72 Results:
<>  Time: 0:24:13
Train Loss: 4.1512 | Train PPL: 63.51
Valid Loss: 4.3187 | Valid PPL: 75.09
<> Saved new best model with validation loss: 4.3187
Epoch 73/100: 100%|██████████| 6258/6258 [24:15<00:00,  4.30it/s, loss=4.6322, ppl=102.74]

<> Validating...

<> Epoch 73 Results:
<>  Time: 0:24:17
Train Loss: 4.1490 | Train PPL: 63.37
Valid Loss: 4.3172 | Valid PPL: 74.98
<> Saved new best model with validation loss: 4.3172
Epoch 74/100: 100%|██████████| 6258/6258 [24:06<00:00,  4.33it/s, loss=4.6224, ppl=101.74]

<> Validating...

<> Epoch 74 Results:
<>  Time: 0:24:08
Train Loss: 4.1468 | Train PPL: 63.23
Valid Loss: 4.3165 | Valid PPL: 74.93
<> Saved new best model with validation loss: 4.3165
Epoch 75/100: 100%|██████████| 6258/6258 [32:50<00:00,  3.18it/s, loss=4.6422, ppl=103.77]

<> Validating...

<> Epoch 75 Results:
<>  Time: 0:32:52
Train Loss: 4.1447 | Train PPL: 63.10
Valid Loss: 4.3152 | Valid PPL: 74.83
<> Saved new best model with validation loss: 4.3152
Epoch 76/100: 100%|██████████| 6258/6258 [27:40<00:00,  3.77it/s, loss=4.6402, ppl=103.56]

<> Validating...

<> Epoch 76 Results:
<>  Time: 0:27:42
Train Loss: 4.1428 | Train PPL: 62.98
Valid Loss: 4.3137 | Valid PPL: 74.72
<> Saved new best model with validation loss: 4.3137
Epoch 77/100: 100%|██████████| 6258/6258 [24:09<00:00,  4.32it/s, loss=4.6264, ppl=102.15]

<> Validating...

<> Epoch 77 Results:
<>  Time: 0:24:11
Train Loss: 4.1409 | Train PPL: 62.86
Valid Loss: 4.3135 | Valid PPL: 74.70
<> Saved new best model with validation loss: 4.3135
Epoch 78/100: 100%|██████████| 6258/6258 [24:12<00:00,  4.31it/s, loss=4.6301, ppl=102.52]

<> Validating...

<> Epoch 78 Results:
<>  Time: 0:24:13
Train Loss: 4.1391 | Train PPL: 62.75
Valid Loss: 4.3124 | Valid PPL: 74.62
<> Saved new best model with validation loss: 4.3124
Epoch 79/100: 100%|██████████| 6258/6258 [24:07<00:00,  4.32it/s, loss=4.6390, ppl=103.44]

<> Validating...

<> Epoch 79 Results:
<>  Time: 0:24:09
Train Loss: 4.1374 | Train PPL: 62.64
Valid Loss: 4.3121 | Valid PPL: 74.59
<> Saved new best model with validation loss: 4.3121
Epoch 80/100: 100%|██████████| 6258/6258 [24:16<00:00,  4.30it/s, loss=4.6353, ppl=103.06]

<> Validating...

<> Epoch 80 Results:
<>  Time: 0:24:18
Train Loss: 4.1357 | Train PPL: 62.54
Valid Loss: 4.3119 | Valid PPL: 74.58
<> Saved new best model with validation loss: 4.3119
Epoch 81/100: 100%|██████████| 6258/6258 [24:09<00:00,  4.32it/s, loss=4.6301, ppl=102.52]

<> Validating...

<> Epoch 81 Results:
<>  Time: 0:24:11
Train Loss: 4.1342 | Train PPL: 62.44
Valid Loss: 4.3115 | Valid PPL: 74.55
<> Saved new best model with validation loss: 4.3115
Epoch 82/100: 100%|██████████| 6258/6258 [24:11<00:00,  4.31it/s, loss=4.6338, ppl=102.91]

<> Validating...

<> Epoch 82 Results:
<>  Time: 0:24:12
Train Loss: 4.1328 | Train PPL: 62.35
Valid Loss: 4.3114 | Valid PPL: 74.55
<> Saved new best model with validation loss: 4.3114
Epoch 83/100: 100%|██████████| 6258/6258 [24:11<00:00,  4.31it/s, loss=4.6275, ppl=102.26]

<> Validating...

<> Epoch 83 Results:
<>  Time: 0:24:13
Train Loss: 4.1314 | Train PPL: 62.26
Valid Loss: 4.3105 | Valid PPL: 74.47
<> Saved new best model with validation loss: 4.3105
Epoch 84/100: 100%|██████████| 6258/6258 [24:07<00:00,  4.32it/s, loss=4.6291, ppl=102.42]

<> Validating...

<> Epoch 84 Results:
<>  Time: 0:24:08
Train Loss: 4.1301 | Train PPL: 62.18
Valid Loss: 4.3109 | Valid PPL: 74.51
<> No improvement for 1 epoch(s).
Epoch 85/100: 100%|██████████| 6258/6258 [24:07<00:00,  4.32it/s, loss=4.6382, ppl=103.36]

<> Validating...

<> Epoch 85 Results:
<>  Time: 0:24:09
Train Loss: 4.1288 | Train PPL: 62.10
Valid Loss: 4.3105 | Valid PPL: 74.48
<> No improvement for 2 epoch(s).
Epoch 86/100: 100%|██████████| 6258/6258 [24:11<00:00,  4.31it/s, loss=4.6283, ppl=102.34]

<> Validating...

<> Epoch 86 Results:
<>  Time: 0:24:12
Train Loss: 4.1278 | Train PPL: 62.04
Valid Loss: 4.3101 | Valid PPL: 74.45
<> Saved new best model with validation loss: 4.3101
Epoch 87/100: 100%|██████████| 6258/6258 [24:15<00:00,  4.30it/s, loss=4.6313, ppl=102.65]

<> Validating...

<> Epoch 87 Results:
<>  Time: 0:24:17
Train Loss: 4.1269 | Train PPL: 61.98
Valid Loss: 4.3098 | Valid PPL: 74.42
<> Saved new best model with validation loss: 4.3098
Epoch 88/100: 100%|██████████| 6258/6258 [24:12<00:00,  4.31it/s, loss=4.6324, ppl=102.76]

<> Validating...

<> Epoch 88 Results:
<>  Time: 0:24:13
Train Loss: 4.1257 | Train PPL: 61.91
Valid Loss: 4.3091 | Valid PPL: 74.37
<> Saved new best model with validation loss: 4.3091
Epoch 89/100: 100%|██████████| 6258/6258 [24:10<00:00,  4.31it/s, loss=4.6218, ppl=101.68]

<> Validating...

<> Epoch 89 Results:
<>  Time: 0:24:12
Train Loss: 4.1249 | Train PPL: 61.86
Valid Loss: 4.3091 | Valid PPL: 74.37
<> Saved new best model with validation loss: 4.3091
Epoch 90/100: 100%|██████████| 6258/6258 [24:11<00:00,  4.31it/s, loss=4.6282, ppl=102.33]

<> Validating...

<> Epoch 90 Results:
<>  Time: 0:24:13
Train Loss: 4.1242 | Train PPL: 61.82
Valid Loss: 4.3089 | Valid PPL: 74.36
<> Saved new best model with validation loss: 4.3089
Epoch 91/100: 100%|██████████| 6258/6258 [24:12<00:00,  4.31it/s, loss=4.6276, ppl=102.27]

<> Validating...

<> Epoch 91 Results:
<>  Time: 0:24:14
Train Loss: 4.1234 | Train PPL: 61.77
Valid Loss: 4.3089 | Valid PPL: 74.36
<> Saved new best model with validation loss: 4.3089
Epoch 92/100: 100%|██████████| 6258/6258 [24:14<00:00,  4.30it/s, loss=4.6149, ppl=100.97]

<> Validating...

<> Epoch 92 Results:
<>  Time: 0:24:16
Train Loss: 4.1227 | Train PPL: 61.73
Valid Loss: 4.3087 | Valid PPL: 74.34
<> Saved new best model with validation loss: 4.3087
Epoch 93/100: 100%|██████████| 6258/6258 [24:11<00:00,  4.31it/s, loss=4.6310, ppl=102.62]

<> Validating...

<> Epoch 93 Results:
<>  Time: 0:24:13
Train Loss: 4.1222 | Train PPL: 61.70
Valid Loss: 4.3084 | Valid PPL: 74.32
<> Saved new best model with validation loss: 4.3084
Epoch 94/100: 100%|██████████| 6258/6258 [24:13<00:00,  4.31it/s, loss=4.6283, ppl=102.33]

<> Validating...

<> Epoch 94 Results:
<>  Time: 0:24:14
Train Loss: 4.1218 | Train PPL: 61.67
Valid Loss: 4.3084 | Valid PPL: 74.32
<> Saved new best model with validation loss: 4.3084
Epoch 95/100: 100%|██████████| 6258/6258 [24:19<00:00,  4.29it/s, loss=4.6194, ppl=101.43]

<> Validating...

<> Epoch 95 Results:
<>  Time: 0:24:20
Train Loss: 4.1213 | Train PPL: 61.64
Valid Loss: 4.3082 | Valid PPL: 74.31
<> Saved new best model with validation loss: 4.3082
Epoch 96/100: 100%|██████████| 6258/6258 [24:09<00:00,  4.32it/s, loss=4.6327, ppl=102.80]

<> Validating...

<> Epoch 96 Results:
<>  Time: 0:24:11
Train Loss: 4.1210 | Train PPL: 61.62
Valid Loss: 4.3083 | Valid PPL: 74.31
<> No improvement for 1 epoch(s).
Epoch 97/100: 100%|██████████| 6258/6258 [24:37<00:00,  4.24it/s, loss=4.6269, ppl=102.20]

<> Validating...

<> Epoch 97 Results:
<>  Time: 0:24:38
Train Loss: 4.1207 | Train PPL: 61.60
Valid Loss: 4.3081 | Valid PPL: 74.30
<> Saved new best model with validation loss: 4.3081
Epoch 98/100: 100%|██████████| 6258/6258 [24:13<00:00,  4.30it/s, loss=4.6272, ppl=102.22]

<> Validating...

<> Epoch 98 Results:
<>  Time: 0:24:15
Train Loss: 4.1205 | Train PPL: 61.59
Valid Loss: 4.3080 | Valid PPL: 74.29
<> Saved new best model with validation loss: 4.3080
Epoch 99/100: 100%|██████████| 6258/6258 [25:44<00:00,  4.05it/s, loss=4.6252, ppl=102.03]

<> Validating...

<> Epoch 99 Results:
<>  Time: 0:25:46
Train Loss: 4.1203 | Train PPL: 61.58
Valid Loss: 4.3080 | Valid PPL: 74.29
<> Saved new best model with validation loss: 4.3080
Epoch 100/100: 100%|██████████| 6258/6258 [24:33<00:00,  4.25it/s, loss=4.6295, ppl=102.46]

<> Validating...

<> Epoch 100 Results:
<>  Time: 0:24:35
Train Loss: 4.1202 | Train PPL: 61.57
Valid Loss: 4.3080 | Valid PPL: 74.29
<> Saved new best model with validation loss: 4.3080

==================================================
<> Training Complete!
==================================================
Best validation loss: 4.3080
Total time: 1 day, 16:49:29

<> Training Finished. Loading Best Model for Evaluation...
<> Loaded checkpoint from epoch 99 (Loss: 4.3080)

Running Standard Evaluation...

==================================================
<> Starting STANDARD CHUNKED Evaluation...
==================================================
Evaluating: 100%|██████████| 14/14 [00:08<00:00,  1.67it/s]

==================================================
RESULTS: Standard Chunked
==================================================
Total Tokens: 229376
Average Loss: 3.2943
PERPLEXITY  : 26.96
==================================================