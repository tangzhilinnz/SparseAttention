Using device: cuda

<> Loading WikiText-2 Dataset...
Warning: You are sending unauthenticated requests to the HF Hub. Please set a HF_TOKEN to enable higher rate limits and faster downloads.

<> Building Vocabulary...
Counting words...

 Vocabulary Statistics:
Total unique words found: 28911
Vocabulary size: 28915
Sample words: ['<PAD>', '<UNK>', '<SOS>', '<EOS>', 'the', ',', '.', 'of', '<unk>', 'and']

<> Creating Datasets...

<> Dataset Statistics:
Train samples: 4046
Validation samples: 421
Test samples: 475

<> Sample Batch Information:
Input shape: torch.Size([16, 512])
Label shape: torch.Size([16, 512])

<> Initializing Transformer Model...
Actual Vocab Size: 28915
Using device: cuda

<> Starting Training...

==================================================
<> Training Transformer Model (AMP Enabled)
==================================================
/home/ztang13/workspace/SparseAttention/myenv/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/home/ztang13/workspace/SparseAttention/Hierarchical_transformer_V3_WikiText2.py:689: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler()
Epoch 1/100:   0%|                                                                                                                           | 0/252 [00:00<?, ?it/s]/home/ztang13/workspace/SparseAttention/Hierarchical_transformer_V3_WikiText2.py:721: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Epoch 1/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [01:12<00:00,  3.47it/s, loss=7.4131, ppl=1657.54]
<> Validating...
/home/ztang13/workspace/SparseAttention/Hierarchical_transformer_V3_WikiText2.py:772: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():

<> Epoch 1 Results:
<>  Time: 0:01:14
Train Loss: 8.2067 | Train PPL: 3665.55
Valid Loss: 7.1346 | Valid PPL: 1254.61
<> Saved new best model with validation loss: 7.1346
Epoch 2/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:57<00:00,  4.42it/s, loss=7.2121, ppl=1355.73]
<> Validating...

<> Epoch 2 Results:
<>  Time: 0:00:58
Train Loss: 7.3020 | Train PPL: 1483.22
Valid Loss: 6.9424 | Valid PPL: 1035.21
<> Saved new best model with validation loss: 6.9424
Epoch 3/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:56<00:00,  4.47it/s, loss=7.0727, ppl=1179.29]
<> Validating...

<> Epoch 3 Results:
<>  Time: 0:00:58
Train Loss: 7.0975 | Train PPL: 1208.99
Valid Loss: 6.7588 | Valid PPL: 861.61
<> Saved new best model with validation loss: 6.7588
Epoch 4/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:56<00:00,  4.47it/s, loss=6.9513, ppl=1044.49]
<> Validating...

<> Epoch 4 Results:
<>  Time: 0:00:58
Train Loss: 6.9167 | Train PPL: 1008.95
Valid Loss: 6.6048 | Valid PPL: 738.62
<> Saved new best model with validation loss: 6.6048
Epoch 5/100: 100%|████████████████████████████████████████████████████████████████████████████████████████| 252/252 [01:01<00:00,  4.09it/s, loss=6.8767, ppl=969.44]
<> Validating...

<> Epoch 5 Results:
<>  Time: 0:01:03
Train Loss: 6.7705 | Train PPL: 871.73
Valid Loss: 6.5042 | Valid PPL: 667.95
<> Saved new best model with validation loss: 6.5042
Epoch 6/100: 100%|████████████████████████████████████████████████████████████████████████████████████████| 252/252 [01:01<00:00,  4.11it/s, loss=6.8173, ppl=913.54]
<> Validating...

<> Epoch 6 Results:
<>  Time: 0:01:03
Train Loss: 6.6621 | Train PPL: 782.17
Valid Loss: 6.4363 | Valid PPL: 624.10
<> Saved new best model with validation loss: 6.4363
Epoch 7/100: 100%|████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:55<00:00,  4.50it/s, loss=6.7613, ppl=863.74]
<> Validating...

<> Epoch 7 Results:
<>  Time: 0:00:57
Train Loss: 6.5730 | Train PPL: 715.54
Valid Loss: 6.3767 | Valid PPL: 588.01
<> Saved new best model with validation loss: 6.3767
Epoch 8/100: 100%|████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:59<00:00,  4.26it/s, loss=6.7231, ppl=831.43]
<> Validating...

<> Epoch 8 Results:
<>  Time: 0:01:00
Train Loss: 6.4937 | Train PPL: 660.98
Valid Loss: 6.3126 | Valid PPL: 551.48
<> Saved new best model with validation loss: 6.3126
Epoch 9/100: 100%|████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:58<00:00,  4.33it/s, loss=6.6823, ppl=798.13]
<> Validating...

<> Epoch 9 Results:
<>  Time: 0:00:59
Train Loss: 6.4180 | Train PPL: 612.80
Valid Loss: 6.2593 | Valid PPL: 522.86
<> Saved new best model with validation loss: 6.2593
Epoch 10/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:54<00:00,  4.61it/s, loss=6.6525, ppl=774.74]
<> Validating...

<> Epoch 10 Results:
<>  Time: 0:00:56
Train Loss: 6.3513 | Train PPL: 573.24
Valid Loss: 6.2098 | Valid PPL: 497.60
<> Saved new best model with validation loss: 6.2098
Epoch 11/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:55<00:00,  4.57it/s, loss=6.6413, ppl=766.13]
<> Validating...

<> Epoch 11 Results:
<>  Time: 0:00:56
Train Loss: 6.2894 | Train PPL: 538.82
Valid Loss: 6.1731 | Valid PPL: 479.67
<> Saved new best model with validation loss: 6.1731
Epoch 12/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:57<00:00,  4.39it/s, loss=6.5975, ppl=733.28]
<> Validating...

<> Epoch 12 Results:
<>  Time: 0:00:59
Train Loss: 6.2329 | Train PPL: 509.21
Valid Loss: 6.1368 | Valid PPL: 462.55
<> Saved new best model with validation loss: 6.1368
Epoch 13/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:57<00:00,  4.38it/s, loss=6.5888, ppl=726.90]
<> Validating...

<> Epoch 13 Results:
<>  Time: 0:00:59
Train Loss: 6.1802 | Train PPL: 483.10
Valid Loss: 6.1088 | Valid PPL: 449.79
<> Saved new best model with validation loss: 6.1088
Epoch 14/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:55<00:00,  4.51it/s, loss=6.5630, ppl=708.40]
<> Validating...

<> Epoch 14 Results:
<>  Time: 0:00:57
Train Loss: 6.1299 | Train PPL: 459.40
Valid Loss: 6.0802 | Valid PPL: 437.11
<> Saved new best model with validation loss: 6.0802
Epoch 15/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:58<00:00,  4.34it/s, loss=6.5446, ppl=695.45]
<> Validating...

<> Epoch 15 Results:
<>  Time: 0:00:59
Train Loss: 6.0860 | Train PPL: 439.64
Valid Loss: 6.0528 | Valid PPL: 425.31
<> Saved new best model with validation loss: 6.0528
Epoch 16/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:55<00:00,  4.55it/s, loss=6.5274, ppl=683.62]
<> Validating...

<> Epoch 16 Results:
<>  Time: 0:00:56
Train Loss: 6.0447 | Train PPL: 421.89
Valid Loss: 6.0323 | Valid PPL: 416.68
<> Saved new best model with validation loss: 6.0323
Epoch 17/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:56<00:00,  4.48it/s, loss=6.5200, ppl=678.60]
<> Validating...

<> Epoch 17 Results:
<>  Time: 0:00:58
Train Loss: 6.0077 | Train PPL: 406.56
Valid Loss: 6.0018 | Valid PPL: 404.17
<> Saved new best model with validation loss: 6.0018
Epoch 18/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:56<00:00,  4.49it/s, loss=6.5047, ppl=668.27]
<> Validating...

<> Epoch 18 Results:
<>  Time: 0:00:57
Train Loss: 5.9712 | Train PPL: 391.97
Valid Loss: 5.9918 | Valid PPL: 400.15
<> Saved new best model with validation loss: 5.9918
Epoch 19/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:56<00:00,  4.44it/s, loss=6.5009, ppl=665.76]
<> Validating...

<> Epoch 19 Results:
<>  Time: 0:00:58
Train Loss: 5.9372 | Train PPL: 378.88
Valid Loss: 5.9713 | Valid PPL: 392.03
<> Saved new best model with validation loss: 5.9713
Epoch 20/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:56<00:00,  4.50it/s, loss=6.4947, ppl=661.63]
<> Validating...

<> Epoch 20 Results:
<>  Time: 0:00:57
Train Loss: 5.9036 | Train PPL: 366.37
Valid Loss: 5.9509 | Valid PPL: 384.11
<> Saved new best model with validation loss: 5.9509
Epoch 21/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:56<00:00,  4.49it/s, loss=6.4792, ppl=651.42]
<> Validating...

<> Epoch 21 Results:
<>  Time: 0:00:57
Train Loss: 5.8712 | Train PPL: 354.68
Valid Loss: 5.9286 | Valid PPL: 375.65
<> Saved new best model with validation loss: 5.9286
Epoch 22/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:57<00:00,  4.39it/s, loss=6.4731, ppl=647.46]
<> Validating...

<> Epoch 22 Results:
<>  Time: 0:00:59
Train Loss: 5.8414 | Train PPL: 344.26
Valid Loss: 5.9132 | Valid PPL: 369.88
<> Saved new best model with validation loss: 5.9132
Epoch 23/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:57<00:00,  4.42it/s, loss=6.4553, ppl=636.07]
<> Validating...

<> Epoch 23 Results:
<>  Time: 0:00:58
Train Loss: 5.8128 | Train PPL: 334.54
Valid Loss: 5.8979 | Valid PPL: 364.28
<> Saved new best model with validation loss: 5.8979
Epoch 24/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:58<00:00,  4.33it/s, loss=6.4524, ppl=634.20]
<> Validating...

<> Epoch 24 Results:
<>  Time: 0:00:59
Train Loss: 5.7858 | Train PPL: 325.63
Valid Loss: 5.8844 | Valid PPL: 359.39
<> Saved new best model with validation loss: 5.8844
Epoch 25/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:56<00:00,  4.46it/s, loss=6.4571, ppl=637.21]
<> Validating...

<> Epoch 25 Results:
<>  Time: 0:00:58
Train Loss: 5.7605 | Train PPL: 317.51
Valid Loss: 5.8763 | Valid PPL: 356.50
<> Saved new best model with validation loss: 5.8763
Epoch 26/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:55<00:00,  4.53it/s, loss=6.4677, ppl=643.99]
<> Validating...

<> Epoch 26 Results:
<>  Time: 0:00:57
Train Loss: 5.7377 | Train PPL: 310.36
Valid Loss: 5.8649 | Valid PPL: 352.43
<> Saved new best model with validation loss: 5.8649
Epoch 27/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:57<00:00,  4.39it/s, loss=6.4588, ppl=638.30]
<> Validating...

<> Epoch 27 Results:
<>  Time: 0:00:59
Train Loss: 5.7144 | Train PPL: 303.21
Valid Loss: 5.8628 | Valid PPL: 351.71
<> Saved new best model with validation loss: 5.8628
Epoch 28/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:57<00:00,  4.40it/s, loss=6.4542, ppl=635.37]
<> Validating...

<> Epoch 28 Results:
<>  Time: 0:00:58
Train Loss: 5.6890 | Train PPL: 295.61
Valid Loss: 5.8547 | Valid PPL: 348.89
<> Saved new best model with validation loss: 5.8547
Epoch 29/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:57<00:00,  4.40it/s, loss=6.4429, ppl=628.20]
<> Validating...

<> Epoch 29 Results:
<>  Time: 0:00:59
Train Loss: 5.6643 | Train PPL: 288.39
Valid Loss: 5.8441 | Valid PPL: 345.21
<> Saved new best model with validation loss: 5.8441
Epoch 30/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:55<00:00,  4.53it/s, loss=6.4492, ppl=632.22]
<> Validating...

<> Epoch 30 Results:
<>  Time: 0:00:57
Train Loss: 5.6430 | Train PPL: 282.32
Valid Loss: 5.8342 | Valid PPL: 341.80
<> Saved new best model with validation loss: 5.8342
Epoch 31/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:55<00:00,  4.50it/s, loss=6.4311, ppl=620.88]
<> Validating...

<> Epoch 31 Results:
<>  Time: 0:00:57
Train Loss: 5.6221 | Train PPL: 276.47
Valid Loss: 5.8205 | Valid PPL: 337.14
<> Saved new best model with validation loss: 5.8205
Epoch 32/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:58<00:00,  4.31it/s, loss=6.4271, ppl=618.36]
<> Validating...

<> Epoch 32 Results:
<>  Time: 0:01:00
Train Loss: 5.6000 | Train PPL: 270.42
Valid Loss: 5.8106 | Valid PPL: 333.83
<> Saved new best model with validation loss: 5.8106
Epoch 33/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:56<00:00,  4.47it/s, loss=6.4298, ppl=620.07]
<> Validating...

<> Epoch 33 Results:
<>  Time: 0:00:58
Train Loss: 5.5778 | Train PPL: 264.50
Valid Loss: 5.8068 | Valid PPL: 332.57
<> Saved new best model with validation loss: 5.8068
Epoch 34/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:57<00:00,  4.38it/s, loss=6.4245, ppl=616.78]
<> Validating...

<> Epoch 34 Results:
<>  Time: 0:00:59
Train Loss: 5.5574 | Train PPL: 259.15
Valid Loss: 5.8004 | Valid PPL: 330.44
<> Saved new best model with validation loss: 5.8004
Epoch 35/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:57<00:00,  4.35it/s, loss=6.4150, ppl=610.92]
<> Validating...

<> Epoch 35 Results:
<>  Time: 0:00:59
Train Loss: 5.5376 | Train PPL: 254.06
Valid Loss: 5.7938 | Valid PPL: 328.26
<> Saved new best model with validation loss: 5.7938
Epoch 36/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:56<00:00,  4.43it/s, loss=6.4218, ppl=615.10]
<> Validating...

<> Epoch 36 Results:
<>  Time: 0:00:58
Train Loss: 5.5186 | Train PPL: 249.28
Valid Loss: 5.7946 | Valid PPL: 328.51
<> No improvement for 1 epoch(s).
Epoch 37/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:55<00:00,  4.53it/s, loss=6.4123, ppl=609.28]
<> Validating...

<> Epoch 37 Results:
<>  Time: 0:00:57
Train Loss: 5.5011 | Train PPL: 244.95
Valid Loss: 5.7846 | Valid PPL: 325.27
<> Saved new best model with validation loss: 5.7846
Epoch 38/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:56<00:00,  4.47it/s, loss=6.3913, ppl=596.62]
<> Validating...

<> Epoch 38 Results:
<>  Time: 0:00:57
Train Loss: 5.4815 | Train PPL: 240.21
Valid Loss: 5.7771 | Valid PPL: 322.83
<> Saved new best model with validation loss: 5.7771
Epoch 39/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:55<00:00,  4.51it/s, loss=6.4050, ppl=604.88]
<> Validating...

<> Epoch 39 Results:
<>  Time: 0:00:57
Train Loss: 5.4633 | Train PPL: 235.88
Valid Loss: 5.7728 | Valid PPL: 321.43
<> Saved new best model with validation loss: 5.7728
Epoch 40/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:56<00:00,  4.43it/s, loss=6.4045, ppl=604.55]
<> Validating...

<> Epoch 40 Results:
<>  Time: 0:00:58
Train Loss: 5.4473 | Train PPL: 232.14
Valid Loss: 5.7701 | Valid PPL: 320.56
<> Saved new best model with validation loss: 5.7701
Epoch 41/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:55<00:00,  4.51it/s, loss=6.4050, ppl=604.85]
<> Validating...

<> Epoch 41 Results:
<>  Time: 0:00:57
Train Loss: 5.4307 | Train PPL: 228.30
Valid Loss: 5.7637 | Valid PPL: 318.52
<> Saved new best model with validation loss: 5.7637
Epoch 42/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:58<00:00,  4.29it/s, loss=6.4148, ppl=610.80]
<> Validating...

<> Epoch 42 Results:
<>  Time: 0:01:00
Train Loss: 5.4156 | Train PPL: 224.89
Valid Loss: 5.7574 | Valid PPL: 316.52
<> Saved new best model with validation loss: 5.7574
Epoch 43/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:55<00:00,  4.55it/s, loss=6.4125, ppl=609.41]
<> Validating...

<> Epoch 43 Results:
<>  Time: 0:00:57
Train Loss: 5.4014 | Train PPL: 221.71
Valid Loss: 5.7532 | Valid PPL: 315.20
<> Saved new best model with validation loss: 5.7532
Epoch 44/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:57<00:00,  4.35it/s, loss=6.3950, ppl=598.84]
<> Validating...

<> Epoch 44 Results:
<>  Time: 0:00:59
Train Loss: 5.3870 | Train PPL: 218.56
Valid Loss: 5.7511 | Valid PPL: 314.54
<> Saved new best model with validation loss: 5.7511
Epoch 45/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:57<00:00,  4.39it/s, loss=6.3941, ppl=598.32]
<> Validating...

<> Epoch 45 Results:
<>  Time: 0:00:59
Train Loss: 5.3731 | Train PPL: 215.54
Valid Loss: 5.7466 | Valid PPL: 313.14
<> Saved new best model with validation loss: 5.7466
Epoch 46/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:59<00:00,  4.23it/s, loss=6.3885, ppl=594.96]
<> Validating...

<> Epoch 46 Results:
<>  Time: 0:01:01
Train Loss: 5.3609 | Train PPL: 212.91
Valid Loss: 5.7419 | Valid PPL: 311.67
<> Saved new best model with validation loss: 5.7419
Epoch 47/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:55<00:00,  4.52it/s, loss=6.3951, ppl=598.92]
<> Validating...

<> Epoch 47 Results:
<>  Time: 0:00:57
Train Loss: 5.3480 | Train PPL: 210.18
Valid Loss: 5.7415 | Valid PPL: 311.53
<> Saved new best model with validation loss: 5.7415
Epoch 48/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:57<00:00,  4.42it/s, loss=6.3840, ppl=592.28]
<> Validating...

<> Epoch 48 Results:
<>  Time: 0:00:58
Train Loss: 5.3359 | Train PPL: 207.67
Valid Loss: 5.7360 | Valid PPL: 309.82
<> Saved new best model with validation loss: 5.7360
Epoch 49/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:55<00:00,  4.52it/s, loss=6.3884, ppl=594.89]
<> Validating...

<> Epoch 49 Results:
<>  Time: 0:00:57
Train Loss: 5.3236 | Train PPL: 205.13
Valid Loss: 5.7304 | Valid PPL: 308.11
<> Saved new best model with validation loss: 5.7304
Epoch 50/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:57<00:00,  4.40it/s, loss=6.3888, ppl=595.13]
<> Validating...

<> Epoch 50 Results:
<>  Time: 0:00:58
Train Loss: 5.3106 | Train PPL: 202.46
Valid Loss: 5.7276 | Valid PPL: 307.22
<> Saved new best model with validation loss: 5.7276
Epoch 51/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:57<00:00,  4.39it/s, loss=6.3812, ppl=590.65]
<> Validating...

<> Epoch 51 Results:
<>  Time: 0:00:59
Train Loss: 5.2986 | Train PPL: 200.05
Valid Loss: 5.7225 | Valid PPL: 305.66
<> Saved new best model with validation loss: 5.7225
Epoch 52/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:58<00:00,  4.32it/s, loss=6.3734, ppl=586.05]
<> Validating...

<> Epoch 52 Results:
<>  Time: 0:00:59
Train Loss: 5.2868 | Train PPL: 197.71
Valid Loss: 5.7200 | Valid PPL: 304.92
<> Saved new best model with validation loss: 5.7200
Epoch 53/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:58<00:00,  4.30it/s, loss=6.3858, ppl=593.37]
<> Validating...

<> Epoch 53 Results:
<>  Time: 0:01:00
Train Loss: 5.2750 | Train PPL: 195.39
Valid Loss: 5.7186 | Valid PPL: 304.47
<> Saved new best model with validation loss: 5.7186
Epoch 54/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:58<00:00,  4.32it/s, loss=6.3848, ppl=592.74]
<> Validating...

<> Epoch 54 Results:
<>  Time: 0:01:00
Train Loss: 5.2633 | Train PPL: 193.12
Valid Loss: 5.7159 | Valid PPL: 303.66
<> Saved new best model with validation loss: 5.7159
Epoch 55/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:56<00:00,  4.45it/s, loss=6.3823, ppl=591.26]
<> Validating...

<> Epoch 55 Results:
<>  Time: 0:00:58
Train Loss: 5.2538 | Train PPL: 191.29
Valid Loss: 5.7112 | Valid PPL: 302.25
<> Saved new best model with validation loss: 5.7112
Epoch 56/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:58<00:00,  4.28it/s, loss=6.3710, ppl=584.65]
<> Validating...

<> Epoch 56 Results:
<>  Time: 0:01:00
Train Loss: 5.2444 | Train PPL: 189.50
Valid Loss: 5.7065 | Valid PPL: 300.81
<> Saved new best model with validation loss: 5.7065
Epoch 57/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:55<00:00,  4.52it/s, loss=6.3746, ppl=586.78]
<> Validating...

<> Epoch 57 Results:
<>  Time: 0:00:57
Train Loss: 5.2344 | Train PPL: 187.62
Valid Loss: 5.7046 | Valid PPL: 300.23
<> Saved new best model with validation loss: 5.7046
Epoch 58/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:58<00:00,  4.33it/s, loss=6.3719, ppl=585.16]
<> Validating...

<> Epoch 58 Results:
<>  Time: 0:00:59
Train Loss: 5.2256 | Train PPL: 185.97
Valid Loss: 5.7016 | Valid PPL: 299.35
<> Saved new best model with validation loss: 5.7016
Epoch 59/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:55<00:00,  4.57it/s, loss=6.3658, ppl=581.58]
<> Validating...

<> Epoch 59 Results:
<>  Time: 0:00:56
Train Loss: 5.2165 | Train PPL: 184.30
Valid Loss: 5.6989 | Valid PPL: 298.55
<> Saved new best model with validation loss: 5.6989
Epoch 60/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:56<00:00,  4.47it/s, loss=6.3595, ppl=577.95]
<> Validating...

<> Epoch 60 Results:
<>  Time: 0:00:57
Train Loss: 5.2082 | Train PPL: 182.76
Valid Loss: 5.6987 | Valid PPL: 298.47
<> Saved new best model with validation loss: 5.6987
Epoch 61/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:56<00:00,  4.49it/s, loss=6.3789, ppl=589.27]
<> Validating...

<> Epoch 61 Results:
<>  Time: 0:00:57
Train Loss: 5.2011 | Train PPL: 181.46
Valid Loss: 5.6996 | Valid PPL: 298.76
<> No improvement for 1 epoch(s).
Epoch 62/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:56<00:00,  4.49it/s, loss=6.3745, ppl=586.71]
<> Validating...

<> Epoch 62 Results:
<>  Time: 0:00:57
Train Loss: 5.1938 | Train PPL: 180.16
Valid Loss: 5.7024 | Valid PPL: 299.58
<> No improvement for 2 epoch(s).
Epoch 63/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:56<00:00,  4.45it/s, loss=6.3719, ppl=585.14]
<> Validating...

<> Epoch 63 Results:
<>  Time: 0:00:58
Train Loss: 5.1875 | Train PPL: 179.02
Valid Loss: 5.7044 | Valid PPL: 300.18
<> No improvement for 3 epoch(s).
Epoch 64/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:56<00:00,  4.49it/s, loss=6.3727, ppl=585.61]
<> Validating...

<> Epoch 64 Results:
<>  Time: 0:00:57
Train Loss: 5.1808 | Train PPL: 177.82
Valid Loss: 5.7013 | Valid PPL: 299.27
<> No improvement for 4 epoch(s).
Epoch 65/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:56<00:00,  4.42it/s, loss=6.3722, ppl=585.36]
<> Validating...

<> Epoch 65 Results:
<>  Time: 0:00:58
Train Loss: 5.1724 | Train PPL: 176.34
Valid Loss: 5.6961 | Valid PPL: 297.71
<> Saved new best model with validation loss: 5.6961
Epoch 66/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:56<00:00,  4.44it/s, loss=6.3786, ppl=589.12]
<> Validating...

<> Epoch 66 Results:
<>  Time: 0:00:58
Train Loss: 5.1660 | Train PPL: 175.21
Valid Loss: 5.6943 | Valid PPL: 297.17
<> Saved new best model with validation loss: 5.6943
Epoch 67/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:56<00:00,  4.45it/s, loss=6.3771, ppl=588.20]
<> Validating...

<> Epoch 67 Results:
<>  Time: 0:00:58
Train Loss: 5.1597 | Train PPL: 174.11
Valid Loss: 5.6924 | Valid PPL: 296.59
<> Saved new best model with validation loss: 5.6924
Epoch 68/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:56<00:00,  4.43it/s, loss=6.3753, ppl=587.19]
<> Validating...

<> Epoch 68 Results:
<>  Time: 0:00:58
Train Loss: 5.1539 | Train PPL: 173.11
Valid Loss: 5.6908 | Valid PPL: 296.14
<> Saved new best model with validation loss: 5.6908
Epoch 69/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:55<00:00,  4.55it/s, loss=6.3776, ppl=588.50]
<> Validating...

<> Epoch 69 Results:
<>  Time: 0:00:57
Train Loss: 5.1479 | Train PPL: 172.06
Valid Loss: 5.6921 | Valid PPL: 296.52
<> No improvement for 1 epoch(s).
Epoch 70/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:55<00:00,  4.52it/s, loss=6.3832, ppl=591.83]
<> Validating...

<> Epoch 70 Results:
<>  Time: 0:00:57
Train Loss: 5.1433 | Train PPL: 171.28
Valid Loss: 5.6906 | Valid PPL: 296.07
<> Saved new best model with validation loss: 5.6906
Epoch 71/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:55<00:00,  4.53it/s, loss=6.3680, ppl=582.90]
<> Validating...

<> Epoch 71 Results:
<>  Time: 0:00:57
Train Loss: 5.1378 | Train PPL: 170.33
Valid Loss: 5.6892 | Valid PPL: 295.66
<> Saved new best model with validation loss: 5.6892
Epoch 72/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:55<00:00,  4.54it/s, loss=6.3788, ppl=589.20]
<> Validating...

<> Epoch 72 Results:
<>  Time: 0:00:57
Train Loss: 5.1331 | Train PPL: 169.54
Valid Loss: 5.6882 | Valid PPL: 295.35
<> Saved new best model with validation loss: 5.6882
Epoch 73/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:56<00:00,  4.42it/s, loss=6.3762, ppl=587.66]
<> Validating...

<> Epoch 73 Results:
<>  Time: 0:00:58
Train Loss: 5.1283 | Train PPL: 168.73
Valid Loss: 5.6883 | Valid PPL: 295.38
<> No improvement for 1 epoch(s).
Epoch 74/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:55<00:00,  4.52it/s, loss=6.3745, ppl=586.69]
<> Validating...

<> Epoch 74 Results:
<>  Time: 0:00:57
Train Loss: 5.1239 | Train PPL: 167.98
Valid Loss: 5.6879 | Valid PPL: 295.28
<> Saved new best model with validation loss: 5.6879
Epoch 75/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:57<00:00,  4.40it/s, loss=6.3811, ppl=590.59]
<> Validating...

<> Epoch 75 Results:
<>  Time: 0:00:59
Train Loss: 5.1207 | Train PPL: 167.45
Valid Loss: 5.6888 | Valid PPL: 295.54
<> No improvement for 1 epoch(s).
Epoch 76/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:55<00:00,  4.50it/s, loss=6.3773, ppl=588.36]
<> Validating...

<> Epoch 76 Results:
<>  Time: 0:00:57
Train Loss: 5.1164 | Train PPL: 166.74
Valid Loss: 5.6887 | Valid PPL: 295.50
<> No improvement for 2 epoch(s).
Epoch 77/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:55<00:00,  4.50it/s, loss=6.3722, ppl=585.36]
<> Validating...

<> Epoch 77 Results:
<>  Time: 0:00:57
Train Loss: 5.1137 | Train PPL: 166.28
Valid Loss: 5.6886 | Valid PPL: 295.48
<> No improvement for 3 epoch(s).
Epoch 78/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:55<00:00,  4.50it/s, loss=6.3621, ppl=579.45]
<> Validating...

<> Epoch 78 Results:
<>  Time: 0:00:57
Train Loss: 5.1100 | Train PPL: 165.66
Valid Loss: 5.6885 | Valid PPL: 295.45
<> No improvement for 4 epoch(s).
Epoch 79/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:55<00:00,  4.51it/s, loss=6.3697, ppl=583.89]
<> Validating...

<> Epoch 79 Results:
<>  Time: 0:00:57
Train Loss: 5.1067 | Train PPL: 165.12
Valid Loss: 5.6877 | Valid PPL: 295.21
<> Saved new best model with validation loss: 5.6877
Epoch 80/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:59<00:00,  4.25it/s, loss=6.3723, ppl=585.39]
<> Validating...

<> Epoch 80 Results:
<>  Time: 0:01:00
Train Loss: 5.1042 | Train PPL: 164.72
Valid Loss: 5.6877 | Valid PPL: 295.21
<> No improvement for 1 epoch(s).
Epoch 81/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:58<00:00,  4.33it/s, loss=6.3705, ppl=584.37]
<> Validating...

<> Epoch 81 Results:
<>  Time: 0:00:59
Train Loss: 5.1011 | Train PPL: 164.20
Valid Loss: 5.6867 | Valid PPL: 294.92
<> Saved new best model with validation loss: 5.6867
Epoch 82/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:58<00:00,  4.32it/s, loss=6.3745, ppl=586.68]
<> Validating...

<> Epoch 82 Results:
<>  Time: 0:00:59
Train Loss: 5.0991 | Train PPL: 163.88
Valid Loss: 5.6869 | Valid PPL: 294.97
<> No improvement for 1 epoch(s).
Epoch 83/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:56<00:00,  4.45it/s, loss=6.3804, ppl=590.18]
<> Validating...

<> Epoch 83 Results:
<>  Time: 0:00:58
Train Loss: 5.0963 | Train PPL: 163.41
Valid Loss: 5.6860 | Valid PPL: 294.70
<> Saved new best model with validation loss: 5.6860
Epoch 84/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:58<00:00,  4.31it/s, loss=6.3596, ppl=578.01]
<> Validating...

<> Epoch 84 Results:
<>  Time: 0:01:00
Train Loss: 5.0949 | Train PPL: 163.19
Valid Loss: 5.6853 | Valid PPL: 294.52
<> Saved new best model with validation loss: 5.6853
Epoch 85/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:58<00:00,  4.32it/s, loss=6.3676, ppl=582.66]
<> Validating...

<> Epoch 85 Results:
<>  Time: 0:00:59
Train Loss: 5.0936 | Train PPL: 162.98
Valid Loss: 5.6844 | Valid PPL: 294.23
<> Saved new best model with validation loss: 5.6844
Epoch 86/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:57<00:00,  4.35it/s, loss=6.3610, ppl=578.83]
<> Validating...

<> Epoch 86 Results:
<>  Time: 0:00:59
Train Loss: 5.0920 | Train PPL: 162.71
Valid Loss: 5.6830 | Valid PPL: 293.83
<> Saved new best model with validation loss: 5.6830
Epoch 87/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:57<00:00,  4.42it/s, loss=6.3637, ppl=580.36]
<> Validating...

<> Epoch 87 Results:
<>  Time: 0:00:58
Train Loss: 5.0898 | Train PPL: 162.36
Valid Loss: 5.6819 | Valid PPL: 293.52
<> Saved new best model with validation loss: 5.6819
Epoch 88/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:57<00:00,  4.37it/s, loss=6.3730, ppl=585.84]
<> Validating...

<> Epoch 88 Results:
<>  Time: 0:00:59
Train Loss: 5.0895 | Train PPL: 162.31
Valid Loss: 5.6809 | Valid PPL: 293.22
<> Saved new best model with validation loss: 5.6809
Epoch 89/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:58<00:00,  4.31it/s, loss=6.3701, ppl=584.13]
<> Validating...

<> Epoch 89 Results:
<>  Time: 0:01:00
Train Loss: 5.0885 | Train PPL: 162.14
Valid Loss: 5.6802 | Valid PPL: 293.02
<> Saved new best model with validation loss: 5.6802
Epoch 90/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:56<00:00,  4.47it/s, loss=6.3737, ppl=586.22]
<> Validating...

<> Epoch 90 Results:
<>  Time: 0:00:58
Train Loss: 5.0870 | Train PPL: 161.90
Valid Loss: 5.6803 | Valid PPL: 293.04
<> No improvement for 1 epoch(s).
Epoch 91/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:57<00:00,  4.36it/s, loss=6.3749, ppl=586.93]
<> Validating...

<> Epoch 91 Results:
<>  Time: 0:00:59
Train Loss: 5.0865 | Train PPL: 161.82
Valid Loss: 5.6803 | Valid PPL: 293.05
<> No improvement for 2 epoch(s).
Epoch 92/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:58<00:00,  4.33it/s, loss=6.3688, ppl=583.38]
<> Validating...

<> Epoch 92 Results:
<>  Time: 0:00:59
Train Loss: 5.0862 | Train PPL: 161.77
Valid Loss: 5.6805 | Valid PPL: 293.10
<> No improvement for 3 epoch(s).
Epoch 93/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:56<00:00,  4.46it/s, loss=6.3572, ppl=576.63]
<> Validating...

<> Epoch 93 Results:
<>  Time: 0:00:58
Train Loss: 5.0840 | Train PPL: 161.42
Valid Loss: 5.6806 | Valid PPL: 293.12
<> No improvement for 4 epoch(s).
Epoch 94/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:56<00:00,  4.44it/s, loss=6.3806, ppl=590.30]
<> Validating...

<> Epoch 94 Results:
<>  Time: 0:00:58
Train Loss: 5.0837 | Train PPL: 161.37
Valid Loss: 5.6806 | Valid PPL: 293.12
<> No improvement for 5 epoch(s).
Epoch 95/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:55<00:00,  4.55it/s, loss=6.3696, ppl=583.80]
<> Validating...

<> Epoch 95 Results:
<>  Time: 0:00:56
Train Loss: 5.0837 | Train PPL: 161.38
Valid Loss: 5.6805 | Valid PPL: 293.08
<> No improvement for 6 epoch(s).
Epoch 96/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:55<00:00,  4.58it/s, loss=6.3707, ppl=584.46]
<> Validating...

<> Epoch 96 Results:
<>  Time: 0:00:56
Train Loss: 5.0835 | Train PPL: 161.34
Valid Loss: 5.6804 | Valid PPL: 293.07
<> No improvement for 7 epoch(s).
Epoch 97/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:55<00:00,  4.58it/s, loss=6.3735, ppl=586.11]
<> Validating...

<> Epoch 97 Results:
<>  Time: 0:00:56
Train Loss: 5.0831 | Train PPL: 161.28
Valid Loss: 5.6804 | Valid PPL: 293.07
<> No improvement for 8 epoch(s).
Epoch 98/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:54<00:00,  4.59it/s, loss=6.3690, ppl=583.47]
<> Validating...

<> Epoch 98 Results:
<>  Time: 0:00:56
Train Loss: 5.0834 | Train PPL: 161.32
Valid Loss: 5.6803 | Valid PPL: 293.05
<> No improvement for 9 epoch(s).
Epoch 99/100: 100%|███████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:54<00:00,  4.61it/s, loss=6.3602, ppl=578.34]
<> Validating...

<> Epoch 99 Results:
<>  Time: 0:00:56
Train Loss: 5.0830 | Train PPL: 161.26
Valid Loss: 5.6803 | Valid PPL: 293.04
<> No improvement for 10 epoch(s).

<> Auto-Exit Triggered: Validation loss has not improved for 10 epochs.

==================================================
<> Training Complete!
==================================================
Best validation loss: 5.6802
Total time: 1:36:53

<> Loading Best Model for Evaluation...

==================================================
<> FINAL TEST EVALUATION
==================================================
Testing: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 29/29 [00:04<00:00,  6.38it/s]
>> Final Test Loss: 4.7839
>> Final Test Perplexity: 119.57
==================================================