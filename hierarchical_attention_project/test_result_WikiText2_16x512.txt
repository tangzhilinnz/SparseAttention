==================================================
<> Training Transformer Model (AMP Enabled)
==================================================
/home/ztang13/workspace/SparseAttention/myenv/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.  warnings.warn(
/home/ztang13/workspace/SparseAttention/hierarchical_attention_project/Hierarchical_transformer_Triton_WikiText2.py:380: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler()
Epoch 1/100:   0%|                                                                                                                                                                        | 0/252 [00:00<?, ?it/s]/home/ztang13/workspace/SparseAttention/hierarchical_attention_project/Hierarchical_transformer_Triton_WikiText2.py:412: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Epoch 1/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:27<00:00,  9.31it/s, loss=7.4436, ppl=1708.91]
<> Validating...
/home/ztang13/workspace/SparseAttention/hierarchical_attention_project/Hierarchical_transformer_Triton_WikiText2.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():

<> Epoch 1 Results:
<>  Time: 0:00:28
Train Loss: 8.2257 | Train PPL: 3735.61
Valid Loss: 7.1521 | Valid PPL: 1276.78
<> Saved new best model with validation loss: 7.1521
Epoch 2/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:25<00:00,  9.85it/s, loss=7.2251, ppl=1373.54]
<> Validating...

<> Epoch 2 Results:
<>  Time: 0:00:26
Train Loss: 7.3114 | Train PPL: 1497.25
Valid Loss: 6.9586 | Valid PPL: 1052.18
<> Saved new best model with validation loss: 6.9586
Epoch 3/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:24<00:00, 10.24it/s, loss=7.0966, ppl=1207.89]
<> Validating...

<> Epoch 3 Results:
<>  Time: 0:00:25
Train Loss: 7.1188 | Train PPL: 1234.95
Valid Loss: 6.7915 | Valid PPL: 890.28
<> Saved new best model with validation loss: 6.7915
Epoch 4/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:25<00:00, 10.02it/s, loss=6.9792, ppl=1074.07]
<> Validating...

<> Epoch 4 Results:
<>  Time: 0:00:26
Train Loss: 6.9519 | Train PPL: 1045.16
Valid Loss: 6.6448 | Valid PPL: 768.75
<> Saved new best model with validation loss: 6.6448
Epoch 5/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:24<00:00, 10.23it/s, loss=6.8874, ppl=979.89]
<> Validating...

<> Epoch 5 Results:
<>  Time: 0:00:25
Train Loss: 6.8090 | Train PPL: 905.94
Valid Loss: 6.5375 | Valid PPL: 690.57
<> Saved new best model with validation loss: 6.5375
Epoch 6/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:25<00:00, 10.00it/s, loss=6.8285, ppl=923.78]
<> Validating...

<> Epoch 6 Results:
<>  Time: 0:00:26
Train Loss: 6.7016 | Train PPL: 813.75
Valid Loss: 6.4635 | Valid PPL: 641.30
<> Saved new best model with validation loss: 6.4635
Epoch 7/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:25<00:00, 10.04it/s, loss=6.7768, ppl=877.27]
<> Validating...

<> Epoch 7 Results:
<>  Time: 0:00:26
Train Loss: 6.6171 | Train PPL: 747.78
Valid Loss: 6.4135 | Valid PPL: 610.02
<> Saved new best model with validation loss: 6.4135
Epoch 8/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:24<00:00, 10.39it/s, loss=6.7449, ppl=849.69]
<> Validating...

<> Epoch 8 Results:
<>  Time: 0:00:25
Train Loss: 6.5459 | Train PPL: 696.38
Valid Loss: 6.3617 | Valid PPL: 579.21
<> Saved new best model with validation loss: 6.3617
Epoch 9/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:24<00:00, 10.18it/s, loss=6.7247, ppl=832.69]
<> Validating...

<> Epoch 9 Results:
<>  Time: 0:00:25
Train Loss: 6.4800 | Train PPL: 651.94
Valid Loss: 6.3103 | Valid PPL: 550.19
<> Saved new best model with validation loss: 6.3103
Epoch 10/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:24<00:00, 10.23it/s, loss=6.6836, ppl=799.20]
<> Validating...

<> Epoch 10 Results:
<>  Time: 0:00:25
Train Loss: 6.4184 | Train PPL: 613.01
Valid Loss: 6.2651 | Valid PPL: 525.87
<> Saved new best model with validation loss: 6.2651
Epoch 11/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:25<00:00, 10.03it/s, loss=6.6713, ppl=789.46]
<> Validating...

<> Epoch 11 Results:
<>  Time: 0:00:26
Train Loss: 6.3591 | Train PPL: 577.72
Valid Loss: 6.2257 | Valid PPL: 505.60
<> Saved new best model with validation loss: 6.2257
Epoch 12/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:24<00:00, 10.34it/s, loss=6.6349, ppl=761.17]
<> Validating...

<> Epoch 12 Results:
<>  Time: 0:00:25
Train Loss: 6.3023 | Train PPL: 545.85
Valid Loss: 6.1875 | Valid PPL: 486.62
<> Saved new best model with validation loss: 6.1875
Epoch 13/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:25<00:00,  9.82it/s, loss=6.6290, ppl=756.76]
<> Validating...

<> Epoch 13 Results:
<>  Time: 0:00:26
Train Loss: 6.2505 | Train PPL: 518.28
Valid Loss: 6.1549 | Valid PPL: 471.04
<> Saved new best model with validation loss: 6.1549
Epoch 14/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:25<00:00,  9.98it/s, loss=6.6096, ppl=742.18]
<> Validating...

<> Epoch 14 Results:
<>  Time: 0:00:26
Train Loss: 6.2024 | Train PPL: 493.95
Valid Loss: 6.1281 | Valid PPL: 458.58
<> Saved new best model with validation loss: 6.1281
Epoch 15/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:25<00:00,  9.98it/s, loss=6.5863, ppl=725.11]
<> Validating...

<> Epoch 15 Results:
<>  Time: 0:00:26
Train Loss: 6.1589 | Train PPL: 472.92
Valid Loss: 6.1032 | Valid PPL: 447.30
<> Saved new best model with validation loss: 6.1032
Epoch 16/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:24<00:00, 10.25it/s, loss=6.5591, ppl=705.65]
<> Validating...

<> Epoch 16 Results:
<>  Time: 0:00:25
Train Loss: 6.1168 | Train PPL: 453.43
Valid Loss: 6.0776 | Valid PPL: 435.98
<> Saved new best model with validation loss: 6.0776
Epoch 17/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:24<00:00, 10.09it/s, loss=6.5633, ppl=708.57]
<> Validating...

<> Epoch 17 Results:
<>  Time: 0:00:26
Train Loss: 6.0784 | Train PPL: 436.31
Valid Loss: 6.0538 | Valid PPL: 425.75
<> Saved new best model with validation loss: 6.0538
Epoch 18/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:24<00:00, 10.29it/s, loss=6.5508, ppl=699.82]
<> Validating...

<> Epoch 18 Results:
<>  Time: 0:00:25
Train Loss: 6.0421 | Train PPL: 420.79
Valid Loss: 6.0305 | Valid PPL: 415.91
<> Saved new best model with validation loss: 6.0305
Epoch 19/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:24<00:00, 10.22it/s, loss=6.5366, ppl=689.92]
<> Validating...

<> Epoch 19 Results:
<>  Time: 0:00:25
Train Loss: 6.0084 | Train PPL: 406.84
Valid Loss: 6.0126 | Valid PPL: 408.56
<> Saved new best model with validation loss: 6.0126
Epoch 20/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:25<00:00, 10.01it/s, loss=6.5168, ppl=676.41]
<> Validating...

<> Epoch 20 Results:
<>  Time: 0:00:26
Train Loss: 5.9761 | Train PPL: 393.91
Valid Loss: 5.9953 | Valid PPL: 401.55
<> Saved new best model with validation loss: 5.9953
Epoch 21/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:24<00:00, 10.12it/s, loss=6.5159, ppl=675.77]
<> Validating...

<> Epoch 21 Results:
<>  Time: 0:00:25
Train Loss: 5.9465 | Train PPL: 382.43
Valid Loss: 5.9796 | Valid PPL: 395.28
<> Saved new best model with validation loss: 5.9796
Epoch 22/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:24<00:00, 10.27it/s, loss=6.5028, ppl=667.00]
<> Validating...

<> Epoch 22 Results:
<>  Time: 0:00:25
Train Loss: 5.9179 | Train PPL: 371.63
Valid Loss: 5.9620 | Valid PPL: 388.38
<> Saved new best model with validation loss: 5.9620
Epoch 23/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:25<00:00,  9.71it/s, loss=6.4857, ppl=655.67]
<> Validating...

<> Epoch 23 Results:
<>  Time: 0:00:26
Train Loss: 5.8916 | Train PPL: 362.00
Valid Loss: 5.9547 | Valid PPL: 385.54
<> Saved new best model with validation loss: 5.9547
Epoch 24/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:24<00:00, 10.31it/s, loss=6.4873, ppl=656.74]
<> Validating...

<> Epoch 24 Results:
<>  Time: 0:00:25
Train Loss: 5.8641 | Train PPL: 352.15
Valid Loss: 5.9409 | Valid PPL: 380.26
<> Saved new best model with validation loss: 5.9409
Epoch 25/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:25<00:00,  9.89it/s, loss=6.4706, ppl=645.87]
<> Validating...

<> Epoch 25 Results:
<>  Time: 0:00:26
Train Loss: 5.8389 | Train PPL: 343.41
Valid Loss: 5.9244 | Valid PPL: 374.05
<> Saved new best model with validation loss: 5.9244
Epoch 26/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:24<00:00, 10.15it/s, loss=6.4708, ppl=645.98]
<> Validating...

<> Epoch 26 Results:
<>  Time: 0:00:25
Train Loss: 5.8130 | Train PPL: 334.61
Valid Loss: 5.9110 | Valid PPL: 369.07
<> Saved new best model with validation loss: 5.9110
Epoch 27/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:25<00:00,  9.99it/s, loss=6.4612, ppl=639.85]
<> Validating...

<> Epoch 27 Results:
<>  Time: 0:00:26
Train Loss: 5.7914 | Train PPL: 327.47
Valid Loss: 5.9003 | Valid PPL: 365.14
<> Saved new best model with validation loss: 5.9003
Epoch 28/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:25<00:00,  9.88it/s, loss=6.4755, ppl=649.04]
<> Validating...

<> Epoch 28 Results:
<>  Time: 0:00:26
Train Loss: 5.7719 | Train PPL: 321.14
Valid Loss: 5.8923 | Valid PPL: 362.25
<> Saved new best model with validation loss: 5.8923
Epoch 29/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:24<00:00, 10.29it/s, loss=6.4702, ppl=645.63]
<> Validating...

<> Epoch 29 Results:
<>  Time: 0:00:25
Train Loss: 5.7498 | Train PPL: 314.13
Valid Loss: 5.8829 | Valid PPL: 358.85
<> Saved new best model with validation loss: 5.8829
Epoch 30/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:24<00:00, 10.08it/s, loss=6.4572, ppl=637.27]
<> Validating...

<> Epoch 30 Results:
<>  Time: 0:00:26
Train Loss: 5.7266 | Train PPL: 306.93
Valid Loss: 5.8708 | Valid PPL: 354.52
<> Saved new best model with validation loss: 5.8708
Epoch 31/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:24<00:00, 10.28it/s, loss=6.4548, ppl=635.77]
<> Validating...

<> Epoch 31 Results:
<>  Time: 0:00:25
Train Loss: 5.7052 | Train PPL: 300.44
Valid Loss: 5.8621 | Valid PPL: 351.47
<> Saved new best model with validation loss: 5.8621
Epoch 32/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:24<00:00, 10.17it/s, loss=6.4464, ppl=630.44]
<> Validating...

<> Epoch 32 Results:
<>  Time: 0:00:25
Train Loss: 5.6827 | Train PPL: 293.74
Valid Loss: 5.8570 | Valid PPL: 349.69
<> Saved new best model with validation loss: 5.8570
Epoch 33/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:25<00:00, 10.00it/s, loss=6.4465, ppl=630.46]
<> Validating...

<> Epoch 33 Results:
<>  Time: 0:00:26
Train Loss: 5.6629 | Train PPL: 287.98
Valid Loss: 5.8462 | Valid PPL: 345.91
<> Saved new best model with validation loss: 5.8462
Epoch 34/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:24<00:00, 10.31it/s, loss=6.4440, ppl=628.94]
<> Validating...

<> Epoch 34 Results:
<>  Time: 0:00:25
Train Loss: 5.6436 | Train PPL: 282.47
Valid Loss: 5.8398 | Valid PPL: 343.71
<> Saved new best model with validation loss: 5.8398
Epoch 35/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:24<00:00, 10.20it/s, loss=6.4396, ppl=626.19]
<> Validating...

<> Epoch 35 Results:
<>  Time: 0:00:25
Train Loss: 5.6270 | Train PPL: 277.83
Valid Loss: 5.8354 | Valid PPL: 342.22
<> Saved new best model with validation loss: 5.8354
Epoch 36/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:24<00:00, 10.12it/s, loss=6.4287, ppl=619.36]
<> Validating...

<> Epoch 36 Results:
<>  Time: 0:00:25
Train Loss: 5.6117 | Train PPL: 273.60
Valid Loss: 5.8386 | Valid PPL: 343.30
<> No improvement for 1 epoch(s).
Epoch 37/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:24<00:00, 10.19it/s, loss=6.4300, ppl=620.15]
<> Validating...

<> Epoch 37 Results:
<>  Time: 0:00:25
Train Loss: 5.5944 | Train PPL: 268.92
Valid Loss: 5.8296 | Valid PPL: 340.23
<> Saved new best model with validation loss: 5.8296
Epoch 38/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:25<00:00, 10.03it/s, loss=6.4307, ppl=620.60]
<> Validating...

<> Epoch 38 Results:
<>  Time: 0:00:26
Train Loss: 5.5778 | Train PPL: 264.50
Valid Loss: 5.8231 | Valid PPL: 338.02
<> Saved new best model with validation loss: 5.8231
Epoch 39/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:26<00:00,  9.68it/s, loss=6.4321, ppl=621.48]
<> Validating...

<> Epoch 39 Results:
<>  Time: 0:00:27
Train Loss: 5.5610 | Train PPL: 260.09
Valid Loss: 5.8134 | Valid PPL: 334.74
<> Saved new best model with validation loss: 5.8134
Epoch 40/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:25<00:00,  9.71it/s, loss=6.4278, ppl=618.79]
<> Validating...

<> Epoch 40 Results:
<>  Time: 0:00:26
Train Loss: 5.5437 | Train PPL: 255.63
Valid Loss: 5.8066 | Valid PPL: 332.49
<> Saved new best model with validation loss: 5.8066
Epoch 41/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:25<00:00, 10.06it/s, loss=6.4300, ppl=620.17]
<> Validating...

<> Epoch 41 Results:
<>  Time: 0:00:26
Train Loss: 5.5280 | Train PPL: 251.65
Valid Loss: 5.8042 | Valid PPL: 331.68
<> Saved new best model with validation loss: 5.8042
Epoch 42/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:25<00:00,  9.72it/s, loss=6.4227, ppl=615.68]
<> Validating...

<> Epoch 42 Results:
<>  Time: 0:00:26
Train Loss: 5.5117 | Train PPL: 247.58
Valid Loss: 5.7959 | Valid PPL: 328.95
<> Saved new best model with validation loss: 5.7959
Epoch 43/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:26<00:00,  9.64it/s, loss=6.4149, ppl=610.85]
<> Validating...

<> Epoch 43 Results:
<>  Time: 0:00:27
Train Loss: 5.4954 | Train PPL: 243.57
Valid Loss: 5.7913 | Valid PPL: 327.43
<> Saved new best model with validation loss: 5.7913
Epoch 44/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:24<00:00, 10.50it/s, loss=6.4138, ppl=610.22]
<> Validating...

<> Epoch 44 Results:
<>  Time: 0:00:24
Train Loss: 5.4795 | Train PPL: 239.73
Valid Loss: 5.7893 | Valid PPL: 326.80
<> Saved new best model with validation loss: 5.7893
Epoch 45/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:25<00:00,  9.76it/s, loss=6.4152, ppl=611.05]
<> Validating...

<> Epoch 45 Results:
<>  Time: 0:00:26
Train Loss: 5.4657 | Train PPL: 236.43
Valid Loss: 5.7849 | Valid PPL: 325.35
<> Saved new best model with validation loss: 5.7849
Epoch 46/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:26<00:00,  9.61it/s, loss=6.4160, ppl=611.55]
<> Validating...

<> Epoch 46 Results:
<>  Time: 0:00:27
Train Loss: 5.4514 | Train PPL: 233.08
Valid Loss: 5.7789 | Valid PPL: 323.41
<> Saved new best model with validation loss: 5.7789
Epoch 47/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:24<00:00, 10.33it/s, loss=6.4028, ppl=603.55]
<> Validating...

<> Epoch 47 Results:
<>  Time: 0:00:25
Train Loss: 5.4376 | Train PPL: 229.90
Valid Loss: 5.7729 | Valid PPL: 321.48
<> Saved new best model with validation loss: 5.7729
Epoch 48/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:25<00:00, 10.08it/s, loss=6.4127, ppl=609.57]
<> Validating...

<> Epoch 48 Results:
<>  Time: 0:00:25
Train Loss: 5.4237 | Train PPL: 226.72
Valid Loss: 5.7738 | Valid PPL: 321.77
<> No improvement for 1 epoch(s).
Epoch 49/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:24<00:00, 10.13it/s, loss=6.4110, ppl=608.49]
<> Validating...

<> Epoch 49 Results:
<>  Time: 0:00:25
Train Loss: 5.4105 | Train PPL: 223.75
Valid Loss: 5.7685 | Valid PPL: 320.04
<> Saved new best model with validation loss: 5.7685
Epoch 50/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:25<00:00, 10.08it/s, loss=6.4084, ppl=606.93]
<> Validating...

<> Epoch 50 Results:
<>  Time: 0:00:25
Train Loss: 5.3976 | Train PPL: 220.87
Valid Loss: 5.7633 | Valid PPL: 318.39
<> Saved new best model with validation loss: 5.7633
Epoch 51/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:24<00:00, 10.30it/s, loss=6.3946, ppl=598.59]
<> Validating...

<> Epoch 51 Results:
<>  Time: 0:00:25
Train Loss: 5.3842 | Train PPL: 217.93
Valid Loss: 5.7599 | Valid PPL: 317.32
<> Saved new best model with validation loss: 5.7599
Epoch 52/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:23<00:00, 10.53it/s, loss=6.4011, ppl=602.50]
<> Validating...

<> Epoch 52 Results:
<>  Time: 0:00:24
Train Loss: 5.3718 | Train PPL: 215.24
Valid Loss: 5.7538 | Valid PPL: 315.40
<> Saved new best model with validation loss: 5.7538
Epoch 53/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:24<00:00, 10.22it/s, loss=6.4017, ppl=602.87]
<> Validating...

<> Epoch 53 Results:
<>  Time: 0:00:25
Train Loss: 5.3607 | Train PPL: 212.87
Valid Loss: 5.7491 | Valid PPL: 313.91
<> Saved new best model with validation loss: 5.7491
Epoch 54/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:24<00:00, 10.31it/s, loss=6.3910, ppl=596.47]
<> Validating...

<> Epoch 54 Results:
<>  Time: 0:00:25
Train Loss: 5.3475 | Train PPL: 210.08
Valid Loss: 5.7442 | Valid PPL: 312.38
<> Saved new best model with validation loss: 5.7442
Epoch 55/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:24<00:00, 10.49it/s, loss=6.3978, ppl=600.52]
<> Validating...

<> Epoch 55 Results:
<>  Time: 0:00:24
Train Loss: 5.3362 | Train PPL: 207.71
Valid Loss: 5.7442 | Valid PPL: 312.37
<> Saved new best model with validation loss: 5.7442
Epoch 56/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:25<00:00,  9.96it/s, loss=6.3932, ppl=597.74]
<> Validating...

<> Epoch 56 Results:
<>  Time: 0:00:26
Train Loss: 5.3258 | Train PPL: 205.57
Valid Loss: 5.7427 | Valid PPL: 311.91
<> Saved new best model with validation loss: 5.7427
Epoch 57/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:24<00:00, 10.15it/s, loss=6.3981, ppl=600.72]
<> Validating...

<> Epoch 57 Results:
<>  Time: 0:00:25
Train Loss: 5.3159 | Train PPL: 203.54
Valid Loss: 5.7418 | Valid PPL: 311.62
<> Saved new best model with validation loss: 5.7418
Epoch 58/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:24<00:00, 10.21it/s, loss=6.3898, ppl=595.74]
<> Validating...

<> Epoch 58 Results:
<>  Time: 0:00:25
Train Loss: 5.3057 | Train PPL: 201.48
Valid Loss: 5.7416 | Valid PPL: 311.57
<> Saved new best model with validation loss: 5.7416
Epoch 59/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:24<00:00, 10.23it/s, loss=6.3820, ppl=591.12]
<> Validating...

<> Epoch 59 Results:
<>  Time: 0:00:25
Train Loss: 5.2963 | Train PPL: 199.60
Valid Loss: 5.7399 | Valid PPL: 311.03
<> Saved new best model with validation loss: 5.7399
Epoch 60/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:25<00:00,  9.75it/s, loss=6.3894, ppl=595.48]
<> Validating...

<> Epoch 60 Results:
<>  Time: 0:00:26
Train Loss: 5.2872 | Train PPL: 197.80
Valid Loss: 5.7388 | Valid PPL: 310.69
<> Saved new best model with validation loss: 5.7388
Epoch 61/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:25<00:00, 10.03it/s, loss=6.3850, ppl=592.90]
<> Validating...

<> Epoch 61 Results:
<>  Time: 0:00:26
Train Loss: 5.2795 | Train PPL: 196.27
Valid Loss: 5.7373 | Valid PPL: 310.24
<> Saved new best model with validation loss: 5.7373
Epoch 62/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:24<00:00, 10.31it/s, loss=6.3842, ppl=592.41]
<> Validating...

<> Epoch 62 Results:
<>  Time: 0:00:25
Train Loss: 5.2719 | Train PPL: 194.79
Valid Loss: 5.7365 | Valid PPL: 309.98
<> Saved new best model with validation loss: 5.7365
Epoch 63/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:24<00:00, 10.21it/s, loss=6.3872, ppl=594.19]
<> Validating...

<> Epoch 63 Results:
<>  Time: 0:00:25
Train Loss: 5.2636 | Train PPL: 193.17
Valid Loss: 5.7341 | Valid PPL: 309.24
<> Saved new best model with validation loss: 5.7341
Epoch 64/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:24<00:00, 10.42it/s, loss=6.3841, ppl=592.36]
<> Validating...

<> Epoch 64 Results:
<>  Time: 0:00:25
Train Loss: 5.2558 | Train PPL: 191.68
Valid Loss: 5.7296 | Valid PPL: 307.85
<> Saved new best model with validation loss: 5.7296
Epoch 65/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:24<00:00, 10.30it/s, loss=6.3856, ppl=593.27]
<> Validating...

<> Epoch 65 Results:
<>  Time: 0:00:25
Train Loss: 5.2483 | Train PPL: 190.24
Valid Loss: 5.7263 | Valid PPL: 306.84
<> Saved new best model with validation loss: 5.7263
Epoch 66/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:26<00:00,  9.35it/s, loss=6.3854, ppl=593.11]
<> Validating...

<> Epoch 66 Results:
<>  Time: 0:00:27
Train Loss: 5.2397 | Train PPL: 188.61
Valid Loss: 5.7239 | Valid PPL: 306.10
<> Saved new best model with validation loss: 5.7239
Epoch 67/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:25<00:00,  9.70it/s, loss=6.3738, ppl=586.27]
<> Validating...

<> Epoch 67 Results:
<>  Time: 0:00:26
Train Loss: 5.2317 | Train PPL: 187.12
Valid Loss: 5.7209 | Valid PPL: 305.17
<> Saved new best model with validation loss: 5.7209
Epoch 68/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:26<00:00,  9.61it/s, loss=6.3657, ppl=581.56]
<> Validating...

<> Epoch 68 Results:
<>  Time: 0:00:27
Train Loss: 5.2244 | Train PPL: 185.75
Valid Loss: 5.7181 | Valid PPL: 304.32
<> Saved new best model with validation loss: 5.7181
Epoch 69/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:27<00:00,  9.01it/s, loss=6.3669, ppl=582.27]
<> Validating...

<> Epoch 69 Results:
<>  Time: 0:00:28
Train Loss: 5.2164 | Train PPL: 184.26
Valid Loss: 5.7147 | Valid PPL: 303.29
<> Saved new best model with validation loss: 5.7147
Epoch 70/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:25<00:00, 10.02it/s, loss=6.3821, ppl=591.16]
<> Validating...

<> Epoch 70 Results:
<>  Time: 0:00:26
Train Loss: 5.2087 | Train PPL: 182.85
Valid Loss: 5.7136 | Valid PPL: 302.95
<> Saved new best model with validation loss: 5.7136
Epoch 71/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:25<00:00,  9.84it/s, loss=6.3622, ppl=579.54]
<> Validating...

<> Epoch 71 Results:
<>  Time: 0:00:26
Train Loss: 5.2011 | Train PPL: 181.46
Valid Loss: 5.7129 | Valid PPL: 302.74
<> Saved new best model with validation loss: 5.7129
Epoch 72/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:26<00:00,  9.67it/s, loss=6.3617, ppl=579.25]
<> Validating...

<> Epoch 72 Results:
<>  Time: 0:00:27
Train Loss: 5.1952 | Train PPL: 180.40
Valid Loss: 5.7136 | Valid PPL: 302.95
<> No improvement for 1 epoch(s).
Epoch 73/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:26<00:00,  9.60it/s, loss=6.3665, ppl=582.04]
<> Validating...

<> Epoch 73 Results:
<>  Time: 0:00:27
Train Loss: 5.1895 | Train PPL: 179.38
Valid Loss: 5.7109 | Valid PPL: 302.15
<> Saved new best model with validation loss: 5.7109
Epoch 74/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:26<00:00,  9.55it/s, loss=6.3671, ppl=582.39]
<> Validating...

<> Epoch 74 Results:
<>  Time: 0:00:27
Train Loss: 5.1837 | Train PPL: 178.34
Valid Loss: 5.7076 | Valid PPL: 301.13
<> Saved new best model with validation loss: 5.7076
Epoch 75/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:26<00:00,  9.42it/s, loss=6.3634, ppl=580.23]
<> Validating...

<> Epoch 75 Results:
<>  Time: 0:00:27
Train Loss: 5.1760 | Train PPL: 176.98
Valid Loss: 5.7055 | Valid PPL: 300.50
<> Saved new best model with validation loss: 5.7055
Epoch 76/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:26<00:00,  9.45it/s, loss=6.3651, ppl=581.21]
<> Validating...

<> Epoch 76 Results:
<>  Time: 0:00:27
Train Loss: 5.1702 | Train PPL: 175.95
Valid Loss: 5.7037 | Valid PPL: 299.97
<> Saved new best model with validation loss: 5.7037
Epoch 77/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:25<00:00,  9.72it/s, loss=6.3768, ppl=588.03]
<> Validating...

<> Epoch 77 Results:
<>  Time: 0:00:26
Train Loss: 5.1643 | Train PPL: 174.91
Valid Loss: 5.7029 | Valid PPL: 299.75
<> Saved new best model with validation loss: 5.7029
Epoch 78/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:25<00:00,  9.98it/s, loss=6.3790, ppl=589.34]
<> Validating...

<> Epoch 78 Results:
<>  Time: 0:00:26
Train Loss: 5.1587 | Train PPL: 173.93
Valid Loss: 5.7026 | Valid PPL: 299.65
<> Saved new best model with validation loss: 5.7026
Epoch 79/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:26<00:00,  9.43it/s, loss=6.3739, ppl=586.31]
<> Validating...

<> Epoch 79 Results:
<>  Time: 0:00:27
Train Loss: 5.1532 | Train PPL: 172.98
Valid Loss: 5.7014 | Valid PPL: 299.30
<> Saved new best model with validation loss: 5.7014
Epoch 80/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:25<00:00,  9.85it/s, loss=6.3777, ppl=588.59]
<> Validating...

<> Epoch 80 Results:
<>  Time: 0:00:26
Train Loss: 5.1484 | Train PPL: 172.16
Valid Loss: 5.7021 | Valid PPL: 299.51
<> No improvement for 1 epoch(s).
Epoch 81/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:25<00:00,  9.86it/s, loss=6.3777, ppl=588.58]
<> Validating...

<> Epoch 81 Results:
<>  Time: 0:00:26
Train Loss: 5.1440 | Train PPL: 171.40
Valid Loss: 5.7036 | Valid PPL: 299.95
<> No improvement for 2 epoch(s).
Epoch 82/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:26<00:00,  9.66it/s, loss=6.3810, ppl=590.50]
<> Validating...

<> Epoch 82 Results:
<>  Time: 0:00:27
Train Loss: 5.1387 | Train PPL: 170.50
Valid Loss: 5.7037 | Valid PPL: 299.98
<> No improvement for 3 epoch(s).
Epoch 83/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:25<00:00,  9.82it/s, loss=6.3769, ppl=588.10]
<> Validating...

<> Epoch 83 Results:
<>  Time: 0:00:26
Train Loss: 5.1353 | Train PPL: 169.91
Valid Loss: 5.7039 | Valid PPL: 300.05
<> No improvement for 4 epoch(s).
Epoch 84/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:26<00:00,  9.63it/s, loss=6.3857, ppl=593.31]
<> Validating...

<> Epoch 84 Results:
<>  Time: 0:00:27
Train Loss: 5.1306 | Train PPL: 169.11
Valid Loss: 5.7037 | Valid PPL: 299.97
<> No improvement for 5 epoch(s).
Epoch 85/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:26<00:00,  9.52it/s, loss=6.3914, ppl=596.68]
<> Validating...

<> Epoch 85 Results:
<>  Time: 0:00:27
Train Loss: 5.1267 | Train PPL: 168.46
Valid Loss: 5.7042 | Valid PPL: 300.14
<> No improvement for 6 epoch(s).
Epoch 86/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:26<00:00,  9.52it/s, loss=6.3763, ppl=587.77]
<> Validating...

<> Epoch 86 Results:
<>  Time: 0:00:27
Train Loss: 5.1229 | Train PPL: 167.82
Valid Loss: 5.7032 | Valid PPL: 299.81
<> No improvement for 7 epoch(s).
Epoch 87/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:26<00:00,  9.63it/s, loss=6.3820, ppl=591.13]
<> Validating...

<> Epoch 87 Results:
<>  Time: 0:00:27
Train Loss: 5.1193 | Train PPL: 167.21
Valid Loss: 5.7029 | Valid PPL: 299.73
<> No improvement for 8 epoch(s).
Epoch 88/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:25<00:00,  9.72it/s, loss=6.3888, ppl=595.15]
<> Validating...

<> Epoch 88 Results:
<>  Time: 0:00:26
Train Loss: 5.1165 | Train PPL: 166.76
Valid Loss: 5.7028 | Valid PPL: 299.70
<> No improvement for 9 epoch(s).
Epoch 89/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:26<00:00,  9.36it/s, loss=6.3795, ppl=589.63]
<> Validating...

<> Epoch 89 Results:
<>  Time: 0:00:27
Train Loss: 5.1136 | Train PPL: 166.27
Valid Loss: 5.7014 | Valid PPL: 299.27
<> Saved new best model with validation loss: 5.7014
Epoch 90/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:26<00:00,  9.34it/s, loss=6.3944, ppl=598.46]
<> Validating...

<> Epoch 90 Results:
<>  Time: 0:00:28
Train Loss: 5.1093 | Train PPL: 165.55
Valid Loss: 5.7012 | Valid PPL: 299.24
<> Saved new best model with validation loss: 5.7012
Epoch 91/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:26<00:00,  9.59it/s, loss=6.3846, ppl=592.65]
<> Validating...

<> Epoch 91 Results:
<>  Time: 0:00:27
Train Loss: 5.1071 | Train PPL: 165.18
Valid Loss: 5.7004 | Valid PPL: 298.98
<> Saved new best model with validation loss: 5.7004
Epoch 92/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:25<00:00,  9.99it/s, loss=6.3888, ppl=595.15]
<> Validating...

<> Epoch 92 Results:
<>  Time: 0:00:26
Train Loss: 5.1050 | Train PPL: 164.84
Valid Loss: 5.7003 | Valid PPL: 298.96
<> Saved new best model with validation loss: 5.7003
Epoch 93/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:27<00:00,  9.14it/s, loss=6.3731, ppl=585.89]
<> Validating...

<> Epoch 93 Results:
<>  Time: 0:00:28
Train Loss: 5.1018 | Train PPL: 164.32
Valid Loss: 5.6996 | Valid PPL: 298.74
<> Saved new best model with validation loss: 5.6996
Epoch 94/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:27<00:00,  9.29it/s, loss=6.3834, ppl=591.95]
<> Validating...

<> Epoch 94 Results:
<>  Time: 0:00:28
Train Loss: 5.0979 | Train PPL: 163.68
Valid Loss: 5.7004 | Valid PPL: 298.99
<> No improvement for 1 epoch(s).
Epoch 95/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:26<00:00,  9.36it/s, loss=6.3712, ppl=584.77]
<> Validating...

<> Epoch 95 Results:
<>  Time: 0:00:27
Train Loss: 5.0968 | Train PPL: 163.49
Valid Loss: 5.6999 | Valid PPL: 298.85
<> No improvement for 2 epoch(s).
Epoch 96/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:26<00:00,  9.42it/s, loss=6.3723, ppl=585.38]
<> Validating...

<> Epoch 96 Results:
<>  Time: 0:00:27
Train Loss: 5.0942 | Train PPL: 163.07
Valid Loss: 5.6994 | Valid PPL: 298.69
<> Saved new best model with validation loss: 5.6994
Epoch 97/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:26<00:00,  9.51it/s, loss=6.3911, ppl=596.54]
<> Validating...

<> Epoch 97 Results:
<>  Time: 0:00:27
Train Loss: 5.0923 | Train PPL: 162.76
Valid Loss: 5.6989 | Valid PPL: 298.55
<> Saved new best model with validation loss: 5.6989
Epoch 98/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:26<00:00,  9.47it/s, loss=6.3916, ppl=596.79]
<> Validating...

<> Epoch 98 Results:
<>  Time: 0:00:27
Train Loss: 5.0907 | Train PPL: 162.51
Valid Loss: 5.6984 | Valid PPL: 298.40
<> Saved new best model with validation loss: 5.6984
Epoch 99/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:26<00:00,  9.41it/s, loss=6.3768, ppl=588.03]
<> Validating...

<> Epoch 99 Results:
<>  Time: 0:00:27
Train Loss: 5.0888 | Train PPL: 162.19
Valid Loss: 5.6980 | Valid PPL: 298.27
<> Saved new best model with validation loss: 5.6980
Epoch 100/100: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 252/252 [00:27<00:00,  9.23it/s, loss=6.3858, ppl=593.38]
<> Validating...

<> Epoch 100 Results:
<>  Time: 0:00:28
Train Loss: 5.0869 | Train PPL: 161.89
Valid Loss: 5.6974 | Valid PPL: 298.09
<> Saved new best model with validation loss: 5.6974

==================================================
<> Training Complete!
==================================================
Best validation loss: 5.6974
Total time: 0:44:05

<> Loading Best Model for Evaluation...

==================================================
<> FINAL TEST EVALUATION
==================================================
Testing: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 29/29 [00:02<00:00, 13.66it/s]
>> Final Test Loss: 4.7943
>> Final Test Perplexity: 120.82
==================================================