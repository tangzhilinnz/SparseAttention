==================================================
<> Training Transformer Model (AMP Enabled)
==================================================
/home/ztang13/workspace/SparseAttention/myenv/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/home/ztang13/workspace/SparseAttention/hierarchical_attention_project/Hierarchical_transformer_Triton_WikiText2.py:380: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler()
Epoch 1/100:   0%|                                                                                                                                                                                             | 0/504 [00:00<?, ?it/s]/home/ztang13/workspace/SparseAttention/hierarchical_attention_project/Hierarchical_transformer_Triton_WikiText2.py:412: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Epoch 1/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [00:51<00:00,  9.75it/s, loss=7.2344, ppl=1386.29]
<> Validating...
/home/ztang13/workspace/SparseAttention/hierarchical_attention_project/Hierarchical_transformer_Triton_WikiText2.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():

<> Epoch 1 Results:
<>  Time: 0:00:53
Train Loss: 7.8063 | Train PPL: 2455.96
Valid Loss: 7.0201 | Valid PPL: 1118.91
<> Saved new best model with validation loss: 7.0201
Epoch 2/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [00:51<00:00,  9.85it/s, loss=6.9872, ppl=1082.71]
<> Validating...

<> Epoch 2 Results:
<>  Time: 0:00:52
Train Loss: 7.1128 | Train PPL: 1227.62
Valid Loss: 6.7230 | Valid PPL: 831.31
<> Saved new best model with validation loss: 6.7230
Epoch 3/100: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [01:02<00:00,  8.06it/s, loss=6.8209, ppl=916.83]
<> Validating...

<> Epoch 3 Results:
<>  Time: 0:01:04
Train Loss: 6.8566 | Train PPL: 950.09
Valid Loss: 6.5363 | Valid PPL: 689.75
<> Saved new best model with validation loss: 6.5363
Epoch 4/100: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [01:04<00:00,  7.78it/s, loss=6.7096, ppl=820.24]
<> Validating...

<> Epoch 4 Results:
<>  Time: 0:01:06
Train Loss: 6.6843 | Train PPL: 799.76
Valid Loss: 6.4383 | Valid PPL: 625.33
<> Saved new best model with validation loss: 6.4383
Epoch 5/100: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [00:55<00:00,  9.10it/s, loss=6.6098, ppl=742.35]
<> Validating...

<> Epoch 5 Results:
<>  Time: 0:00:57
Train Loss: 6.5652 | Train PPL: 709.97
Valid Loss: 6.3701 | Valid PPL: 584.09
<> Saved new best model with validation loss: 6.3701
Epoch 6/100: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [00:53<00:00,  9.47it/s, loss=6.5274, ppl=683.63]
<> Validating...

<> Epoch 6 Results:
<>  Time: 0:00:54
Train Loss: 6.4671 | Train PPL: 643.60
Valid Loss: 6.3037 | Valid PPL: 546.59
<> Saved new best model with validation loss: 6.3037
Epoch 7/100: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [00:56<00:00,  8.87it/s, loss=6.4560, ppl=636.52]
<> Validating...

<> Epoch 7 Results:
<>  Time: 0:00:58
Train Loss: 6.3811 | Train PPL: 590.57
Valid Loss: 6.2327 | Valid PPL: 509.14
<> Saved new best model with validation loss: 6.2327
Epoch 8/100: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [00:52<00:00,  9.63it/s, loss=6.3980, ppl=600.64]
<> Validating...

<> Epoch 8 Results:
<>  Time: 0:00:54
Train Loss: 6.2966 | Train PPL: 542.72
Valid Loss: 6.1776 | Valid PPL: 481.84
<> Saved new best model with validation loss: 6.1776
Epoch 9/100: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [00:54<00:00,  9.19it/s, loss=6.3438, ppl=568.93]
<> Validating...

<> Epoch 9 Results:
<>  Time: 0:00:56
Train Loss: 6.2210 | Train PPL: 503.22
Valid Loss: 6.1318 | Valid PPL: 460.29
<> Saved new best model with validation loss: 6.1318
Epoch 10/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [00:58<00:00,  8.58it/s, loss=6.2998, ppl=544.45]
<> Validating...

<> Epoch 10 Results:
<>  Time: 0:01:00
Train Loss: 6.1549 | Train PPL: 471.03
Valid Loss: 6.0964 | Valid PPL: 444.26
<> Saved new best model with validation loss: 6.0964
Epoch 11/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [01:03<00:00,  7.97it/s, loss=6.2451, ppl=515.48]
<> Validating...

<> Epoch 11 Results:
<>  Time: 0:01:04
Train Loss: 6.0963 | Train PPL: 444.19
Valid Loss: 6.0659 | Valid PPL: 430.92
<> Saved new best model with validation loss: 6.0659
Epoch 12/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [00:51<00:00,  9.88it/s, loss=6.2357, ppl=510.67]
<> Validating...

<> Epoch 12 Results:
<>  Time: 0:00:52
Train Loss: 6.0435 | Train PPL: 421.38
Valid Loss: 6.0421 | Valid PPL: 420.78
<> Saved new best model with validation loss: 6.0421
Epoch 13/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [00:54<00:00,  9.22it/s, loss=6.1849, ppl=485.38]
<> Validating...

<> Epoch 13 Results:
<>  Time: 0:00:56
Train Loss: 6.0042 | Train PPL: 405.15
Valid Loss: 5.9985 | Valid PPL: 402.82
<> Saved new best model with validation loss: 5.9985
Epoch 14/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [00:50<00:00, 10.06it/s, loss=6.1692, ppl=477.80]
<> Validating...

<> Epoch 14 Results:
<>  Time: 0:00:51
Train Loss: 5.9581 | Train PPL: 386.87
Valid Loss: 5.9681 | Valid PPL: 390.78
<> Saved new best model with validation loss: 5.9681
Epoch 15/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [01:06<00:00,  7.62it/s, loss=6.1196, ppl=454.71]
<> Validating...

<> Epoch 15 Results:
<>  Time: 0:01:07
Train Loss: 5.9145 | Train PPL: 370.37
Valid Loss: 5.9421 | Valid PPL: 380.72
<> Saved new best model with validation loss: 5.9421
Epoch 16/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [00:49<00:00, 10.13it/s, loss=6.0937, ppl=443.04]
<> Validating...

<> Epoch 16 Results:
<>  Time: 0:00:51
Train Loss: 5.8738 | Train PPL: 355.61
Valid Loss: 5.9229 | Valid PPL: 373.50
<> Saved new best model with validation loss: 5.9229
Epoch 17/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [00:57<00:00,  8.79it/s, loss=6.0687, ppl=432.11]
<> Validating...

<> Epoch 17 Results:
<>  Time: 0:00:59
Train Loss: 5.8350 | Train PPL: 342.08
Valid Loss: 5.9029 | Valid PPL: 366.11
<> Saved new best model with validation loss: 5.9029
Epoch 18/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [00:47<00:00, 10.65it/s, loss=6.0325, ppl=416.77]
<> Validating...

<> Epoch 18 Results:
<>  Time: 0:00:49
Train Loss: 5.7963 | Train PPL: 329.08
Valid Loss: 5.8844 | Valid PPL: 359.37
<> Saved new best model with validation loss: 5.8844
Epoch 19/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [01:01<00:00,  8.13it/s, loss=5.9958, ppl=401.75]
<> Validating...

<> Epoch 19 Results:
<>  Time: 0:01:03
Train Loss: 5.7606 | Train PPL: 317.55
Valid Loss: 5.8671 | Valid PPL: 353.22
<> Saved new best model with validation loss: 5.8671
Epoch 20/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [00:57<00:00,  8.83it/s, loss=5.9647, ppl=389.43]
<> Validating...

<> Epoch 20 Results:
<>  Time: 0:00:58
Train Loss: 5.7261 | Train PPL: 306.76
Valid Loss: 5.8516 | Valid PPL: 347.79
<> Saved new best model with validation loss: 5.8516
Epoch 21/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [00:45<00:00, 11.00it/s, loss=5.9434, ppl=381.22]
<> Validating...

<> Epoch 21 Results:
<>  Time: 0:00:47
Train Loss: 5.6930 | Train PPL: 296.78
Valid Loss: 5.8382 | Valid PPL: 343.16
<> Saved new best model with validation loss: 5.8382
Epoch 22/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [00:55<00:00,  9.12it/s, loss=5.9177, ppl=371.55]
<> Validating...

<> Epoch 22 Results:
<>  Time: 0:00:57
Train Loss: 5.6628 | Train PPL: 287.95
Valid Loss: 5.8292 | Valid PPL: 340.10
<> Saved new best model with validation loss: 5.8292
Epoch 23/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [00:52<00:00,  9.60it/s, loss=5.8902, ppl=361.49]
<> Validating...

<> Epoch 23 Results:
<>  Time: 0:00:54
Train Loss: 5.6348 | Train PPL: 280.00
Valid Loss: 5.8172 | Valid PPL: 336.03
<> Saved new best model with validation loss: 5.8172
Epoch 24/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [00:53<00:00,  9.51it/s, loss=5.8600, ppl=350.73]
<> Validating...

<> Epoch 24 Results:
<>  Time: 0:00:54
Train Loss: 5.6040 | Train PPL: 271.50
Valid Loss: 5.8107 | Valid PPL: 333.86
<> Saved new best model with validation loss: 5.8107
Epoch 25/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [00:50<00:00, 10.02it/s, loss=5.8359, ppl=342.39]
<> Validating...

<> Epoch 25 Results:
<>  Time: 0:00:51
Train Loss: 5.5736 | Train PPL: 263.38
Valid Loss: 5.8038 | Valid PPL: 331.54
<> Saved new best model with validation loss: 5.8038
Epoch 26/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [00:53<00:00,  9.49it/s, loss=5.8149, ppl=335.25]
<> Validating...

<> Epoch 26 Results:
<>  Time: 0:00:54
Train Loss: 5.5462 | Train PPL: 256.25
Valid Loss: 5.7983 | Valid PPL: 329.74
<> Saved new best model with validation loss: 5.7983
Epoch 27/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [00:58<00:00,  8.67it/s, loss=5.7730, ppl=321.51]
<> Validating...

<> Epoch 27 Results:
<>  Time: 0:00:59
Train Loss: 5.5193 | Train PPL: 249.46
Valid Loss: 5.7901 | Valid PPL: 327.04
<> Saved new best model with validation loss: 5.7901
Epoch 28/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [00:54<00:00,  9.18it/s, loss=5.7642, ppl=318.68]
<> Validating...

<> Epoch 28 Results:
<>  Time: 0:00:56
Train Loss: 5.4935 | Train PPL: 243.12
Valid Loss: 5.7805 | Valid PPL: 323.93
<> Saved new best model with validation loss: 5.7805
Epoch 29/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [00:48<00:00, 10.46it/s, loss=5.7414, ppl=311.49]
<> Validating...

<> Epoch 29 Results:
<>  Time: 0:00:49
Train Loss: 5.4691 | Train PPL: 237.25
Valid Loss: 5.7722 | Valid PPL: 321.24
<> Saved new best model with validation loss: 5.7722
Epoch 30/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [00:59<00:00,  8.50it/s, loss=5.7218, ppl=305.44]
<> Validating...

<> Epoch 30 Results:
<>  Time: 0:01:00
Train Loss: 5.4455 | Train PPL: 231.71
Valid Loss: 5.7639 | Valid PPL: 318.59
<> Saved new best model with validation loss: 5.7639
Epoch 31/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [00:57<00:00,  8.81it/s, loss=5.6922, ppl=296.54]
<> Validating...

<> Epoch 31 Results:
<>  Time: 0:00:58
Train Loss: 5.4232 | Train PPL: 226.61
Valid Loss: 5.7635 | Valid PPL: 318.47
<> Saved new best model with validation loss: 5.7635
Epoch 32/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [01:11<00:00,  7.09it/s, loss=5.6610, ppl=287.45]
<> Validating...

<> Epoch 32 Results:
<>  Time: 0:01:12
Train Loss: 5.4016 | Train PPL: 221.75
Valid Loss: 5.7615 | Valid PPL: 317.84
<> Saved new best model with validation loss: 5.7615
Epoch 33/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [01:06<00:00,  7.63it/s, loss=5.6451, ppl=282.89]
<> Validating...

<> Epoch 33 Results:
<>  Time: 0:01:07
Train Loss: 5.3796 | Train PPL: 216.93
Valid Loss: 5.7540 | Valid PPL: 315.46
<> Saved new best model with validation loss: 5.7540
Epoch 34/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [00:56<00:00,  8.88it/s, loss=5.6352, ppl=280.11]
<> Validating...

<> Epoch 34 Results:
<>  Time: 0:00:58
Train Loss: 5.3580 | Train PPL: 212.29
Valid Loss: 5.7467 | Valid PPL: 313.16
<> Saved new best model with validation loss: 5.7467
Epoch 35/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [00:56<00:00,  8.94it/s, loss=5.6026, ppl=271.13]
<> Validating...

<> Epoch 35 Results:
<>  Time: 0:00:58
Train Loss: 5.3376 | Train PPL: 208.01
Valid Loss: 5.7416 | Valid PPL: 311.57
<> Saved new best model with validation loss: 5.7416
Epoch 36/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [00:53<00:00,  9.49it/s, loss=5.5931, ppl=268.58]
<> Validating...

<> Epoch 36 Results:
<>  Time: 0:00:54
Train Loss: 5.3172 | Train PPL: 203.82
Valid Loss: 5.7360 | Valid PPL: 309.81
<> Saved new best model with validation loss: 5.7360
Epoch 37/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [00:57<00:00,  8.81it/s, loss=5.5779, ppl=264.51]
<> Validating...

<> Epoch 37 Results:
<>  Time: 0:00:58
Train Loss: 5.2972 | Train PPL: 199.78
Valid Loss: 5.7284 | Valid PPL: 307.46
<> Saved new best model with validation loss: 5.7284
Epoch 38/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [00:55<00:00,  9.14it/s, loss=5.5547, ppl=258.44]
<> Validating...

<> Epoch 38 Results:
<>  Time: 0:00:56
Train Loss: 5.2776 | Train PPL: 195.91
Valid Loss: 5.7271 | Valid PPL: 307.09
<> Saved new best model with validation loss: 5.7271
Epoch 39/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [00:54<00:00,  9.29it/s, loss=5.5411, ppl=254.97]
<> Validating...

<> Epoch 39 Results:
<>  Time: 0:00:55
Train Loss: 5.2600 | Train PPL: 192.49
Valid Loss: 5.7251 | Valid PPL: 306.45
<> Saved new best model with validation loss: 5.7251
Epoch 40/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [00:50<00:00, 10.00it/s, loss=5.5144, ppl=248.24]
<> Validating...

<> Epoch 40 Results:
<>  Time: 0:00:52
Train Loss: 5.2417 | Train PPL: 189.00
Valid Loss: 5.7251 | Valid PPL: 306.45
<> Saved new best model with validation loss: 5.7251
Epoch 41/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [00:49<00:00, 10.09it/s, loss=5.5005, ppl=244.82]
<> Validating...

<> Epoch 41 Results:
<>  Time: 0:00:51
Train Loss: 5.2238 | Train PPL: 185.64
Valid Loss: 5.7214 | Valid PPL: 305.34
<> Saved new best model with validation loss: 5.7214
Epoch 42/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [00:56<00:00,  8.93it/s, loss=5.4701, ppl=237.49]
<> Validating...

<> Epoch 42 Results:
<>  Time: 0:00:58
Train Loss: 5.2073 | Train PPL: 182.61
Valid Loss: 5.7195 | Valid PPL: 304.74
<> Saved new best model with validation loss: 5.7195
Epoch 43/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [00:48<00:00, 10.48it/s, loss=5.4606, ppl=235.24]
<> Validating...

<> Epoch 43 Results:
<>  Time: 0:00:49
Train Loss: 5.1916 | Train PPL: 179.75
Valid Loss: 5.7148 | Valid PPL: 303.32
<> Saved new best model with validation loss: 5.7148
Epoch 44/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [00:50<00:00,  9.93it/s, loss=5.4422, ppl=230.96]
<> Validating...

<> Epoch 44 Results:
<>  Time: 0:00:52
Train Loss: 5.1766 | Train PPL: 177.07
Valid Loss: 5.7106 | Valid PPL: 302.04
<> Saved new best model with validation loss: 5.7106
Epoch 45/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [00:53<00:00,  9.48it/s, loss=5.4313, ppl=228.44]
<> Validating...

<> Epoch 45 Results:
<>  Time: 0:00:54
Train Loss: 5.1619 | Train PPL: 174.50
Valid Loss: 5.7071 | Valid PPL: 301.00
<> Saved new best model with validation loss: 5.7071
Epoch 46/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [00:51<00:00,  9.88it/s, loss=5.4155, ppl=224.86]
<> Validating...

<> Epoch 46 Results:
<>  Time: 0:00:52
Train Loss: 5.1477 | Train PPL: 172.04
Valid Loss: 5.7050 | Valid PPL: 300.36
<> Saved new best model with validation loss: 5.7050
Epoch 47/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [00:51<00:00,  9.84it/s, loss=5.3990, ppl=221.18]
<> Validating...

<> Epoch 47 Results:
<>  Time: 0:00:52
Train Loss: 5.1333 | Train PPL: 169.57
Valid Loss: 5.7056 | Valid PPL: 300.55
<> No improvement for 1 epoch(s).
Epoch 48/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [00:53<00:00,  9.50it/s, loss=5.3961, ppl=220.54]
<> Validating...

<> Epoch 48 Results:
<>  Time: 0:00:54
Train Loss: 5.1203 | Train PPL: 167.38
Valid Loss: 5.7033 | Valid PPL: 299.86
<> Saved new best model with validation loss: 5.7033
Epoch 49/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [00:52<00:00,  9.62it/s, loss=5.3641, ppl=213.59]
<> Validating...

<> Epoch 49 Results:
<>  Time: 0:00:54
Train Loss: 5.1062 | Train PPL: 165.05
Valid Loss: 5.7061 | Valid PPL: 300.69
<> No improvement for 1 epoch(s).
Epoch 50/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [00:54<00:00,  9.21it/s, loss=5.3597, ppl=212.65]
<> Validating...

<> Epoch 50 Results:
<>  Time: 0:00:56
Train Loss: 5.0938 | Train PPL: 163.01
Valid Loss: 5.7088 | Valid PPL: 301.50
<> No improvement for 2 epoch(s).
Epoch 51/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [00:55<00:00,  9.04it/s, loss=5.3207, ppl=204.52]
<> Validating...

<> Epoch 51 Results:
<>  Time: 0:00:57
Train Loss: 5.0811 | Train PPL: 160.96
Valid Loss: 5.7114 | Valid PPL: 302.30
<> No improvement for 3 epoch(s).
Epoch 52/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [00:56<00:00,  8.92it/s, loss=5.3214, ppl=204.66]
<> Validating...

<> Epoch 52 Results:
<>  Time: 0:00:58
Train Loss: 5.0688 | Train PPL: 158.99
Valid Loss: 5.7144 | Valid PPL: 303.19
<> No improvement for 4 epoch(s).
Epoch 53/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [00:54<00:00,  9.26it/s, loss=5.2911, ppl=198.57]
<> Validating...

<> Epoch 53 Results:
<>  Time: 0:00:56
Train Loss: 5.0573 | Train PPL: 157.16
Valid Loss: 5.7122 | Valid PPL: 302.53
<> No improvement for 5 epoch(s).
Epoch 54/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [00:59<00:00,  8.42it/s, loss=5.2946, ppl=199.26]
<> Validating...

<> Epoch 54 Results:
<>  Time: 0:01:01
Train Loss: 5.0459 | Train PPL: 155.38
Valid Loss: 5.7134 | Valid PPL: 302.89
<> No improvement for 6 epoch(s).
Epoch 55/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [00:50<00:00,  9.90it/s, loss=5.2762, ppl=195.62]
<> Validating...

<> Epoch 55 Results:
<>  Time: 0:00:52
Train Loss: 5.0351 | Train PPL: 153.72
Valid Loss: 5.7103 | Valid PPL: 301.95
<> No improvement for 7 epoch(s).
Epoch 56/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [00:51<00:00,  9.87it/s, loss=5.2677, ppl=193.96]
<> Validating...

<> Epoch 56 Results:
<>  Time: 0:00:52
Train Loss: 5.0244 | Train PPL: 152.09
Valid Loss: 5.7076 | Valid PPL: 301.16
<> No improvement for 8 epoch(s).
Epoch 57/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [01:05<00:00,  7.64it/s, loss=5.2534, ppl=191.21]
<> Validating...

<> Epoch 57 Results:
<>  Time: 0:01:07
Train Loss: 5.0135 | Train PPL: 150.43
Valid Loss: 5.7048 | Valid PPL: 300.29
<> No improvement for 9 epoch(s).
Epoch 58/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [00:57<00:00,  8.73it/s, loss=5.2478, ppl=190.14]
<> Validating...

<> Epoch 58 Results:
<>  Time: 0:00:59
Train Loss: 5.0050 | Train PPL: 149.15
Valid Loss: 5.7035 | Valid PPL: 299.92
<> No improvement for 10 epoch(s).
Epoch 59/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [00:53<00:00,  9.41it/s, loss=5.2358, ppl=187.88]
<> Validating...

<> Epoch 59 Results:
<>  Time: 0:00:55
Train Loss: 4.9951 | Train PPL: 147.69
Valid Loss: 5.7011 | Valid PPL: 299.18
<> Saved new best model with validation loss: 5.7011
Epoch 60/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [00:49<00:00, 10.13it/s, loss=5.2228, ppl=185.45]
<> Validating...

<> Epoch 60 Results:
<>  Time: 0:00:51
Train Loss: 4.9869 | Train PPL: 146.48
Valid Loss: 5.6980 | Valid PPL: 298.28
<> Saved new best model with validation loss: 5.6980
Epoch 61/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [00:52<00:00,  9.62it/s, loss=5.2214, ppl=185.19]
<> Validating...

<> Epoch 61 Results:
<>  Time: 0:00:54
Train Loss: 4.9789 | Train PPL: 145.32
Valid Loss: 5.6976 | Valid PPL: 298.14
<> Saved new best model with validation loss: 5.6976
Epoch 62/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [00:51<00:00,  9.71it/s, loss=5.2187, ppl=184.70]
<> Validating...

<> Epoch 62 Results:
<>  Time: 0:00:53
Train Loss: 4.9707 | Train PPL: 144.13
Valid Loss: 5.6950 | Valid PPL: 297.38
<> Saved new best model with validation loss: 5.6950
Epoch 63/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [00:54<00:00,  9.21it/s, loss=5.1898, ppl=179.43]
<> Validating...

<> Epoch 63 Results:
<>  Time: 0:00:56
Train Loss: 4.9624 | Train PPL: 142.94
Valid Loss: 5.6943 | Valid PPL: 297.18
<> Saved new best model with validation loss: 5.6943
Epoch 64/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [00:52<00:00,  9.55it/s, loss=5.1887, ppl=179.23]
<> Validating...

<> Epoch 64 Results:
<>  Time: 0:00:54
Train Loss: 4.9547 | Train PPL: 141.84
Valid Loss: 5.6949 | Valid PPL: 297.36
<> No improvement for 1 epoch(s).
Epoch 65/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [00:57<00:00,  8.79it/s, loss=5.1981, ppl=180.94]
<> Validating...

<> Epoch 65 Results:
<>  Time: 0:00:59
Train Loss: 4.9477 | Train PPL: 140.85
Valid Loss: 5.6942 | Valid PPL: 297.13
<> Saved new best model with validation loss: 5.6942
Epoch 66/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [00:54<00:00,  9.31it/s, loss=5.1844, ppl=178.46]
<> Validating...

<> Epoch 66 Results:
<>  Time: 0:00:55
Train Loss: 4.9407 | Train PPL: 139.87
Valid Loss: 5.6941 | Valid PPL: 297.12
<> Saved new best model with validation loss: 5.6941
Epoch 67/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [00:56<00:00,  9.00it/s, loss=5.1759, ppl=176.95]
<> Validating...

<> Epoch 67 Results:
<>  Time: 0:00:57
Train Loss: 4.9332 | Train PPL: 138.82
Valid Loss: 5.6932 | Valid PPL: 296.85
<> Saved new best model with validation loss: 5.6932
Epoch 68/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [00:58<00:00,  8.68it/s, loss=5.1559, ppl=173.45]
<> Validating...

<> Epoch 68 Results:
<>  Time: 0:00:59
Train Loss: 4.9260 | Train PPL: 137.83
Valid Loss: 5.6944 | Valid PPL: 297.19
<> No improvement for 1 epoch(s).
Epoch 69/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [00:55<00:00,  9.12it/s, loss=5.1319, ppl=169.34]
<> Validating...

<> Epoch 69 Results:
<>  Time: 0:00:56
Train Loss: 4.9209 | Train PPL: 137.12
Valid Loss: 5.6925 | Valid PPL: 296.63
<> Saved new best model with validation loss: 5.6925
Epoch 70/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [01:09<00:00,  7.24it/s, loss=5.1364, ppl=170.10]
<> Validating...

<> Epoch 70 Results:
<>  Time: 0:01:11
Train Loss: 4.9151 | Train PPL: 136.34
Valid Loss: 5.6933 | Valid PPL: 296.88
<> No improvement for 1 epoch(s).
Epoch 71/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [00:53<00:00,  9.47it/s, loss=5.1359, ppl=170.01]
<> Validating...

<> Epoch 71 Results:
<>  Time: 0:00:54
Train Loss: 4.9093 | Train PPL: 135.54
Valid Loss: 5.6937 | Valid PPL: 296.98
<> No improvement for 2 epoch(s).
Epoch 72/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [01:05<00:00,  7.68it/s, loss=5.1303, ppl=169.07]
<> Validating...

<> Epoch 72 Results:
<>  Time: 0:01:07
Train Loss: 4.9055 | Train PPL: 135.03
Valid Loss: 5.6935 | Valid PPL: 296.92
<> No improvement for 3 epoch(s).
Epoch 73/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [00:54<00:00,  9.28it/s, loss=5.1401, ppl=170.73]
<> Validating...

<> Epoch 73 Results:
<>  Time: 0:00:56
Train Loss: 4.8996 | Train PPL: 134.23
Valid Loss: 5.6940 | Valid PPL: 297.09
<> No improvement for 4 epoch(s).
Epoch 74/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [01:09<00:00,  7.27it/s, loss=5.1282, ppl=168.72]
<> Validating...

<> Epoch 74 Results:
<>  Time: 0:01:11
Train Loss: 4.8946 | Train PPL: 133.57
Valid Loss: 5.6947 | Valid PPL: 297.30
<> No improvement for 5 epoch(s).
Epoch 75/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [00:55<00:00,  9.16it/s, loss=5.1359, ppl=170.01]
<> Validating...

<> Epoch 75 Results:
<>  Time: 0:00:56
Train Loss: 4.8899 | Train PPL: 132.94
Valid Loss: 5.6940 | Valid PPL: 297.07
<> No improvement for 6 epoch(s).
Epoch 76/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [01:14<00:00,  6.79it/s, loss=5.1152, ppl=166.54]
<> Validating...

<> Epoch 76 Results:
<>  Time: 0:01:15
Train Loss: 4.8870 | Train PPL: 132.55
Valid Loss: 5.6937 | Valid PPL: 296.98
<> No improvement for 7 epoch(s).
Epoch 77/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [01:02<00:00,  8.09it/s, loss=5.1154, ppl=166.56]
<> Validating...

<> Epoch 77 Results:
<>  Time: 0:01:04
Train Loss: 4.8828 | Train PPL: 132.00
Valid Loss: 5.6927 | Valid PPL: 296.71
<> No improvement for 8 epoch(s).
Epoch 78/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [00:52<00:00,  9.65it/s, loss=5.1185, ppl=167.08]
<> Validating...

<> Epoch 78 Results:
<>  Time: 0:00:53
Train Loss: 4.8796 | Train PPL: 131.58
Valid Loss: 5.6911 | Valid PPL: 296.23
<> Saved new best model with validation loss: 5.6911
Epoch 79/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [00:54<00:00,  9.21it/s, loss=5.1055, ppl=164.92]
<> Validating...

<> Epoch 79 Results:
<>  Time: 0:00:56
Train Loss: 4.8762 | Train PPL: 131.13
Valid Loss: 5.6919 | Valid PPL: 296.46
<> No improvement for 1 epoch(s).
Epoch 80/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [00:54<00:00,  9.24it/s, loss=5.1097, ppl=165.62]
<> Validating...

<> Epoch 80 Results:
<>  Time: 0:00:56
Train Loss: 4.8729 | Train PPL: 130.70
Valid Loss: 5.6902 | Valid PPL: 295.96
<> Saved new best model with validation loss: 5.6902
Epoch 81/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [00:51<00:00,  9.85it/s, loss=5.0993, ppl=163.91]
<> Validating...

<> Epoch 81 Results:
<>  Time: 0:00:52
Train Loss: 4.8698 | Train PPL: 130.29
Valid Loss: 5.6899 | Valid PPL: 295.85
<> Saved new best model with validation loss: 5.6899
Epoch 82/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [00:54<00:00,  9.31it/s, loss=5.1053, ppl=164.90]
<> Validating...

<> Epoch 82 Results:
<>  Time: 0:00:55
Train Loss: 4.8673 | Train PPL: 129.97
Valid Loss: 5.6890 | Valid PPL: 295.59
<> Saved new best model with validation loss: 5.6890
Epoch 83/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [00:56<00:00,  8.96it/s, loss=5.0898, ppl=162.35]
<> Validating...

<> Epoch 83 Results:
<>  Time: 0:00:57
Train Loss: 4.8648 | Train PPL: 129.64
Valid Loss: 5.6885 | Valid PPL: 295.45
<> Saved new best model with validation loss: 5.6885
Epoch 84/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [00:55<00:00,  9.13it/s, loss=5.0722, ppl=159.52]
<> Validating...

<> Epoch 84 Results:
<>  Time: 0:00:56
Train Loss: 4.8624 | Train PPL: 129.34
Valid Loss: 5.6883 | Valid PPL: 295.40
<> Saved new best model with validation loss: 5.6883
Epoch 85/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [01:04<00:00,  7.76it/s, loss=5.0946, ppl=163.15]
<> Validating...

<> Epoch 85 Results:
<>  Time: 0:01:06
Train Loss: 4.8610 | Train PPL: 129.15
Valid Loss: 5.6877 | Valid PPL: 295.22
<> Saved new best model with validation loss: 5.6877
Epoch 86/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [00:54<00:00,  9.29it/s, loss=5.0772, ppl=160.32]
<> Validating...

<> Epoch 86 Results:
<>  Time: 0:00:55
Train Loss: 4.8585 | Train PPL: 128.84
Valid Loss: 5.6872 | Valid PPL: 295.07
<> Saved new best model with validation loss: 5.6872
Epoch 87/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [00:51<00:00,  9.86it/s, loss=5.0858, ppl=161.71]
<> Validating...

<> Epoch 87 Results:
<>  Time: 0:00:52
Train Loss: 4.8562 | Train PPL: 128.53
Valid Loss: 5.6870 | Valid PPL: 295.02
<> Saved new best model with validation loss: 5.6870
Epoch 88/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [00:54<00:00,  9.24it/s, loss=5.0807, ppl=160.88]
<> Validating...

<> Epoch 88 Results:
<>  Time: 0:00:56
Train Loss: 4.8546 | Train PPL: 128.33
Valid Loss: 5.6870 | Valid PPL: 295.01
<> Saved new best model with validation loss: 5.6870
Epoch 89/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [00:55<00:00,  9.14it/s, loss=5.0753, ppl=160.02]
<> Validating...

<> Epoch 89 Results:
<>  Time: 0:00:56
Train Loss: 4.8532 | Train PPL: 128.15
Valid Loss: 5.6877 | Valid PPL: 295.21
<> No improvement for 1 epoch(s).
Epoch 90/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [00:57<00:00,  8.84it/s, loss=5.0613, ppl=157.80]
<> Validating...

<> Epoch 90 Results:
<>  Time: 0:00:58
Train Loss: 4.8531 | Train PPL: 128.13
Valid Loss: 5.6874 | Valid PPL: 295.13
<> No improvement for 2 epoch(s).
Epoch 91/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [00:54<00:00,  9.19it/s, loss=5.0662, ppl=158.57]
<> Validating...

<> Epoch 91 Results:
<>  Time: 0:00:56
Train Loss: 4.8514 | Train PPL: 127.93
Valid Loss: 5.6876 | Valid PPL: 295.19
<> No improvement for 3 epoch(s).
Epoch 92/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [01:00<00:00,  8.28it/s, loss=5.0815, ppl=161.02]
<> Validating...

<> Epoch 92 Results:
<>  Time: 0:01:02
Train Loss: 4.8504 | Train PPL: 127.79
Valid Loss: 5.6871 | Valid PPL: 295.05
<> No improvement for 4 epoch(s).
Epoch 93/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [00:54<00:00,  9.21it/s, loss=5.0790, ppl=160.62]
<> Validating...

<> Epoch 93 Results:
<>  Time: 0:00:56
Train Loss: 4.8490 | Train PPL: 127.61
Valid Loss: 5.6875 | Valid PPL: 295.14
<> No improvement for 5 epoch(s).
Epoch 94/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [00:48<00:00, 10.30it/s, loss=5.0733, ppl=159.70]
<> Validating...

<> Epoch 94 Results:
<>  Time: 0:00:50
Train Loss: 4.8492 | Train PPL: 127.63
Valid Loss: 5.6874 | Valid PPL: 295.12
<> No improvement for 6 epoch(s).
Epoch 95/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [00:48<00:00, 10.41it/s, loss=5.0908, ppl=162.51]
<> Validating...

<> Epoch 95 Results:
<>  Time: 0:00:50
Train Loss: 4.8485 | Train PPL: 127.55
Valid Loss: 5.6871 | Valid PPL: 295.04
<> No improvement for 7 epoch(s).
Epoch 96/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [00:44<00:00, 11.43it/s, loss=5.0875, ppl=161.98]
<> Validating...

<> Epoch 96 Results:
<>  Time: 0:00:45
Train Loss: 4.8476 | Train PPL: 127.43
Valid Loss: 5.6872 | Valid PPL: 295.07
<> No improvement for 8 epoch(s).
Epoch 97/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [00:51<00:00,  9.71it/s, loss=5.0711, ppl=159.35]
<> Validating...

<> Epoch 97 Results:
<>  Time: 0:00:53
Train Loss: 4.8476 | Train PPL: 127.43
Valid Loss: 5.6870 | Valid PPL: 295.01
<> Saved new best model with validation loss: 5.6870
Epoch 98/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [01:03<00:00,  7.97it/s, loss=5.0753, ppl=160.02]
<> Validating...

<> Epoch 98 Results:
<>  Time: 0:01:04
Train Loss: 4.8474 | Train PPL: 127.41
Valid Loss: 5.6869 | Valid PPL: 294.99
<> Saved new best model with validation loss: 5.6869
Epoch 99/100: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [01:05<00:00,  7.74it/s, loss=5.0686, ppl=158.96]
<> Validating...

<> Epoch 99 Results:
<>  Time: 0:01:06
Train Loss: 4.8474 | Train PPL: 127.41
Valid Loss: 5.6869 | Valid PPL: 294.97
<> Saved new best model with validation loss: 5.6869
Epoch 100/100: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 504/504 [00:52<00:00,  9.53it/s, loss=5.0877, ppl=162.02]
<> Validating...

<> Epoch 100 Results:
<>  Time: 0:00:54
Train Loss: 4.8472 | Train PPL: 127.39
Valid Loss: 5.6869 | Valid PPL: 294.98
<> No improvement for 1 epoch(s).

==================================================
<> Training Complete!
==================================================
Best validation loss: 5.6869
Total time: 1:35:32

<> Loading Best Model for Evaluation...

==================================================
<> FINAL TEST EVALUATION
==================================================
Testing: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 59/59 [00:02<00:00, 22.94it/s]
>> Final Test Loss: 4.7761
>> Final Test Perplexity: 118.64
==================================================